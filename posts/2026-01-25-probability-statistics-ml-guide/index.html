<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>概率论与数理统计：机器学习的概率基石 | s-ai-unix's Blog</title><meta name=keywords content="概率论,数理统计,机器学习,综述"><meta name=description content="从赌场轮盘到神经网络：系统性地介绍概率论和数理统计在机器学习中的核心应用，包含完整的数学推导和直观的几何可视化"><meta name=author content="s-ai-unix"><link rel=canonical href=https://s-ai-unix.github.io/posts/2026-01-25-probability-statistics-ml-guide/><link crossorigin=anonymous href=/assets/css/stylesheet.0833aff7e1cf567ecfb9755701ee95a80535f671e2e1a0a770c9bc20a0a7b5bb.css integrity="sha256-CDOv9+HPVn7PuXVXAe6VqAU19nHi4aCncMm8IKCntbs=" rel="preload stylesheet" as=style><link rel=icon href=https://s-ai-unix.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s-ai-unix.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s-ai-unix.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s-ai-unix.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s-ai-unix.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s-ai-unix.github.io/posts/2026-01-25-probability-statistics-ml-guide/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="https://s-ai-unix.github.io/posts/2026-01-25-probability-statistics-ml-guide/"><meta property="og:site_name" content="s-ai-unix's Blog"><meta property="og:title" content="概率论与数理统计：机器学习的概率基石"><meta property="og:description" content="从赌场轮盘到神经网络：系统性地介绍概率论和数理统计在机器学习中的核心应用，包含完整的数学推导和直观的几何可视化"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2026-01-25T12:00:00+08:00"><meta property="article:modified_time" content="2026-01-25T12:00:00+08:00"><meta property="article:tag" content="概率论"><meta property="article:tag" content="数理统计"><meta property="article:tag" content="机器学习"><meta property="article:tag" content="综述"><meta property="og:image" content="https://s-ai-unix.github.io/images/covers/probability-statistics-ml-guide.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://s-ai-unix.github.io/images/covers/probability-statistics-ml-guide.jpg"><meta name=twitter:title content="概率论与数理统计：机器学习的概率基石"><meta name=twitter:description content="从赌场轮盘到神经网络：系统性地介绍概率论和数理统计在机器学习中的核心应用，包含完整的数学推导和直观的几何可视化"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://s-ai-unix.github.io/posts/"},{"@type":"ListItem","position":2,"name":"概率论与数理统计：机器学习的概率基石","item":"https://s-ai-unix.github.io/posts/2026-01-25-probability-statistics-ml-guide/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"概率论与数理统计：机器学习的概率基石","name":"概率论与数理统计：机器学习的概率基石","description":"从赌场轮盘到神经网络：系统性地介绍概率论和数理统计在机器学习中的核心应用，包含完整的数学推导和直观的几何可视化","keywords":["概率论","数理统计","机器学习","综述"],"articleBody":"引言：在不确定的世界中寻找确定性 想象一下，你站在一个赌场的轮盘赌桌前。小球在旋转的轮盘上跳跃，最终停在一个数字上。你知道这个结果是完全随机的吗？还是说，如果你能足够精确地测量小球的初始位置、速度、轮盘的摩擦系数等所有参数，你就能预测出最终的结果？\n这个思想实验引发了人类对概率本质的深刻思考。17世纪，法国数学家帕斯卡和费马在通信中讨论赌博问题，标志着概率论作为一门数学学科的诞生。随后的几个世纪里，伯努利、拉普拉斯、高斯等数学大师们为概率论的发展做出了巨大贡献。\n到了20世纪初，俄罗斯数学家柯尔莫哥洛夫给出了概率论的严格公理化定义，将概率论建立在坚实的数学基础之上。几乎同时，贝叶斯的理论开始重新受到重视，为我们提供了一种全新的思考不确定性的方式。\n那么，概率论和机器学习有什么关系呢？\n假设你是一名医生，你需要根据患者的症状来诊断疾病。你有体温、血压、血常规等数据，以及过去的诊断记录。你会怎么做？你会综合考虑所有因素，得出一个诊断结论。这个过程本质上就是一个概率推断过程——根据观测到的数据（症状），推断最可能的原因（疾病）。\n机器学习也是如此。给定一堆数据，模型需要学习数据背后的规律，然后对新的数据进行预测。在这个过程中，不确定性无处不在：数据可能有噪声，模型可能不完美，预测结果也可能有偏差。概率论为我们提供了处理这些不确定性的数学工具。\n在这篇文章中，我们将系统地介绍概率论与数理统计在机器学习中的应用。从基础的概率公理开始，逐步深入到极限定理、统计推断、信息论基础，最后探讨这些理论如何在现代机器学习和深度学习算法中发挥作用。\n第一章：概率基础 1.1 概率的公理化定义 1933年，柯尔莫哥洛夫建立了现代概率论的基础。他提出了三条基本公理：\n公理1（非负性）：对于任何事件 $A$，都有 $P(A) \\geq 0$。\n公理2（规范性）：样本空间 $\\Omega$ 的概率为 $1$，即 $P(\\Omega) = 1$。\n公理3（可加性）：对于任意可数个互斥事件 $A_1, A_2, \\ldots$，有\n$$ P\\left(\\bigcup_{i=1}^{\\infty} A_i\\right) = \\sum_{i=1}^{\\infty} P(A_i) $$\n这三条公理看起来很简单，但它们是整个概率论大厦的基石。从这些公理出发，我们可以推导出概率论的所有重要结果。\n例如，对于两个事件 $A$ 和 $B$，我们可以推导出并集的概率公式：\n$$ P(A \\cup B) = P(A) + P(B) - P(A \\cap B) $$\n这个公式的直观理解是：将 $A$ 的概率和 $B$ 的概率相加时，$A$ 和 $B$ 的交集部分被计算了两次，所以需要减去一次。\n1.2 条件概率和贝叶斯公式 条件概率是概率论中最重要的概念之一。直观地说，条件概率 $P(A \\mid B)$ 表示\"在事件 $B$ 已经发生的条件下，事件 $A$ 发生的概率\"。\n数学上，条件概率的定义是：\n$$ P(A \\mid B) = \\frac{P(A \\cap B)}{P(B)} $$\n其中 $P(B) \u003e 0$。\n从条件概率的定义出发，我们可以推导出贝叶斯公式：\n$$ P(B_i \\mid A) = \\frac{P(A \\mid B_i) \\cdot P(B_i)}{P(A)} = \\frac{P(A \\mid B_i) \\cdot P(B_i)}{\\sum_{j=1}^{n} P(A \\mid B_j) \\cdot P(B_j)} $$\n贝叶斯公式在机器学习中的重要性怎么强调都不为过。它告诉我们：当我们观察到数据 $A$ 时，应该如何更新我们对假设 $B_i$ 的信念。\n这个更新过程可以这样理解：我们从先验分布开始，结合观测到的数据（通过似然函数），得到后验分布。后验分布又成为下一轮推理的先验，如此循环。\n让我们用一个医疗诊断的例子来说明贝叶斯公式的应用。\n例子：某种疾病在人群中的患病率是 $1%$。一种检测方法能够正确识别 $99%$ 的患病者（真阳性率），但也有 $1%$ 的误报率（假阳性率）。如果一个人的检测结果为阳性，他真正患病的概率是多少？\n解：设 $D$ 为\"患病\"，$T$ 为\"检测结果为阳性\"。\n$P(D) = 0.01$（先验概率） $P(\\neg D) = 0.99$ $P(T \\mid D) = 0.99$（似然） $P(T \\mid \\neg D) = 0.01$（似然） 我们要求的是 $P(D \\mid T)$（后验概率）：\n$$ \\begin{aligned} P(D \\mid T) \u0026= \\frac{P(T \\mid D) \\cdot P(D)}{P(T \\mid D) \\cdot P(D) + P(T \\mid \\neg D) \\cdot P(\\neg D)} \\ \u0026= \\frac{0.99 \\times 0.01}{0.99 \\times 0.01 + 0.01 \\times 0.99} \\ \u0026= \\frac{0.0099}{0.0099 + 0.0099} \\ \u0026= 0.5 \\end{aligned} $$\n这是一个令人惊讶的结果：即使检测方法的准确率达到 $99%$，阳性检测结果也只有 $50%$ 的概率真正患病！这个例子说明了贝叶斯公式的重要性：我们不能只看检测方法的准确性，还要考虑基础患病率（先验概率）。\n第二章：常用概率分布 2.1 正态分布（高斯分布） 正态分布是概率论中最重要的分布，也是机器学习中最常用的分布。\n概率密度函数：\n$$ f(x) = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right) $$\n其中 $\\mu$ 是均值，$\\sigma^2$ 是方差。\n期望和方差：\n$$ \\mathbb{E}[X] = \\mu, \\quad \\text{Var}(X) = \\sigma^2 $$\n标准化：如果 $X \\sim \\mathcal{N}(\\mu, \\sigma^2)$，则 $Z = \\frac{X-\\mu}{\\sigma} \\sim \\mathcal{N}(0, 1)$，即标准正态分布。\n图1：不同均值和方差的正态分布。蓝色曲线是标准正态分布 $\\mathcal{N}(0,1)$，绿色曲线的均值为 $2$，橙色曲线的方差更小（更陡峭）。\n正态分布在机器学习中有广泛应用：\n高斯过程回归 误差模型 神经网络的权重初始化 2.2 二项分布 二项分布描述的是 $n$ 次独立的伯努利试验中成功的次数。\n概率质量函数：\n$$ P(X = k) = \\binom{n}{k} p^k (1-p)^{n-k}, \\quad k = 0, 1, \\ldots, n $$\n其中 $\\binom{n}{k} = \\frac{n!}{k!(n-k)!}$ 是二项式系数。\n期望和方差：\n$$ \\mathbb{E}[X] = np, \\quad \\text{Var}(X) = np(1-p) $$\n图2：不同参数的二项分布。当 $n$ 增大时，二项分布逐渐趋近于正态分布（中心极限定理）。\n2.3 伯努利分布 伯努利分布是最简单的离散型分布，描述的是单次试验的结果（成功或失败）。\n概率质量函数：\n$$ P(X = x) = p^x (1-p)^{1-x}, \\quad x \\in {0, 1} $$\n其中 $p$ 是成功的概率。\n期望和方差：\n$$ \\mathbb{E}[X] = p, \\quad \\text{Var}(X) = p(1-p) $$\n伯努利分布在机器学习中广泛应用于二分类问题，如垃圾邮件检测。\n第三章：统计推断 3.1 最大似然估计（MLE） 最大似然估计的基本思想是：找到使观测数据出现概率最大的参数值。\n定义：设 $X_1, X_2, \\ldots, X_n$ 是来自分布 $p(x \\mid \\theta)$ 的独立同分布样本，其中 $\\theta$ 是未知参数。似然函数定义为：\n$$ L(\\theta) = \\prod_{i=1}^{n} p(x_i \\mid \\theta) $$\n对数似然函数为：\n$$ \\ell(\\theta) = \\log L(\\theta) = \\sum_{i=1}^{n} \\log p(x_i \\mid \\theta) $$\nMLE 是使似然函数最大的参数估计：\n$$ \\hat{\\theta}{\\text{MLE}} = \\arg\\max{\\theta} L(\\theta) = \\arg\\max_{\\theta} \\ell(\\theta) $$\n例子：正态分布的 MLE\n设 $X_1, X_2, \\ldots, X_n \\sim \\mathcal{N}(\\mu, \\sigma^2)$，求 $\\mu$ 和 $\\sigma^2$ 的 MLE。\n对数似然函数为：\n$$ \\begin{aligned} \\ell(\\mu, \\sigma^2) \u0026= \\sum_{i=1}^{n} \\log \\left(\\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp\\left(-\\frac{(x_i-\\mu)^2}{2\\sigma^2}\\right)\\right) \\ \u0026= \\sum_{i=1}^{n} \\left(-\\frac{1}{2}\\log(2\\pi) - \\frac{1}{2}\\log(\\sigma^2) - \\frac{(x_i-\\mu)^2}{2\\sigma^2}\\right) \\ \u0026= -\\frac{n}{2}\\log(2\\pi) - \\frac{n}{2}\\log(\\sigma^2) - \\frac{1}{2\\sigma^2}\\sum_{i=1}^{n} (x_i-\\mu)^2 \\end{aligned} $$\n对 $\\mu$ 求导并令导数为 $0$：\n$$ \\begin{aligned} \\frac{\\partial \\ell}{\\partial \\mu} \u0026= \\frac{1}{\\sigma^2} \\sum_{i=1}^{n} (x_i - \\mu) = 0 \\ \\Rightarrow \\sum_{i=1}^{n} (x_i - \\hat{\\mu}) \u0026= 0 \\ \\Rightarrow \\hat{\\mu} \u0026= \\frac{1}{n}\\sum_{i=1}^{n} x_i \\end{aligned} $$\n对 $\\sigma^2$ 求导并令导数为 $0$：\n$$ \\begin{aligned} \\frac{\\partial \\ell}{\\partial \\sigma^2} \u0026= -\\frac{n}{2\\sigma^2} + \\frac{1}{2(\\sigma^2)^2}\\sum_{i=1}^{n} (x_i-\\mu)^2 = 0 \\ \\Rightarrow \\frac{1}{\\hat{\\sigma}^2} \u0026= \\frac{1}{n\\hat{\\sigma}^4}\\sum_{i=1}^{n} (x_i-\\hat{\\mu})^2 \\ \\Rightarrow \\hat{\\sigma}^2 \u0026= \\frac{1}{n}\\sum_{i=1}^{n} (x_i-\\hat{\\mu})^2 \\end{aligned} $$\n应用：逻辑回归、线性回归等监督学习算法本质上都是 MLE 估计。例如，逻辑回归假设 $y_i \\mid x_i \\sim \\text{Bernoulli}(\\sigma(w^\\top x_i))$，然后通过最大化对数似然来估计参数 $w$。\n3.2 最大后验估计（MAP） 最大后验估计结合了先验信息，是贝叶斯推断的一种近似。\n贝叶斯公式：\n$$ p(\\theta \\mid D) = \\frac{p(D \\mid \\theta) \\cdot p(\\theta)}{p(D)} $$\n其中：\n$p(\\theta \\mid D)$ 是后验概率（看到数据后的信念） $p(D \\mid \\theta)$ 是似然（给定参数下数据出现的概率） $p(\\theta)$ 是先验概率（看到数据前的信念） $p(D)$ 是证据（归一化常数） MAP 估计是使后验概率最大的参数估计：\n$$ \\hat{\\theta}{\\text{MAP}} = \\arg\\max{\\theta} p(\\theta \\mid D) = \\arg\\max_{\\theta} p(D \\mid \\theta) \\cdot p(\\theta) $$\nMLE 和 MAP 的关系：如果先验是均匀分布，即 $p(\\theta) \\propto \\text{constant}$，则 MAP 等价于 MLE。因此，MAP 可以看作是 MLE 的推广，它在 MLE 的基础上加入了先验信息。\n例子：带高斯先验的线性回归\n设线性回归模型为 $y = w^\\top x + \\epsilon$，其中 $\\epsilon \\sim \\mathcal{N}(0, \\sigma^2)$。假设参数 $w$ 的先验分布为 $w \\sim \\mathcal{N}(0, \\lambda^{-1} I)$。\n似然函数：\n$$ p(y \\mid X, w) = \\prod_{i=1}^{n} \\mathcal{N}(y_i \\mid w^\\top x_i, \\sigma^2) $$\n后验分布：\n$$ p(w \\mid X, y) \\propto p(y \\mid X, w) \\cdot p(w) $$\n取对数：\n$$ \\begin{aligned} \\log p(w \\mid X, y) \u0026\\propto \\sum_{i=1}^{n} \\log \\mathcal{N}(y_i \\mid w^\\top x_i, \\sigma^2) + \\log \\mathcal{N}(w \\mid 0, \\lambda^{-1} I) \\ \u0026\\propto -\\frac{1}{2\\sigma^2}\\sum_{i=1}^{n} (y_i - w^\\top x_i)^2 - \\frac{\\lambda}{2} w^\\top w + \\text{constant} \\end{aligned} $$\n最大化后验等价于最小化负对数后验：\n$$ \\begin{aligned} w_{\\text{MAP}} \u0026= \\arg\\min_{w} \\left(\\sum_{i=1}^{n} (y_i - w^\\top x_i)^2 + \\lambda \\sigma^2 w^\\top w\\right) \\ \u0026= \\arg\\min_{w} \\left(\\lVert y - Xw\\rVert^2 + \\alpha \\lVert w\\rVert^2\\right) \\end{aligned} $$\n其中 $\\alpha = \\lambda \\sigma^2$。\n这正是岭回归（Ridge Regression）的目标函数！因此，岭回归可以解释为带高斯先验的线性回归的 MAP 估计。\n应用：正则化方法本质上都是 MAP 估计。例如：\nL2 正则化（岭回归）$\\leftrightarrow$ 高斯先验 L1 正则化（Lasso）$\\leftrightarrow$ 拉普拉斯先验 第四章：信息论基础 4.1 熵 信息论为机器学习提供了度量不确定性和信息量的工具。\n香农熵：对于离散型随机变量 $X$，其熵定义为：\n$$ H(X) = -\\sum_{x \\in \\mathcal{X}} p(x) \\log p(x) $$\n熵衡量了随机变量的不确定性：\n熵越大，不确定性越大 熵为 $0$：完全确定 熵最大：均匀分布 例子：抛硬币。设 $P(\\text{正面}) = p$，则：\n$$ H(X) = -p \\log p - (1-p) \\log (1-p) $$\n当 $p = 0.5$ 时，熵最大；当 $p = 0$ 或 $p = 1$ 时，熵为 $0$。\n图3：伯努利分布的熵函数。当 $p = 0.5$ 时熵最大，此时不确定性最大。\n4.2 相对熵（KL 散度） 相对熵（KL 散度）衡量两个概率分布的差异。\n定义：\n$$ D_{\\text{KL}}(p \\parallel q) = \\sum_{x \\in \\mathcal{X}} p(x) \\log \\frac{p(x)}{q(x)} $$\n性质：\n$D_{\\text{KL}}(p \\parallel q) \\geq 0$（Gibbs 不等式） $D_{\\text{KL}}(p \\parallel q) = 0$ 当且仅当 $p(x) = q(x)$ 对所有 $x$ 成立 KL 散度不对称：$D_{\\text{KL}}(p \\parallel q) \\neq D_{\\text{KL}}(q \\parallel p)$ 直观理解：KL 散度衡量用分布 $q$ 来近似分布 $p$ 时损失的信息量。\n图4：KL 散度热力图。展示了两个伯努利分布之间的 KL 散度，颜色越红表示差异越大。\n应用：\n变分推断：最小化变分分布和真实后验之间的 KL 散度 生成模型：最小化生成分布和真实分布之间的 KL 散度 4.3 交叉熵 交叉熵在机器学习中有广泛应用，尤其是在分类问题中。\n定义：\n$$ H(p, q) = -\\sum_{x \\in \\mathcal{X}} p(x) \\log q(x) $$\n其中 $p$ 是真实分布，$q$ 是预测分布。\n与 KL 散度的关系：\n$$ H(p, q) = H(p) + D_{\\text{KL}}(p \\parallel q) $$\n因此，最小化交叉熵等价于最小化 KL 散度（因为 $H(p)$ 是常数）。\n应用：逻辑回归和神经网络的交叉熵损失函数。\n例子：二分类问题。设 $y \\in {0, 1}$ 是真实标签，$\\hat{y} = \\sigma(w^\\top x)$ 是预测概率。交叉熵损失为：\n$$ \\begin{aligned} L \u0026= -\\sum_{i=1}^{n} [y_i \\log \\hat{y}_i + (1 - y_i) \\log(1 - \\hat{y}i)] \\ \u0026= -\\sum{i=1}^{n} [y_i \\log \\sigma(w^\\top x_i) + (1 - y_i) \\log(1 - \\sigma(w^\\top x_i))] \\end{aligned} $$\n这正是逻辑回归的标准损失函数。\n第五章：机器学习中的概率模型 5.1 逻辑回归 逻辑回归虽然名字中有\"回归\"，但它实际上是一个分类模型。它使用 sigmoid 函数将线性组合映射到 $[0, 1]$ 区间，然后将其解释为概率。\n模型假设：\n$$ P(y = 1 \\mid x) = \\sigma(w^\\top x) = \\frac{1}{1 + e^{-w^\\top x}} $$\n其中 $\\sigma(z) = \\frac{1}{1 + e^{-z}}$ 是 sigmoid 函数。\n图5：Sigmoid 函数将任意实数映射到 $[0,1]$ 区间，适合表示概率。\n似然函数：\n$$ \\begin{aligned} L(w) \u0026= \\prod_{i=1}^{n} P(y_i \\mid x_i, w) \\ \u0026= \\prod_{i=1}^{n} [\\sigma(w^\\top x_i)]^{y_i} [1 - \\sigma(w^\\top x_i)]^{1-y_i} \\end{aligned} $$\n对数似然：\n$$ \\ell(w) = \\sum_{i=1}^{n} [y_i \\log \\sigma(w^\\top x_i) + (1 - y_i) \\log(1 - \\sigma(w^\\top x_i))] $$\n优化：最大化对数似然等价于最小化负对数似然（交叉熵损失）：\n$$ w^* = \\arg\\min_w \\sum_{i=1}^{n} [y_i \\log \\sigma(w^\\top x_i) + (1 - y_i) \\log(1 - \\sigma(w^\\top x_i))] $$\n结语 在这篇文章中，我们系统地介绍了概率论与数理统计在机器学习中的应用。\n核心要点回顾：\n贝叶斯公式是机器学习的核心思想，告诉我们如何根据观测数据更新对模型的信念\nMLE 和 MAP 是两种主要的参数估计方法。MLE 寻找使观测数据出现概率最大的参数，而 MAP 则结合了先验信息\n概率分布为机器学习提供了丰富的建模工具。正态分布、二项分布、伯努利分布等在不同场景中发挥重要作用\n信息论为机器学习提供了度量不确定性的工具。熵、KL 散度和交叉熵是许多损失函数的理论基础\n概率模型如逻辑回归、高斯过程、EM 算法等为机器学习提供了坚实的理论基础\n没有概率论，我们无法理解过拟合现象，无法量化预测的不确定性，也无法设计出鲁棒可靠的算法。\n未来的方向：\n随着深度学习的发展，贝叶斯深度学习、不确定性量化、主动学习等方向越来越受到关注。这些方向的共同特点是更加重视对不确定性的理解和建模。\n希望这篇文章能够帮助读者建立概率论与数理统计在机器学习中的整体认识，为更深入的学习和研究打下坚实的基础。\n参考文献 Bishop, C. M. (2006). Pattern Recognition and Machine Learning. Springer. Murphy, K. P. (2012). Machine Learning: A Probabilistic Perspective. MIT Press. Goodfellow, I., Bengio, Y., \u0026 Courville, A. (2016). Deep Learning. MIT Press. MacKay, D. J. (2003). Information Theory, Inference, and Learning Algorithms. Cambridge University Press. Cover, T. M., \u0026 Thomas, J. A. (2006). Elements of Information Theory (2nd ed.). Wiley. Rasmussen, C. E., \u0026 Williams, C. K. I. (2006). Gaussian Processes for Machine Learning. MIT Press. ","wordCount":"1058","inLanguage":"en","image":"https://s-ai-unix.github.io/images/covers/probability-statistics-ml-guide.jpg","datePublished":"2026-01-25T12:00:00+08:00","dateModified":"2026-01-25T12:00:00+08:00","author":{"@type":"Person","name":"s-ai-unix"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s-ai-unix.github.io/posts/2026-01-25-probability-statistics-ml-guide/"},"publisher":{"@type":"Organization","name":"s-ai-unix's Blog","logo":{"@type":"ImageObject","url":"https://s-ai-unix.github.io/favicon.ico"}}}</script><link rel=stylesheet href=https://s-ai-unix.github.io/css/classical-quote.css></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://s-ai-unix.github.io/ accesskey=h title="s-ai-unix's Blog (Alt + H)">s-ai-unix's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://s-ai-unix.github.io/ title="🏠 首页"><span>🏠 首页</span></a></li><li><a href=https://s-ai-unix.github.io/posts/ title="📚 文章"><span>📚 文章</span></a></li><li><a href=https://s-ai-unix.github.io/archives/ title="📁 归档"><span>📁 归档</span></a></li><li><a href=https://s-ai-unix.github.io/tags/ title="🏷️ 标签"><span>🏷️ 标签</span></a></li><li><a href=https://s-ai-unix.github.io/search/ title="🔍 搜索 (Alt + /)" accesskey=/><span>🔍 搜索</span></a></li><li><a href=https://s-ai-unix.github.io/about/ title="👤 关于"><span>👤 关于</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://s-ai-unix.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://s-ai-unix.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">概率论与数理统计：机器学习的概率基石</h1><div class=post-description>从赌场轮盘到神经网络：系统性地介绍概率论和数理统计在机器学习中的核心应用，包含完整的数学推导和直观的几何可视化</div><div class=post-meta><span title='2026-01-25 12:00:00 +0800 CST'>January 25, 2026</span>&nbsp;·&nbsp;<span>5 min</span>&nbsp;·&nbsp;<span>1058 words</span>&nbsp;·&nbsp;<span>s-ai-unix</span></div></header><figure class=entry-cover><a href=https://s-ai-unix.github.io/images/covers/probability-statistics-ml-guide.jpg target=_blank rel="noopener noreferrer"><img loading=eager src=https://s-ai-unix.github.io/images/covers/probability-statistics-ml-guide.jpg alt=概率分布可视化></a><figcaption>概率论：描述不确定性的数学语言</figcaption></figure><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e5%bc%95%e8%a8%80%e5%9c%a8%e4%b8%8d%e7%a1%ae%e5%ae%9a%e7%9a%84%e4%b8%96%e7%95%8c%e4%b8%ad%e5%af%bb%e6%89%be%e7%a1%ae%e5%ae%9a%e6%80%a7 aria-label=引言：在不确定的世界中寻找确定性>引言：在不确定的世界中寻找确定性</a></li><li><a href=#%e7%ac%ac%e4%b8%80%e7%ab%a0%e6%a6%82%e7%8e%87%e5%9f%ba%e7%a1%80 aria-label=第一章：概率基础>第一章：概率基础</a><ul><li><a href=#11-%e6%a6%82%e7%8e%87%e7%9a%84%e5%85%ac%e7%90%86%e5%8c%96%e5%ae%9a%e4%b9%89 aria-label="1.1 概率的公理化定义">1.1 概率的公理化定义</a></li><li><a href=#12-%e6%9d%a1%e4%bb%b6%e6%a6%82%e7%8e%87%e5%92%8c%e8%b4%9d%e5%8f%b6%e6%96%af%e5%85%ac%e5%bc%8f aria-label="1.2 条件概率和贝叶斯公式">1.2 条件概率和贝叶斯公式</a></li></ul></li><li><a href=#%e7%ac%ac%e4%ba%8c%e7%ab%a0%e5%b8%b8%e7%94%a8%e6%a6%82%e7%8e%87%e5%88%86%e5%b8%83 aria-label=第二章：常用概率分布>第二章：常用概率分布</a><ul><li><a href=#21-%e6%ad%a3%e6%80%81%e5%88%86%e5%b8%83%e9%ab%98%e6%96%af%e5%88%86%e5%b8%83 aria-label="2.1 正态分布（高斯分布）">2.1 正态分布（高斯分布）</a></li><li><a href=#22-%e4%ba%8c%e9%a1%b9%e5%88%86%e5%b8%83 aria-label="2.2 二项分布">2.2 二项分布</a></li><li><a href=#23-%e4%bc%af%e5%8a%aa%e5%88%a9%e5%88%86%e5%b8%83 aria-label="2.3 伯努利分布">2.3 伯努利分布</a></li></ul></li><li><a href=#%e7%ac%ac%e4%b8%89%e7%ab%a0%e7%bb%9f%e8%ae%a1%e6%8e%a8%e6%96%ad aria-label=第三章：统计推断>第三章：统计推断</a><ul><li><a href=#31-%e6%9c%80%e5%a4%a7%e4%bc%bc%e7%84%b6%e4%bc%b0%e8%ae%a1mle aria-label="3.1 最大似然估计（MLE）">3.1 最大似然估计（MLE）</a></li><li><a href=#32-%e6%9c%80%e5%a4%a7%e5%90%8e%e9%aa%8c%e4%bc%b0%e8%ae%a1map aria-label="3.2 最大后验估计（MAP）">3.2 最大后验估计（MAP）</a></li></ul></li><li><a href=#%e7%ac%ac%e5%9b%9b%e7%ab%a0%e4%bf%a1%e6%81%af%e8%ae%ba%e5%9f%ba%e7%a1%80 aria-label=第四章：信息论基础>第四章：信息论基础</a><ul><li><a href=#41-%e7%86%b5 aria-label="4.1 熵">4.1 熵</a></li><li><a href=#42-%e7%9b%b8%e5%af%b9%e7%86%b5kl-%e6%95%a3%e5%ba%a6 aria-label="4.2 相对熵（KL 散度）">4.2 相对熵（KL 散度）</a></li><li><a href=#43-%e4%ba%a4%e5%8f%89%e7%86%b5 aria-label="4.3 交叉熵">4.3 交叉熵</a></li></ul></li><li><a href=#%e7%ac%ac%e4%ba%94%e7%ab%a0%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e4%b8%ad%e7%9a%84%e6%a6%82%e7%8e%87%e6%a8%a1%e5%9e%8b aria-label=第五章：机器学习中的概率模型>第五章：机器学习中的概率模型</a><ul><li><a href=#51-%e9%80%bb%e8%be%91%e5%9b%9e%e5%bd%92 aria-label="5.1 逻辑回归">5.1 逻辑回归</a></li></ul></li><li><a href=#%e7%bb%93%e8%af%ad aria-label=结语>结语</a></li><li><a href=#%e5%8f%82%e8%80%83%e6%96%87%e7%8c%ae aria-label=参考文献>参考文献</a></li></ul></div></details></div><div class=post-content><h2 id=引言在不确定的世界中寻找确定性>引言：在不确定的世界中寻找确定性<a hidden class=anchor aria-hidden=true href=#引言在不确定的世界中寻找确定性>#</a></h2><p>想象一下，你站在一个赌场的轮盘赌桌前。小球在旋转的轮盘上跳跃，最终停在一个数字上。你知道这个结果是完全随机的吗？还是说，如果你能足够精确地测量小球的初始位置、速度、轮盘的摩擦系数等所有参数，你就能预测出最终的结果？</p><p>这个思想实验引发了人类对概率本质的深刻思考。17世纪，法国数学家帕斯卡和费马在通信中讨论赌博问题，标志着概率论作为一门数学学科的诞生。随后的几个世纪里，伯努利、拉普拉斯、高斯等数学大师们为概率论的发展做出了巨大贡献。</p><p>到了20世纪初，俄罗斯数学家柯尔莫哥洛夫给出了概率论的严格公理化定义，将概率论建立在坚实的数学基础之上。几乎同时，贝叶斯的理论开始重新受到重视，为我们提供了一种全新的思考不确定性的方式。</p><p>那么，概率论和机器学习有什么关系呢？</p><p>假设你是一名医生，你需要根据患者的症状来诊断疾病。你有体温、血压、血常规等数据，以及过去的诊断记录。你会怎么做？你会综合考虑所有因素，得出一个诊断结论。这个过程本质上就是一个概率推断过程——根据观测到的数据（症状），推断最可能的原因（疾病）。</p><p>机器学习也是如此。给定一堆数据，模型需要学习数据背后的规律，然后对新的数据进行预测。在这个过程中，不确定性无处不在：数据可能有噪声，模型可能不完美，预测结果也可能有偏差。概率论为我们提供了处理这些不确定性的数学工具。</p><p>在这篇文章中，我们将系统地介绍概率论与数理统计在机器学习中的应用。从基础的概率公理开始，逐步深入到极限定理、统计推断、信息论基础，最后探讨这些理论如何在现代机器学习和深度学习算法中发挥作用。</p><h2 id=第一章概率基础>第一章：概率基础<a hidden class=anchor aria-hidden=true href=#第一章概率基础>#</a></h2><h3 id=11-概率的公理化定义>1.1 概率的公理化定义<a hidden class=anchor aria-hidden=true href=#11-概率的公理化定义>#</a></h3><p>1933年，柯尔莫哥洛夫建立了现代概率论的基础。他提出了三条基本公理：</p><p><strong>公理1（非负性）</strong>：对于任何事件 $A$，都有 $P(A) \geq 0$。</p><p><strong>公理2（规范性）</strong>：样本空间 $\Omega$ 的概率为 $1$，即 $P(\Omega) = 1$。</p><p><strong>公理3（可加性）</strong>：对于任意可数个互斥事件 $A_1, A_2, \ldots$，有</p><p>$$
P\left(\bigcup_{i=1}^{\infty} A_i\right) = \sum_{i=1}^{\infty} P(A_i)
$$</p><p>这三条公理看起来很简单，但它们是整个概率论大厦的基石。从这些公理出发，我们可以推导出概率论的所有重要结果。</p><p>例如，对于两个事件 $A$ 和 $B$，我们可以推导出并集的概率公式：</p><p>$$
P(A \cup B) = P(A) + P(B) - P(A \cap B)
$$</p><p>这个公式的直观理解是：将 $A$ 的概率和 $B$ 的概率相加时，$A$ 和 $B$ 的交集部分被计算了两次，所以需要减去一次。</p><h3 id=12-条件概率和贝叶斯公式>1.2 条件概率和贝叶斯公式<a hidden class=anchor aria-hidden=true href=#12-条件概率和贝叶斯公式>#</a></h3><p>条件概率是概率论中最重要的概念之一。直观地说，条件概率 $P(A \mid B)$ 表示"在事件 $B$ 已经发生的条件下，事件 $A$ 发生的概率"。</p><p>数学上，条件概率的定义是：</p><p>$$
P(A \mid B) = \frac{P(A \cap B)}{P(B)}
$$</p><p>其中 $P(B) > 0$。</p><p>从条件概率的定义出发，我们可以推导出贝叶斯公式：</p><p>$$
P(B_i \mid A) = \frac{P(A \mid B_i) \cdot P(B_i)}{P(A)} = \frac{P(A \mid B_i) \cdot P(B_i)}{\sum_{j=1}^{n} P(A \mid B_j) \cdot P(B_j)}
$$</p><p>贝叶斯公式在机器学习中的重要性怎么强调都不为过。它告诉我们：当我们观察到数据 $A$ 时，应该如何更新我们对假设 $B_i$ 的信念。</p><p>这个更新过程可以这样理解：我们从先验分布开始，结合观测到的数据（通过似然函数），得到后验分布。后验分布又成为下一轮推理的先验，如此循环。</p><p>让我们用一个医疗诊断的例子来说明贝叶斯公式的应用。</p><p><strong>例子</strong>：某种疾病在人群中的患病率是 $1%$。一种检测方法能够正确识别 $99%$ 的患病者（真阳性率），但也有 $1%$ 的误报率（假阳性率）。如果一个人的检测结果为阳性，他真正患病的概率是多少？</p><p>解：设 $D$ 为"患病"，$T$ 为"检测结果为阳性"。</p><ul><li>$P(D) = 0.01$（先验概率）</li><li>$P(\neg D) = 0.99$</li><li>$P(T \mid D) = 0.99$（似然）</li><li>$P(T \mid \neg D) = 0.01$（似然）</li></ul><p>我们要求的是 $P(D \mid T)$（后验概率）：</p><p>$$
\begin{aligned}
P(D \mid T) &= \frac{P(T \mid D) \cdot P(D)}{P(T \mid D) \cdot P(D) + P(T \mid \neg D) \cdot P(\neg D)} \
&= \frac{0.99 \times 0.01}{0.99 \times 0.01 + 0.01 \times 0.99} \
&= \frac{0.0099}{0.0099 + 0.0099} \
&= 0.5
\end{aligned}
$$</p><p>这是一个令人惊讶的结果：即使检测方法的准确率达到 $99%$，阳性检测结果也只有 $50%$ 的概率真正患病！这个例子说明了贝叶斯公式的重要性：我们不能只看检测方法的准确性，还要考虑基础患病率（先验概率）。</p><h2 id=第二章常用概率分布>第二章：常用概率分布<a hidden class=anchor aria-hidden=true href=#第二章常用概率分布>#</a></h2><h3 id=21-正态分布高斯分布>2.1 正态分布（高斯分布）<a hidden class=anchor aria-hidden=true href=#21-正态分布高斯分布>#</a></h3><p>正态分布是概率论中最重要的分布，也是机器学习中最常用的分布。</p><p><strong>概率密度函数</strong>：</p><p>$$
f(x) = \frac{1}{\sqrt{2\pi}\sigma} \exp\left(-\frac{(x-\mu)^2}{2\sigma^2}\right)
$$</p><p>其中 $\mu$ 是均值，$\sigma^2$ 是方差。</p><p><strong>期望和方差</strong>：</p><p>$$
\mathbb{E}[X] = \mu, \quad \text{Var}(X) = \sigma^2
$$</p><p><strong>标准化</strong>：如果 $X \sim \mathcal{N}(\mu, \sigma^2)$，则 $Z = \frac{X-\mu}{\sigma} \sim \mathcal{N}(0, 1)$，即标准正态分布。</p><p><img alt=正态分布的概率密度函数 loading=lazy src=/images/math/normal-distributions.png></p><p><em>图1：不同均值和方差的正态分布。蓝色曲线是标准正态分布 $\mathcal{N}(0,1)$，绿色曲线的均值为 $2$，橙色曲线的方差更小（更陡峭）。</em></p><p>正态分布在机器学习中有广泛应用：</p><ul><li>高斯过程回归</li><li>误差模型</li><li>神经网络的权重初始化</li></ul><h3 id=22-二项分布>2.2 二项分布<a hidden class=anchor aria-hidden=true href=#22-二项分布>#</a></h3><p>二项分布描述的是 $n$ 次独立的伯努利试验中成功的次数。</p><p><strong>概率质量函数</strong>：</p><p>$$
P(X = k) = \binom{n}{k} p^k (1-p)^{n-k}, \quad k = 0, 1, \ldots, n
$$</p><p>其中 $\binom{n}{k} = \frac{n!}{k!(n-k)!}$ 是二项式系数。</p><p><strong>期望和方差</strong>：</p><p>$$
\mathbb{E}[X] = np, \quad \text{Var}(X) = np(1-p)
$$</p><p><img alt=二项分布的概率质量函数 loading=lazy src=/images/math/binomial-distributions.png></p><p><em>图2：不同参数的二项分布。当 $n$ 增大时，二项分布逐渐趋近于正态分布（中心极限定理）。</em></p><h3 id=23-伯努利分布>2.3 伯努利分布<a hidden class=anchor aria-hidden=true href=#23-伯努利分布>#</a></h3><p>伯努利分布是最简单的离散型分布，描述的是单次试验的结果（成功或失败）。</p><p><strong>概率质量函数</strong>：</p><p>$$
P(X = x) = p^x (1-p)^{1-x}, \quad x \in {0, 1}
$$</p><p>其中 $p$ 是成功的概率。</p><p><strong>期望和方差</strong>：</p><p>$$
\mathbb{E}[X] = p, \quad \text{Var}(X) = p(1-p)
$$</p><p>伯努利分布在机器学习中广泛应用于二分类问题，如垃圾邮件检测。</p><h2 id=第三章统计推断>第三章：统计推断<a hidden class=anchor aria-hidden=true href=#第三章统计推断>#</a></h2><h3 id=31-最大似然估计mle>3.1 最大似然估计（MLE）<a hidden class=anchor aria-hidden=true href=#31-最大似然估计mle>#</a></h3><p>最大似然估计的基本思想是：找到使观测数据出现概率最大的参数值。</p><p><strong>定义</strong>：设 $X_1, X_2, \ldots, X_n$ 是来自分布 $p(x \mid \theta)$ 的独立同分布样本，其中 $\theta$ 是未知参数。似然函数定义为：</p><p>$$
L(\theta) = \prod_{i=1}^{n} p(x_i \mid \theta)
$$</p><p>对数似然函数为：</p><p>$$
\ell(\theta) = \log L(\theta) = \sum_{i=1}^{n} \log p(x_i \mid \theta)
$$</p><p>MLE 是使似然函数最大的参数估计：</p><p>$$
\hat{\theta}<em>{\text{MLE}} = \arg\max</em>{\theta} L(\theta) = \arg\max_{\theta} \ell(\theta)
$$</p><p><strong>例子：正态分布的 MLE</strong></p><p>设 $X_1, X_2, \ldots, X_n \sim \mathcal{N}(\mu, \sigma^2)$，求 $\mu$ 和 $\sigma^2$ 的 MLE。</p><p>对数似然函数为：</p><p>$$
\begin{aligned}
\ell(\mu, \sigma^2) &= \sum_{i=1}^{n} \log \left(\frac{1}{\sqrt{2\pi}\sigma} \exp\left(-\frac{(x_i-\mu)^2}{2\sigma^2}\right)\right) \
&= \sum_{i=1}^{n} \left(-\frac{1}{2}\log(2\pi) - \frac{1}{2}\log(\sigma^2) - \frac{(x_i-\mu)^2}{2\sigma^2}\right) \
&= -\frac{n}{2}\log(2\pi) - \frac{n}{2}\log(\sigma^2) - \frac{1}{2\sigma^2}\sum_{i=1}^{n} (x_i-\mu)^2
\end{aligned}
$$</p><p>对 $\mu$ 求导并令导数为 $0$：</p><p>$$
\begin{aligned}
\frac{\partial \ell}{\partial \mu} &= \frac{1}{\sigma^2} \sum_{i=1}^{n} (x_i - \mu) = 0 \
\Rightarrow \sum_{i=1}^{n} (x_i - \hat{\mu}) &= 0 \
\Rightarrow \hat{\mu} &= \frac{1}{n}\sum_{i=1}^{n} x_i
\end{aligned}
$$</p><p>对 $\sigma^2$ 求导并令导数为 $0$：</p><p>$$
\begin{aligned}
\frac{\partial \ell}{\partial \sigma^2} &= -\frac{n}{2\sigma^2} + \frac{1}{2(\sigma^2)^2}\sum_{i=1}^{n} (x_i-\mu)^2 = 0 \
\Rightarrow \frac{1}{\hat{\sigma}^2} &= \frac{1}{n\hat{\sigma}^4}\sum_{i=1}^{n} (x_i-\hat{\mu})^2 \
\Rightarrow \hat{\sigma}^2 &= \frac{1}{n}\sum_{i=1}^{n} (x_i-\hat{\mu})^2
\end{aligned}
$$</p><p><strong>应用</strong>：逻辑回归、线性回归等监督学习算法本质上都是 MLE 估计。例如，逻辑回归假设 $y_i \mid x_i \sim \text{Bernoulli}(\sigma(w^\top x_i))$，然后通过最大化对数似然来估计参数 $w$。</p><h3 id=32-最大后验估计map>3.2 最大后验估计（MAP）<a hidden class=anchor aria-hidden=true href=#32-最大后验估计map>#</a></h3><p>最大后验估计结合了先验信息，是贝叶斯推断的一种近似。</p><p><strong>贝叶斯公式</strong>：</p><p>$$
p(\theta \mid D) = \frac{p(D \mid \theta) \cdot p(\theta)}{p(D)}
$$</p><p>其中：</p><ul><li>$p(\theta \mid D)$ 是后验概率（看到数据后的信念）</li><li>$p(D \mid \theta)$ 是似然（给定参数下数据出现的概率）</li><li>$p(\theta)$ 是先验概率（看到数据前的信念）</li><li>$p(D)$ 是证据（归一化常数）</li></ul><p>MAP 估计是使后验概率最大的参数估计：</p><p>$$
\hat{\theta}<em>{\text{MAP}} = \arg\max</em>{\theta} p(\theta \mid D) = \arg\max_{\theta} p(D \mid \theta) \cdot p(\theta)
$$</p><p><strong>MLE 和 MAP 的关系</strong>：如果先验是均匀分布，即 $p(\theta) \propto \text{constant}$，则 MAP 等价于 MLE。因此，MAP 可以看作是 MLE 的推广，它在 MLE 的基础上加入了先验信息。</p><p><strong>例子：带高斯先验的线性回归</strong></p><p>设线性回归模型为 $y = w^\top x + \epsilon$，其中 $\epsilon \sim \mathcal{N}(0, \sigma^2)$。假设参数 $w$ 的先验分布为 $w \sim \mathcal{N}(0, \lambda^{-1} I)$。</p><p>似然函数：</p><p>$$
p(y \mid X, w) = \prod_{i=1}^{n} \mathcal{N}(y_i \mid w^\top x_i, \sigma^2)
$$</p><p>后验分布：</p><p>$$
p(w \mid X, y) \propto p(y \mid X, w) \cdot p(w)
$$</p><p>取对数：</p><p>$$
\begin{aligned}
\log p(w \mid X, y) &\propto \sum_{i=1}^{n} \log \mathcal{N}(y_i \mid w^\top x_i, \sigma^2) + \log \mathcal{N}(w \mid 0, \lambda^{-1} I) \
&\propto -\frac{1}{2\sigma^2}\sum_{i=1}^{n} (y_i - w^\top x_i)^2 - \frac{\lambda}{2} w^\top w + \text{constant}
\end{aligned}
$$</p><p>最大化后验等价于最小化负对数后验：</p><p>$$
\begin{aligned}
w_{\text{MAP}} &= \arg\min_{w} \left(\sum_{i=1}^{n} (y_i - w^\top x_i)^2 + \lambda \sigma^2 w^\top w\right) \
&= \arg\min_{w} \left(\lVert y - Xw\rVert^2 + \alpha \lVert w\rVert^2\right)
\end{aligned}
$$</p><p>其中 $\alpha = \lambda \sigma^2$。</p><p>这正是岭回归（Ridge Regression）的目标函数！因此，岭回归可以解释为带高斯先验的线性回归的 MAP 估计。</p><p><strong>应用</strong>：正则化方法本质上都是 MAP 估计。例如：</p><ul><li>L2 正则化（岭回归）$\leftrightarrow$ 高斯先验</li><li>L1 正则化（Lasso）$\leftrightarrow$ 拉普拉斯先验</li></ul><h2 id=第四章信息论基础>第四章：信息论基础<a hidden class=anchor aria-hidden=true href=#第四章信息论基础>#</a></h2><h3 id=41-熵>4.1 熵<a hidden class=anchor aria-hidden=true href=#41-熵>#</a></h3><p>信息论为机器学习提供了度量不确定性和信息量的工具。</p><p><strong>香农熵</strong>：对于离散型随机变量 $X$，其熵定义为：</p><p>$$
H(X) = -\sum_{x \in \mathcal{X}} p(x) \log p(x)
$$</p><p>熵衡量了随机变量的不确定性：</p><ul><li>熵越大，不确定性越大</li><li>熵为 $0$：完全确定</li><li>熵最大：均匀分布</li></ul><p><strong>例子</strong>：抛硬币。设 $P(\text{正面}) = p$，则：</p><p>$$
H(X) = -p \log p - (1-p) \log (1-p)
$$</p><p>当 $p = 0.5$ 时，熵最大；当 $p = 0$ 或 $p = 1$ 时，熵为 $0$。</p><p><img alt=伯努利分布的熵函数 loading=lazy src=/images/math/bernoulli-entropy.png></p><p><em>图3：伯努利分布的熵函数。当 $p = 0.5$ 时熵最大，此时不确定性最大。</em></p><h3 id=42-相对熵kl-散度>4.2 相对熵（KL 散度）<a hidden class=anchor aria-hidden=true href=#42-相对熵kl-散度>#</a></h3><p>相对熵（KL 散度）衡量两个概率分布的差异。</p><p><strong>定义</strong>：</p><p>$$
D_{\text{KL}}(p \parallel q) = \sum_{x \in \mathcal{X}} p(x) \log \frac{p(x)}{q(x)}
$$</p><p><strong>性质</strong>：</p><ul><li>$D_{\text{KL}}(p \parallel q) \geq 0$（Gibbs 不等式）</li><li>$D_{\text{KL}}(p \parallel q) = 0$ 当且仅当 $p(x) = q(x)$ 对所有 $x$ 成立</li><li>KL 散度不对称：$D_{\text{KL}}(p \parallel q) \neq D_{\text{KL}}(q \parallel p)$</li></ul><p><strong>直观理解</strong>：KL 散度衡量用分布 $q$ 来近似分布 $p$ 时损失的信息量。</p><p><img alt="KL 散度：两个伯努利分布之间的 KL 散度" loading=lazy src=/images/math/kl-divergence-heatmap.png></p><p><em>图4：KL 散度热力图。展示了两个伯努利分布之间的 KL 散度，颜色越红表示差异越大。</em></p><p><strong>应用</strong>：</p><ul><li>变分推断：最小化变分分布和真实后验之间的 KL 散度</li><li>生成模型：最小化生成分布和真实分布之间的 KL 散度</li></ul><h3 id=43-交叉熵>4.3 交叉熵<a hidden class=anchor aria-hidden=true href=#43-交叉熵>#</a></h3><p>交叉熵在机器学习中有广泛应用，尤其是在分类问题中。</p><p><strong>定义</strong>：</p><p>$$
H(p, q) = -\sum_{x \in \mathcal{X}} p(x) \log q(x)
$$</p><p>其中 $p$ 是真实分布，$q$ 是预测分布。</p><p><strong>与 KL 散度的关系</strong>：</p><p>$$
H(p, q) = H(p) + D_{\text{KL}}(p \parallel q)
$$</p><p>因此，最小化交叉熵等价于最小化 KL 散度（因为 $H(p)$ 是常数）。</p><p><strong>应用</strong>：逻辑回归和神经网络的交叉熵损失函数。</p><p><strong>例子</strong>：二分类问题。设 $y \in {0, 1}$ 是真实标签，$\hat{y} = \sigma(w^\top x)$ 是预测概率。交叉熵损失为：</p><p>$$
\begin{aligned}
L &= -\sum_{i=1}^{n} [y_i \log \hat{y}_i + (1 - y_i) \log(1 - \hat{y}<em>i)] \
&= -\sum</em>{i=1}^{n} [y_i \log \sigma(w^\top x_i) + (1 - y_i) \log(1 - \sigma(w^\top x_i))]
\end{aligned}
$$</p><p>这正是逻辑回归的标准损失函数。</p><h2 id=第五章机器学习中的概率模型>第五章：机器学习中的概率模型<a hidden class=anchor aria-hidden=true href=#第五章机器学习中的概率模型>#</a></h2><h3 id=51-逻辑回归>5.1 逻辑回归<a hidden class=anchor aria-hidden=true href=#51-逻辑回归>#</a></h3><p>逻辑回归虽然名字中有"回归"，但它实际上是一个分类模型。它使用 sigmoid 函数将线性组合映射到 $[0, 1]$ 区间，然后将其解释为概率。</p><p><strong>模型假设</strong>：</p><p>$$
P(y = 1 \mid x) = \sigma(w^\top x) = \frac{1}{1 + e^{-w^\top x}}
$$</p><p>其中 $\sigma(z) = \frac{1}{1 + e^{-z}}$ 是 sigmoid 函数。</p><p><img alt="Sigmoid 函数" loading=lazy src=/images/math/sigmoid-function.png></p><p><em>图5：Sigmoid 函数将任意实数映射到 $[0,1]$ 区间，适合表示概率。</em></p><p><strong>似然函数</strong>：</p><p>$$
\begin{aligned}
L(w) &= \prod_{i=1}^{n} P(y_i \mid x_i, w) \
&= \prod_{i=1}^{n} [\sigma(w^\top x_i)]^{y_i} [1 - \sigma(w^\top x_i)]^{1-y_i}
\end{aligned}
$$</p><p><strong>对数似然</strong>：</p><p>$$
\ell(w) = \sum_{i=1}^{n} [y_i \log \sigma(w^\top x_i) + (1 - y_i) \log(1 - \sigma(w^\top x_i))]
$$</p><p><strong>优化</strong>：最大化对数似然等价于最小化负对数似然（交叉熵损失）：</p><p>$$
w^* = \arg\min_w \sum_{i=1}^{n} [y_i \log \sigma(w^\top x_i) + (1 - y_i) \log(1 - \sigma(w^\top x_i))]
$$</p><h2 id=结语>结语<a hidden class=anchor aria-hidden=true href=#结语>#</a></h2><p>在这篇文章中，我们系统地介绍了概率论与数理统计在机器学习中的应用。</p><p><strong>核心要点回顾</strong>：</p><ol><li><p><strong>贝叶斯公式</strong>是机器学习的核心思想，告诉我们如何根据观测数据更新对模型的信念</p></li><li><p><strong>MLE 和 MAP</strong> 是两种主要的参数估计方法。MLE 寻找使观测数据出现概率最大的参数，而 MAP 则结合了先验信息</p></li><li><p><strong>概率分布</strong>为机器学习提供了丰富的建模工具。正态分布、二项分布、伯努利分布等在不同场景中发挥重要作用</p></li><li><p><strong>信息论</strong>为机器学习提供了度量不确定性的工具。熵、KL 散度和交叉熵是许多损失函数的理论基础</p></li><li><p><strong>概率模型</strong>如逻辑回归、高斯过程、EM 算法等为机器学习提供了坚实的理论基础</p></li></ol><p>没有概率论，我们无法理解过拟合现象，无法量化预测的不确定性，也无法设计出鲁棒可靠的算法。</p><p><strong>未来的方向</strong>：</p><p>随着深度学习的发展，贝叶斯深度学习、不确定性量化、主动学习等方向越来越受到关注。这些方向的共同特点是更加重视对不确定性的理解和建模。</p><p>希望这篇文章能够帮助读者建立概率论与数理统计在机器学习中的整体认识，为更深入的学习和研究打下坚实的基础。</p><h2 id=参考文献>参考文献<a hidden class=anchor aria-hidden=true href=#参考文献>#</a></h2><ol><li>Bishop, C. M. (2006). <em>Pattern Recognition and Machine Learning</em>. Springer.</li><li>Murphy, K. P. (2012). <em>Machine Learning: A Probabilistic Perspective</em>. MIT Press.</li><li>Goodfellow, I., Bengio, Y., & Courville, A. (2016). <em>Deep Learning</em>. MIT Press.</li><li>MacKay, D. J. (2003). <em>Information Theory, Inference, and Learning Algorithms</em>. Cambridge University Press.</li><li>Cover, T. M., & Thomas, J. A. (2006). <em>Elements of Information Theory</em> (2nd ed.). Wiley.</li><li>Rasmussen, C. E., & Williams, C. K. I. (2006). <em>Gaussian Processes for Machine Learning</em>. MIT Press.</li></ol></div><footer class=post-footer><ul class=post-tags><li><a href=https://s-ai-unix.github.io/tags/%E6%A6%82%E7%8E%87%E8%AE%BA/>概率论</a></li><li><a href=https://s-ai-unix.github.io/tags/%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1/>数理统计</a></li><li><a href=https://s-ai-unix.github.io/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/>机器学习</a></li><li><a href=https://s-ai-unix.github.io/tags/%E7%BB%BC%E8%BF%B0/>综述</a></li></ul><nav class=paginav><a class=prev href=https://s-ai-unix.github.io/posts/2026-01-25-pde-overview/><span class=title>« Prev</span><br><span>偏微分方程：描述物理世界的数学语言</span>
</a><a class=next href=https://s-ai-unix.github.io/posts/2026-01-25-linear-algebra-complete-guide/><span class=title>Next »</span><br><span>线性代数：从理论到 AI 应用的完整旅程</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share 概率论与数理统计：机器学习的概率基石 on x" href="https://x.com/intent/tweet/?text=%e6%a6%82%e7%8e%87%e8%ae%ba%e4%b8%8e%e6%95%b0%e7%90%86%e7%bb%9f%e8%ae%a1%ef%bc%9a%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e7%9a%84%e6%a6%82%e7%8e%87%e5%9f%ba%e7%9f%b3&amp;url=https%3a%2f%2fs-ai-unix.github.io%2fposts%2f2026-01-25-probability-statistics-ml-guide%2f&amp;hashtags=%e6%a6%82%e7%8e%87%e8%ae%ba%2c%e6%95%b0%e7%90%86%e7%bb%9f%e8%ae%a1%2c%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%2c%e7%bb%bc%e8%bf%b0"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 概率论与数理统计：机器学习的概率基石 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fs-ai-unix.github.io%2fposts%2f2026-01-25-probability-statistics-ml-guide%2f&amp;title=%e6%a6%82%e7%8e%87%e8%ae%ba%e4%b8%8e%e6%95%b0%e7%90%86%e7%bb%9f%e8%ae%a1%ef%bc%9a%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e7%9a%84%e6%a6%82%e7%8e%87%e5%9f%ba%e7%9f%b3&amp;summary=%e6%a6%82%e7%8e%87%e8%ae%ba%e4%b8%8e%e6%95%b0%e7%90%86%e7%bb%9f%e8%ae%a1%ef%bc%9a%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e7%9a%84%e6%a6%82%e7%8e%87%e5%9f%ba%e7%9f%b3&amp;source=https%3a%2f%2fs-ai-unix.github.io%2fposts%2f2026-01-25-probability-statistics-ml-guide%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 概率论与数理统计：机器学习的概率基石 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fs-ai-unix.github.io%2fposts%2f2026-01-25-probability-statistics-ml-guide%2f&title=%e6%a6%82%e7%8e%87%e8%ae%ba%e4%b8%8e%e6%95%b0%e7%90%86%e7%bb%9f%e8%ae%a1%ef%bc%9a%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e7%9a%84%e6%a6%82%e7%8e%87%e5%9f%ba%e7%9f%b3"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 概率论与数理统计：机器学习的概率基石 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fs-ai-unix.github.io%2fposts%2f2026-01-25-probability-statistics-ml-guide%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li></ul></footer><script src=https://giscus.app/client.js data-repo=s-ai-unix/blog data-repo-id=R_kgDOQ3Njaw data-category=General data-category-id=DIC_kwDOQ3Nja84C0yve data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=zh-CN data-loading=lazy crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2026 <a href=https://s-ai-unix.github.io/>s-ai-unix's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>(function(){"use strict";function e(){var e=document.querySelectorAll("p, li, td, div, span, h1, h2, h3, h4, h5, h6, ol, ul");e.forEach(function(e){if(e.classList.contains("classical-quote-container")||e.classList.contains("quote-text")||e.closest(".classical-quote-container"))return;var n,t=e.innerHTML,s=!1;for(t.indexOf("<em>")!==-1&&(n=t.replace(/\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$/g,function(e,t,n,s){return/^[\d.,]+$/.test((t+n+s).replace(/[.,]/g,""))?e:"$"+t+"_"+n+s+"$"}),n=n.replace(/\$\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$\$/g,function(e,t,n,s){return"$$"+t+"_"+n+s+"$$"}),n!==t&&(t=n,s=!0)),t.indexOf("</em>")!==-1&&(n=t.replace(/\$([^$]*?)<\/em>([^$]*?)\$/g,function(e,t,n){return"$"+t+"_{"+n+"$"}),n=n.replace(/\$\$([^$]*?)<\/em>([^$]*?)\$\$/g,function(e,t,n){return"$$"+t+"_{"+n+"$$"}),n!==t&&(t=n,s=!0)),t.indexOf("<em>$")!==-1&&(n=t.replace(/<em>\$/g,"$"),n!==t&&(t=n,s=!0)),t.indexOf("</em>$")!==-1&&(n=t.replace(/<\/em>\$/g,"$"),n!==t&&(t=n,s=!0));t.indexOf("<em>")!==-1&&t.indexOf("</em>")!==-1;){if(n=t.replace(/\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$/g,function(e,t,n,s){return/^[\d.,]+$/.test((t+n+s).replace(/[.,]/g,""))?e:"$"+t+"_"+n+s+"$"}),n=n.replace(/\$\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$\$/g,function(e,t,n,s){return"$$"+t+"_"+n+s+"$$"}),n===t)break;t=n,s=!0}t.indexOf("_{")!==-1&&(n=t.replace(/_{/g,"_{"),n!==t&&(t=n,s=!0)),t.indexOf("}_")!==-1&&(n=t.replace(/}_/g,"}"),n!==t&&(t=n,s=!0)),t.indexOf("\\\\")!==-1&&(n=t.replace(/(\$\{1,2\})([^$]*?)(\$\{1,2\})/g,function(e,t,n,s){for(;n.indexOf("\\\\")!==-1;)n=n.replace(/\\\\/g,"\\");return t+n+s}),n!==t&&(t=n,s=!0)),s&&(e.innerHTML=t)})}window.MathJax={tex:{inlineMath:[["$","$"]],displayMath:[["$$","$$"]],processEscapes:!0,processEnvironments:!0,tags:"ams",macros:{oiint:"\\mathop{∯}",oiiint:"\\mathop{∰}"}},options:{skipHtmlTags:["script","noscript","style","textarea","pre","code"]},startup:{pageReady:function(){return e(),MathJax.startup.defaultPageReady().then(function(){console.log("MathJax formulas rendered successfully")})}}}})()</script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link rel=stylesheet href=/css/mermaid-custom.css><script src=/js/mermaid-converter.js></script><script type=module>
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';

  
  setTimeout(() => {
    mermaid.initialize({
      startOnLoad: true,
      theme: 'base',
      themeVariables: {
        primaryColor: '#e3f2fd',
        primaryTextColor: '#1565c0',
        primaryBorderColor: '#2196f3',
        lineColor: '#42a5f5',
        secondaryColor: '#f3e5f5',
        tertiaryColor: '#fff9c4',
        background: '#ffffff',
        mainBkg: '#ffffff',
        nodeBorder: '#2196f3',
        clusterBkg: '#ffffff',
        clusterBorder: '#e0e0e0',
        titleColor: '#1565c0',
        edgeLabelBackground: '#fafafa',
      },
      securityLevel: 'loose',
    });
  }, 100);
</script><script src=/js/toc.js></script><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script>(function(){"use strict";function e(){var e=document.querySelectorAll("p, li, td, div, span, h1, h2, h3, h4, h5, h6, ol, ul");e.forEach(function(e){if(e.classList.contains("classical-quote-container")||e.classList.contains("quote-text")||e.closest(".classical-quote-container"))return;var n,t=e.innerHTML,s=!1;for(t.indexOf("<em>")!==-1&&(n=t.replace(/\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$/g,function(e,t,n,s){return/^[\d.,]+$/.test((t+n+s).replace(/[.,]/g,""))?e:"$"+t+"_"+n+s+"$"}),n=n.replace(/\$\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$\$/g,function(e,t,n,s){return"$$"+t+"_"+n+s+"$$"}),n!==t&&(t=n,s=!0)),t.indexOf("</em>")!==-1&&(n=t.replace(/\$([^$]*?)<\/em>([^$]*?)\$/g,function(e,t,n){return"$"+t+"_{"+n+"$"}),n=n.replace(/\$\$([^$]*?)<\/em>([^$]*?)\$\$/g,function(e,t,n){return"$$"+t+"_{"+n+"$$"}),n!==t&&(t=n,s=!0)),t.indexOf("<em>$")!==-1&&(n=t.replace(/<em>\$/g,"$"),n!==t&&(t=n,s=!0)),t.indexOf("</em>$")!==-1&&(n=t.replace(/<\/em>\$/g,"$"),n!==t&&(t=n,s=!0));t.indexOf("<em>")!==-1&&t.indexOf("</em>")!==-1;){if(n=t.replace(/\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$/g,function(e,t,n,s){return/^[\d.,]+$/.test((t+n+s).replace(/[.,]/g,""))?e:"$"+t+"_"+n+s+"$"}),n=n.replace(/\$\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$\$/g,function(e,t,n,s){return"$$"+t+"_"+n+s+"$$"}),n===t)break;t=n,s=!0}t.indexOf("_{")!==-1&&(n=t.replace(/_{/g,"_{"),n!==t&&(t=n,s=!0)),t.indexOf("}_")!==-1&&(n=t.replace(/}_/g,"}"),n!==t&&(t=n,s=!0)),t.indexOf("\\\\")!==-1&&(n=t.replace(/(\$\{1,2\})([^$]*?)(\$\{1,2\})/g,function(e,t,n,s){for(;n.indexOf("\\\\")!==-1;)n=n.replace(/\\\\/g,"\\");return t+n+s}),n!==t&&(t=n,s=!0)),s&&(e.innerHTML=t)})}window.MathJax={tex:{inlineMath:[["$","$"]],displayMath:[["$$","$$"]],processEscapes:!0,processEnvironments:!0,tags:"ams",macros:{oiint:"\\mathop{∯}",oiiint:"\\mathop{∰}"}},options:{skipHtmlTags:["script","noscript","style","textarea","pre","code"]},startup:{pageReady:function(){return e(),MathJax.startup.defaultPageReady().then(function(){console.log("MathJax formulas rendered successfully")})}}}})()</script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link rel=stylesheet href=/css/mermaid-custom.css><script src=/js/mermaid-converter.js></script><script type=module>
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';

  
  setTimeout(() => {
    mermaid.initialize({
      startOnLoad: true,
      theme: 'base',
      themeVariables: {
        primaryColor: '#e3f2fd',
        primaryTextColor: '#1565c0',
        primaryBorderColor: '#2196f3',
        lineColor: '#42a5f5',
        secondaryColor: '#f3e5f5',
        tertiaryColor: '#fff9c4',
        background: '#ffffff',
        mainBkg: '#ffffff',
        nodeBorder: '#2196f3',
        clusterBkg: '#ffffff',
        clusterBorder: '#e0e0e0',
        titleColor: '#1565c0',
        edgeLabelBackground: '#fafafa',
      },
      securityLevel: 'loose',
    });
  }, 100);
</script><script src=/js/toc.js></script></body></html>