<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>线性代数：从理论到 AI 应用的完整旅程 | s-ai-unix's Blog</title><meta name=keywords content="综述,机器学习,深度学习,数学,几何"><meta name=description content="这是一篇关于线性代数的系统综述，从向量空间的几何直观到深度学习的矩阵运算，全面阐述线性代数在现代人工智能中的核心作用。"><meta name=author content="s-ai-unix"><link rel=canonical href=https://s-ai-unix.github.io/posts/2026-01-25-linear-algebra-complete-guide/><link crossorigin=anonymous href=/assets/css/stylesheet.0833aff7e1cf567ecfb9755701ee95a80535f671e2e1a0a770c9bc20a0a7b5bb.css integrity="sha256-CDOv9+HPVn7PuXVXAe6VqAU19nHi4aCncMm8IKCntbs=" rel="preload stylesheet" as=style><link rel=icon href=https://s-ai-unix.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s-ai-unix.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s-ai-unix.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s-ai-unix.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s-ai-unix.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s-ai-unix.github.io/posts/2026-01-25-linear-algebra-complete-guide/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="https://s-ai-unix.github.io/posts/2026-01-25-linear-algebra-complete-guide/"><meta property="og:site_name" content="s-ai-unix's Blog"><meta property="og:title" content="线性代数：从理论到 AI 应用的完整旅程"><meta property="og:description" content="这是一篇关于线性代数的系统综述，从向量空间的几何直观到深度学习的矩阵运算，全面阐述线性代数在现代人工智能中的核心作用。"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2026-01-25T08:45:00+08:00"><meta property="article:modified_time" content="2026-01-25T08:45:00+08:00"><meta property="article:tag" content="综述"><meta property="article:tag" content="机器学习"><meta property="article:tag" content="深度学习"><meta property="article:tag" content="数学"><meta property="article:tag" content="几何"><meta property="og:image" content="https://s-ai-unix.github.io/images/covers/linear-algebra-journey.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://s-ai-unix.github.io/images/covers/linear-algebra-journey.jpg"><meta name=twitter:title content="线性代数：从理论到 AI 应用的完整旅程"><meta name=twitter:description content="这是一篇关于线性代数的系统综述，从向量空间的几何直观到深度学习的矩阵运算，全面阐述线性代数在现代人工智能中的核心作用。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://s-ai-unix.github.io/posts/"},{"@type":"ListItem","position":2,"name":"线性代数：从理论到 AI 应用的完整旅程","item":"https://s-ai-unix.github.io/posts/2026-01-25-linear-algebra-complete-guide/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"线性代数：从理论到 AI 应用的完整旅程","name":"线性代数：从理论到 AI 应用的完整旅程","description":"这是一篇关于线性代数的系统综述，从向量空间的几何直观到深度学习的矩阵运算，全面阐述线性代数在现代人工智能中的核心作用。","keywords":["综述","机器学习","深度学习","数学","几何"],"articleBody":"引言：为什么线性代数如此重要？ 想象你站在一个开阔的平原上,手中拿着一支箭。这支箭可以指向任何方向,可以伸长或缩短,可以与另一支箭相加。这就是向量的原始概念——一个既有方向又有大小的量。从这样简单的直观出发,人类发展出了一整套描述空间、变换和数据结构的数学语言:线性代数。\n线性代数的美妙之处在于它的简洁性和普遍性。在二维平面上,一个点可以用两个坐标 $(x, y)$ 表示;在三维空间中,需要三个坐标 $(x, y, z)$;而在机器学习中处理的数据可能有一千维、一万维,甚至更高。线性代数提供了一套统一的工具来处理这些高维空间,而且它的规律在任意维数下都保持不变。\n更令人惊讶的是,当你使用 ChatGPT、看 Netflix 推荐、或在 Google 搜索时,背后都有线性代数的身影。深度学习的神经网络本质上就是一系列线性变换和非线性激活的交替组合;推荐系统中的矩阵分解技术直接源自奇异值分解;而搜索引擎的 PageRank 算法则是特征值问题的经典应用。\n在这篇文章中,我们将踏上一段从理论到应用的完整旅程。我们会从向量空间的几何直观出发,理解线性变换的本质,然后逐步深入到机器学习和深度学习的核心算法中。我们不仅会学习\"怎么做\",更重要的是理解\"为什么\"——为什么奇异值分解如此强大?为什么梯度下降会收敛?为什么注意力机制能够工作?\n让我们开始这段旅程。\n第一部分:线性代数基础理论 1. 向量空间的本质 1.1 从几何到抽象 在二维平面上,我们习惯用坐标表示向量。向量 $\\mathbf{v} = (3, 2)$ 表示从原点出发,沿 $x$ 轴移动 3 个单位,再沿 $y$ 轴移动 2 个单位。但向量的概念远不止于此。\n向量空间的抽象定义只需要 8 条公理:\n加法封闭性: $\\mathbf{u} + \\mathbf{v}$ 仍在空间中 加法交换律: $\\mathbf{u} + \\mathbf{v} = \\mathbf{v} + \\mathbf{u}$ 加法结合律: $(\\mathbf{u} + \\mathbf{v}) + \\mathbf{w} = \\mathbf{u} + (\\mathbf{v} + \\mathbf{w})$ 零向量存在: $\\mathbf{0} + \\mathbf{v} = \\mathbf{v}$ 负向量存在: $\\mathbf{v} + (-\\mathbf{v}) = \\mathbf{0}$ 数乘封闭性: $c\\mathbf{v}$ 仍在空间中 数乘分配律: $c(\\mathbf{u} + \\mathbf{v}) = c\\mathbf{u} + c\\mathbf{v}$ 数乘结合律: $c(d\\mathbf{v}) = (cd)\\mathbf{v}$ 这个定义看似抽象,但它统一了各种不同的对象:\n$\\mathbb{R}^n$ 中的几何向量 多项式 $P_n = {a_0 + a_1x + \\cdots + a_nx^n}$ $m \\times n$ 矩阵的集合 $\\mathbb{R}^{m \\times n}$ 函数空间 $L^2([a, b])$ 1.2 线性相关与线性无关 核心思想:一组向量是线性相关的,如果其中一个向量可以表示为其他向量的线性组合。\n考虑二维平面上的两个向量: $$ \\mathbf{v}_1 = \\begin{pmatrix} 1 \\ 0 \\end{pmatrix}, \\quad \\mathbf{v}_2 = \\begin{pmatrix} 2 \\ 0 \\end{pmatrix} $$\n显然 $\\mathbf{v}_2 = 2\\mathbf{v}_1$,所以它们线性相关。几何上,它们指向同一个方向,无法\"张成\"整个二维平面。\n而如果选择: $$ \\mathbf{e}_1 = \\begin{pmatrix} 1 \\ 0 \\end{pmatrix}, \\quad \\mathbf{e}_2 = \\begin{pmatrix} 0 \\ 1 \\end{pmatrix} $$\n那么不存在 $c_1, c_2$ 使得 $c_1\\mathbf{e}_1 + c_2\\mathbf{e}_2 = \\mathbf{0}$,除非 $c_1 = c_2 = 0$。这就是线性无关。\n线性无关的几何意义:每个向量都贡献了一个\"独立的方向\",无法用其他向量替代。\n1.3 基与维数 基是向量空间中最小的一组线性无关生成元。对于 $\\mathbb{R}^3$,标准基是: $$ \\mathbf{e}_1 = \\begin{pmatrix} 1 \\ 0 \\ 0 \\end{pmatrix}, \\quad \\mathbf{e}_2 = \\begin{pmatrix} 0 \\ 1 \\ 0 \\end{pmatrix}, \\quad \\mathbf{e}_3 = \\begin{pmatrix} 0 \\ 0 \\ 1 \\end{pmatrix} $$\n任意向量 $\\mathbf{v} = (v_1, v_2, v_3)^\\top$ 都可以唯一表示为: $$ \\mathbf{v} = v_1\\mathbf{e}_1 + v_2\\mathbf{e}_2 + v_3\\mathbf{e}_3 $$\n维数就是基中向量的个数。这是一个内蕴性质,不依赖于坐标系的选择。无论你用直角坐标、极坐标还是斜坐标,三维空间永远是三维的。\n2. 线性变换的几何意义 2.1 矩阵即变换 理解线性变换的关键是:矩阵不仅仅是数字的阵列,它是对空间的一种操作。\n考虑 $2 \\times 2$ 矩阵: $$ A = \\begin{pmatrix} 2 \u0026 0 \\ 0 \u0026 1 \\end{pmatrix} $$\n当它作用于向量 $\\mathbf{x} = (x, y)^\\top$ 时: $$ A\\mathbf{x} = \\begin{pmatrix} 2 \u0026 0 \\ 0 \u0026 1 \\end{pmatrix} \\begin{pmatrix} x \\ y \\end{pmatrix} = \\begin{pmatrix} 2x \\ y \\end{pmatrix} $$\n这个变换将 $x$ 方向拉伸 2 倍,而 $y$ 方向保持不变。这就是拉伸变换。\n再来看旋转矩阵: $$ R_\\theta = \\begin{pmatrix} \\cos\\theta \u0026 -\\sin\\theta \\ \\sin\\theta \u0026 \\cos\\theta \\end{pmatrix} $$\n当 $\\theta = 90^\\circ$ 时: $$ R_{90^\\circ} = \\begin{pmatrix} 0 \u0026 -1 \\ 1 \u0026 0 \\end{pmatrix} $$\n它将 $(1, 0)^\\top$ 变为 $(0, 1)^\\top$,将 $(0, 1)^\\top$ 变为 $(-1, 0)^\\top$,实现了逆时针旋转 90 度。\n关键洞察:矩阵的列向量就是基向量变换后的位置。对于 $A = [\\mathbf{a}_1, \\mathbf{a}_2]$,$\\mathbf{a}_1$ 就是 $\\mathbf{e}_1$ 变换后的位置, $\\mathbf{a}_2$ 是 $\\mathbf{e}_2$ 变换后的位置。\n图1：矩阵作为线性变换，展示了基向量的变换效果。蓝色和绿色是原始基向量，紫色和深蓝色是变换后的基向量。\n2.2 特征值与特征向量 核心问题:对于一个线性变换 $A$,是否存在某些方向,使得变换后只改变长度,不改变方向?\n数学上,我们寻找满足: $$ A\\mathbf{v} = \\lambda\\mathbf{v} $$\n的非零向量 $\\mathbf{v}$ 和标量 $\\lambda$。这样的 $\\mathbf{v}$ 称为特征向量,$\\lambda$ 称为特征值。\n物理意义:\n$|\\lambda| \u003e 1$: 沿该方向拉伸 $|\\lambda| \u003c 1$: 沿该方向压缩 $\\lambda \u003c 0$: 沿该方向翻转 $\\lambda = 0$: 将该方向压扁为零 计算方法:特征方程 $$ \\det(A - \\lambda I) = 0 $$\n对于 $2 \\times 2$ 矩阵: $$ A = \\begin{pmatrix} a \u0026 b \\ c \u0026 d \\end{pmatrix} $$\n特征方程为: $$ \\begin{vmatrix} a-\\lambda \u0026 b \\ c \u0026 d-\\lambda \\end{vmatrix} = (a-\\lambda)(d-\\lambda) - bc = 0 $$\n展开得到: $$ \\lambda^2 - (a+d)\\lambda + (ad-bc) = 0 $$\n其中 $a+d = \\operatorname{tr}(A)$ 是迹,$ad-bc = \\det(A)$ 是行列式。\n图2：特征向量是保持方向不变的变换方向。图中展示了变换前后的网格点以及特征向量（蓝色和橙色箭头）。\n几何应用:如果一个 $3 \\times 3$ 矩阵有三个线性无关的特征向量,那么我们可以沿这些特征向量的方向理解变换。例如,应力张量的特征向量表示主应力方向。\n2.3 对角化与相似变换 对角化是将矩阵分解为: $$ A = P \\Lambda P^{-1} $$\n其中 $\\Lambda$ 是对角矩阵(对角线上是特征值),$P$ 的列向量是对应的特征向量。\n为什么对角化有用?\n计算矩阵幂: $$ A^k = P \\Lambda^k P^{-1} = P \\begin{pmatrix} \\lambda_1^k \u0026 \u0026 \\ \u0026 \\ddots \u0026 \\ \u0026 \u0026 \\lambda_n^k \\end{pmatrix} P^{-1} $$\n这在计算 Markov 链的长期行为时至关重要。\n解微分方程: 对于 $\\frac{d\\mathbf{x}}{dt} = A\\mathbf{x}$,令 $\\mathbf{x} = P\\mathbf{y}$,则: $$ \\frac{d\\mathbf{y}}{dt} = \\Lambda \\mathbf{y} \\implies y_i(t) = y_i(0) e^{\\lambda_i t} $$\n理解系统演化: 特征值决定稳定性:\n$\\operatorname{Re}(\\lambda_i) \u003c 0$: 衰减 $\\operatorname{Re}(\\lambda_i) \u003e 0$: 增长(不稳定) 相似变换的几何意义: $B = P^{-1}AP$ 表示在另一个坐标系下看同一个变换。如果 $P$ 由特征向量组成,那么在这个坐标系下,变换矩阵是对角的——每个方向独立演化。\n3. 内积空间与正交性 3.1 内积的双重性 内积 $\\langle \\mathbf{u}, \\mathbf{v} \\rangle$ 有两个等价定义:\n代数定义(标准内积): $$ \\langle \\mathbf{u}, \\mathbf{v} \\rangle = \\mathbf{u}^T \\mathbf{v} = \\sum_{i=1}^n u_i v_i $$\n几何定义: $$ \\langle \\mathbf{u}, \\mathbf{v} \\rangle = |\\mathbf{u}| |\\mathbf{v}| \\cos\\theta $$\n其中 $\\theta$ 是两向量夹角。这个等式给出了余弦定理: $$ \\cos\\theta = \\frac{\\langle \\mathbf{u}, \\mathbf{v} \\rangle}{|\\mathbf{u}| |\\mathbf{v}|} $$\n关键应用:\n$\\cos\\theta = 0 \\iff \\langle \\mathbf{u}, \\mathbf{v} \\rangle = 0$: 正交 $\\cos\\theta = 1 \\iff \\mathbf{u} = c\\mathbf{v}, c \u003e 0$: 同向 $\\cos\\theta = -1 \\iff \\mathbf{u} = c\\mathbf{v}, c \u003c 0$: 反向 在自然语言处理中,词向量的夹角余弦用于衡量语义相似度。\n3.2 正交投影与最小二乘法 投影问题:给定向量 $\\mathbf{b}$ 和子空间 $W$,找到 $\\mathbf{b}$ 在 $W$ 上的投影 $\\mathbf{p}$。\n几何直觉:\n$\\mathbf{p} \\in W$ 误差 $\\mathbf{e} = \\mathbf{b} - \\mathbf{p}$ 与 $W$ 正交 代数推导:\n设 $W$ 由 $\\mathbf{a}_1, \\ldots, \\mathbf{a}_n$ 张成,记 $A = [\\mathbf{a}_1, \\ldots, \\mathbf{a}_n]$。投影为: $$ \\mathbf{p} = A\\hat{\\mathbf{x}} $$\n正交条件: $A^\top(\\mathbf{b} - A\\hat{\\mathbf{x}}) = \\mathbf{0}$,因此: $$ A^\top A \\hat{\\mathbf{x}} = A^\top \\mathbf{b} $$\n这就是正规方程(Normal Equation)。\n最小二乘法:当 $A\\mathbf{x} = \\mathbf{b}$ 无解时(超定方程组),我们寻找使 $|\\mathbf{b} - A\\mathbf{x}|^2$ 最小的 $\\hat{\\mathbf{x}}$。这个最小解恰好满足正规方程。\n投影矩阵: $$ P = A(A^\top A)^{-1} A^\top $$\n它将任意向量投影到 $A$ 的列空间。性质:\n$P^2 = P$(幂等) $P^T = P$(对称) 3.3 Gram-Schmidt 正交化 目标:从一组线性无关向量 ${\\mathbf{v}_1, \\ldots, \\mathbf{v}_n}$ 构造标准正交基 ${\\mathbf{q}_1, \\ldots, \\mathbf{q}_n}$。\n算法:\n$\\mathbf{u}_1 = \\mathbf{v}_1$, $\\mathbf{q}_1 = \\frac{\\mathbf{u}_1}{|\\mathbf{u}_1|}$\n$\\mathbf{u}_2 = \\mathbf{v}_2 - \\langle \\mathbf{v}_2, \\mathbf{q}_1 \\rangle \\mathbf{q}_1$, $\\mathbf{q}_2 = \\frac{\\mathbf{u}_2}{|\\mathbf{u}_2|}$\n一般地: $$ \\mathbf{u}_k = \\mathbf{v}k - \\sum{i=1}^{k-1} \\langle \\mathbf{v}_k, \\mathbf{q}_i \\rangle \\mathbf{q}_i $$\n几何解释:每次减去已构造方向的投影,确保新方向与之前所有方向正交。\n矩阵分解: $A = QR$,其中 $Q$ 是正交矩阵($Q^T Q = I$),$R$ 是上三角矩阵。这在数值计算中非常稳定。\n4. 奇异值分解(SVD) 4.1 SVD 的几何直观 奇异值分解定理:任意 $m \\times n$ 矩阵 $A$ 都可以分解为: $$ A = U \\Sigma V^\top $$\n其中:\n$U$ 是 $m \\times m$ 正交矩阵($U^T U = I_m$) $V$ 是 $n \\times n$ 正交矩阵($V^\top V = I_n$) $\\Sigma$ 是 $m \\times n$ 对角矩阵,对角线元素 $\\sigma_1 \\geq \\sigma_2 \\geq \\cdots \\geq \\sigma_r \u003e 0$ 是奇异值 几何意义:任何线性变换都可以分解为三个步骤:\n旋转/反射($V^\top$) 沿坐标轴拉伸/压缩($\\Sigma$) 再旋转/反射($U$) 图3：奇异值分解的几何步骤：原始单位圆（绿色）→ 旋转（橙色）→ 拉伸成椭圆（蓝色）→ 再旋转（紫色）。\n与特征值分解的关系:\n对于方阵 $A$,奇异值是特征值的平方根: $\\sigma_i = \\sqrt{\\lambda_i(A^\top A)}$ 特征值分解要求矩阵可对角化,SVD 对任意矩阵都成立 SVD 给出两个正交基(输入和输出空间),而特征值分解只给一个 4.2 为什么 SVD 是\"瑞士军刀\"? 应用 1:低秩近似\n取前 $k$ 个奇异值: $$ A_k = \\sum_{i=1}^k \\sigma_i \\mathbf{u}_i \\mathbf{v}_i^T $$\n这在 Frobenius 范数下是最优的 $k$ 秩近似。图像压缩、推荐系统都基于此。\nEckart-Young 定理: $$ |A - A_k|F = \\sqrt{\\sum{i=k+1}^r \\sigma_i^2} = \\min_{\\operatorname{rank}(B)=k} |A - B|_F $$\n应用 2:伪逆\n对于 $A$ 的 Moore-Penrose 伪逆: $$ A^+ = V \\Sigma^+ U^T $$\n其中 $\\Sigma^+$ 将 $\\Sigma$ 的非零对角元取倒数后转置。最小二乘解为: $$ \\hat{\\mathbf{x}} = A^+ \\mathbf{b} $$\n应用 3:条件数\n$$ \\kappa(A) = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}} $$\n条件数衡量矩阵对扰动的敏感度。$\\kappa(A)$ 大说明病态问题,小误差会被放大。\n4.3 SVD 的计算推导 核心思想: $A^\top A$ 和 $AA^\top$ 是对称半正定矩阵,必可对角化。\n推导步骤:\n$A^\top A = (V \\Sigma^T U^T)(U \\Sigma V^\top) = V \\Sigma^T \\Sigma V^\top$\n这说明 $V$ 的列向量是 $A^\top A$ 的特征向量。\n$AA^\top = (U \\Sigma V^\top)(V \\Sigma^T U^T) = U \\Sigma \\Sigma^T U^T$\n这说明 $U$ 的列向量是 $AA^\top$ 的特征向量。\n$\\Sigma^T \\Sigma$ 和 $\\Sigma \\Sigma^T$ 的对角元都是 $\\sigma_i^2$。\n数值稳定性:实际计算时,先对 $A^\top A$ 做 QR 分解,避免显式构造 $A^\top A$ 以减少误差。\n第二部分:机器学习中的线性代数 1. 最小二乘法与回归 1.1 问题设定 给定 $n$ 个样本 $(\\mathbf{x}_i, y_i)$,其中 $\\mathbf{x}_i \\in \\mathbb{R}^d$, $y_i \\in \\mathbb{R}$。线性模型: $$ y = \\mathbf{w}^T \\mathbf{x} + b $$\n令 $\\tilde{\\mathbf{x}} = (1, \\mathbf{x}^\\top)^\\top$,$\\tilde{\\mathbf{w}} = (b, \\mathbf{w}^\\top)^\\top$,则: $$ y = \\tilde{\\mathbf{w}}^T \\tilde{\\mathbf{x}} $$\n写成矩阵形式: $$ \\mathbf{y} = X \\mathbf{w} $$\n其中 $X \\in \\mathbb{R}^{n \\times (d+1)}$ 是设计矩阵。\n1.2 正规方程推导 目标:最小化平方误差: $$ J(\\mathbf{w}) = |\\mathbf{y} - X\\mathbf{w}|^2 = (\\mathbf{y} - X\\mathbf{w})^\\top(\\mathbf{y} - X\\mathbf{w}) $$\n展开: $$ J(\\mathbf{w}) = \\mathbf{y}^T\\mathbf{y} - 2\\mathbf{w}^T X^\top \\mathbf{y} + \\mathbf{w}^T X^\top X \\mathbf{w} $$\n求导: $$ \\frac{\\partial J}{\\partial \\mathbf{w}} = -2 X^\top \\mathbf{y} + 2 X^\top X \\mathbf{w} $$\n令导数为零: $$ X^\top X \\mathbf{w} = X^\top \\mathbf{y} $$\n这就是正规方程,解为: $$ \\mathbf{w}^* = (X^\top X)^{-1} X^\top \\mathbf{y} $$\n几何解释: $X\\mathbf{w}$ 是 $X$ 列空间中的向量,正规方程确保 $\\mathbf{y} - X\\mathbf{w}$ 与列空间正交。\n1.3 岭回归与几何意义 问题:当 $X^\top X$ 接近奇异时,解不稳定。岭回归加入 $L_2$ 正则: $$ J(\\mathbf{w}) = |\\mathbf{y} - X\\mathbf{w}|^2 + \\lambda |\\mathbf{w}|^2 $$\n推导得到: $$ \\mathbf{w}^* = (X^\top X + \\lambda I)^{-1} X^\top \\mathbf{y} $$\n几何意义: $\\lambda I$ 确保矩阵正定,等价于:\n限制解的范数 从贝叶斯角度,等价于高斯先验 核回归:通过特征映射 $\\phi(\\mathbf{x})$,将线性模型扩展到非线性: $$ y = \\mathbf{w}^T \\phi(\\mathbf{x}) $$\n使用核技巧,只需计算 $K(\\mathbf{x}_i, \\mathbf{x}_j) = \\langle \\phi(\\mathbf{x}_i), \\phi(\\mathbf{x}_j) \\rangle$。\n2. 主成分分析(PCA) 2.1 方差最大化视角 目标:找到投影方向 $\\mathbf{u}$($|\\mathbf{u}| = 1$),使投影后方差最大。\n给定中心化数据 $X \\in \\mathbb{R}^{n \\times d}$,投影为: $$ \\mathbf{z} = X \\mathbf{u} $$\n方差为: $$ \\operatorname{Var}(\\mathbf{z}) = \\frac{1}{n} \\mathbf{u}^T X^\top X \\mathbf{u} = \\mathbf{u}^T \\Sigma \\mathbf{u} $$\n其中 $\\Sigma = \\frac{1}{n} X^\top X$ 是协方差矩阵。\n优化问题: $$ \\max_{\\mathbf{u}} \\mathbf{u}^T \\Sigma \\mathbf{u} \\quad \\text{s.t.} \\quad |\\mathbf{u}| = 1 $$\n使用拉格朗日乘子: $$ \\mathcal{L}(\\mathbf{u}, \\lambda) = \\mathbf{u}^T \\Sigma \\mathbf{u} - \\lambda(\\mathbf{u}^T \\mathbf{u} - 1) $$\n求导: $$ 2 \\Sigma \\mathbf{u} - 2 \\lambda \\mathbf{u} = 0 \\implies \\Sigma \\mathbf{u} = \\lambda \\mathbf{u} $$\n这说明 $\\mathbf{u}$ 是 $\\Sigma$ 的特征向量,$\\lambda$ 是特征值。目标函数值为: $$ \\mathbf{u}^T \\Sigma \\mathbf{u} = \\mathbf{u}^T \\lambda \\mathbf{u} = \\lambda |\\mathbf{u}|^2 = \\lambda $$\n结论:第一主方向是最大特征值对应的特征向量,方差为该特征值。\n2.2 SVD 视角下的 PCA 对数据中心化后做 SVD: $$ X = U \\Sigma V^\top $$\n主成分方向是 $V$ 的列向量,主成分得分是 $U \\Sigma$。\n优势:\n避免显式计算协方差矩阵(数值更稳定) 同时得到方向、得分、方差 图4：主成分分析找到方差最大的投影方向。灰色点是原始数据，蓝色箭头是第一主成分（方差最大），橙色箭头是第二主成分，绿色点是投影到第一主成分的结果。\n降维:保留前 $k$ 个主成分: $$ X \\approx U_k \\Sigma_k V_k^T $$\n低维表示: $Z = X V_k = U_k \\Sigma_k$\n2.3 数据去相关 原始数据的协方差矩阵 $\\Sigma$ 一般不是对角的。PCA 后: $$ \\operatorname{Cov}(Z) = \\operatorname{Cov}(X V) = V^\top \\operatorname{Cov}(X) V = V^\top \\Sigma V = \\Lambda $$\n其中 $\\Lambda$ 是对角矩阵,说明主成分之间不相关。\n应用:\n降维可视化(t-SNE 的预处理) 去噪(保留大方差成分) 特征提取(图像识别) 3. 特征值问题的应用 3.1 PageRank 算法 核心思想:网页的重要性取决于指向它的其他网页的重要性。\n数学模型:网页的 PageRank 值是转移矩阵 $M$ 的平稳分布: $$ \\mathbf{p} = M \\mathbf{p} $$\n其中:\n$p_i$ 是网页 $i$ 的 PageRank $M_{ij} = \\frac{1}{d_j}$ 如果网页 $j$ 链接到 $i$($d_j$ 是 $j$ 的出度) 这本质上是求特征值 1 对应的特征向量。\n问题: $M$ 可能不可约,没有唯一平稳分布。Google 使用: $$ G = \\alpha M + (1-\\alpha) \\frac{1}{n}\\mathbf{1}\\mathbf{1}^T $$\n其中 $\\alpha \\approx 0.85$。 $G$ 是随机矩阵,由 Perron-Frobenius 定理,存在唯一正特征向量。\n幂法迭代: $$ \\mathbf{p}^{(t+1)} = G \\mathbf{p}^{(t)} $$\n收敛到最大特征值对应的特征向量。\n3.2 谱聚类 目标:将图划分为若干社区,使得社区内连接紧密,社区间连接稀疏。\n拉普拉斯矩阵: $$ L = D - A $$\n其中 $D$ 是度矩阵($D_{ii} = \\sum_j A_{ij}$),$A$ 是邻接矩阵。\n性质:\n$L$ 是对称半正定矩阵 特征值 $0 = \\lambda_1 \\leq \\lambda_2 \\leq \\cdots \\leq \\lambda_n$ $\\lambda_2$ 称为代数连通度(algebraic connectivity) 谱聚类算法:\n计算拉普拉斯矩阵 $L$ 的前 $k$ 个小特征值对应的特征向量 $\\mathbf{u}_1, \\ldots, \\mathbf{u}_k$ 构造矩阵 $U \\in \\mathbb{R}^{n \\times k}$ 在 $\\mathbb{R}^k$ 中对 $U$ 的行做 k-means 聚类 几何直觉:特征向量给出了节点在低维空间中的嵌入,相似节点距离近。\n3.3 图神经网络 消息传递: $$ \\mathbf{h}v^{(t+1)} = \\sigma\\left(\\sum{u \\in \\mathcal{N}(v)} W^{(t)} \\mathbf{h}_u^{(t)}\\right) $$\n写成矩阵形式: $$ H^{(t+1)} = \\sigma(A H^{(t)} W^{(t)}) $$\n其中 $A$ 是邻接矩阵(可能加上自环和归一化)。\n谱图卷积:通过图傅里叶变换定义卷积: $$ \\hat{f} = U^T f, \\quad g * f = U (U^T g \\odot U^T f) $$\n其中 $U$ 是拉普拉斯矩阵的特征向量矩阵。\n第三部分:深度学习中的线性代数 1. 前向传播的线性代数 1.1 矩阵乘法的计算效率 全连接层: $$ \\mathbf{y} = \\sigma(W \\mathbf{x} + \\mathbf{b}) $$\n对于批量数据 $X \\in \\mathbb{R}^{n \\times d_{\\text{in}}}$: $$ Z = X W^\top + \\mathbf{b} = \\begin{pmatrix} \\mathbf{x}_1^T \\ \\vdots \\ \\mathbf{x}n^T \\end{pmatrix} \\begin{pmatrix} \\mathbf{w}1 \u0026 \\cdots \u0026 \\mathbf{w}{d{\\text{out}}} \\end{pmatrix} + \\mathbf{1}\\mathbf{b}^T $$\n计算复杂度: $O(n \\cdot d_{\\text{in}} \\cdot d_{\\text{out}})$\n内存布局:现代深度学习框架使用列主序存储,利用缓存局部性加速。\n1.2 批量处理的向量化 向量化 vs. 循环:\n不高效:\nfor i in range(batch_size): for j in range(output_dim): z[i, j] = np.dot(x[i], w[j]) + b[j] 高效:\nZ = X @ W.T + b # 利用 BLAS 优化 GPU 加速:GPU 有数千个核心,适合并行执行大量小运算。矩阵乘法可以分解为:\n线程块处理子矩阵 线程内处理标量运算 共享内存减少全局内存访问 1.3 广播机制的数学本质 广播规则:\n对齐尾部维度 维度为 1 时复制 缺失维度视为 1 例子: $$ X \\in \\mathbb{R}^{n \\times d}, \\quad \\mathbf{b} \\in \\mathbb{R}^d $$\n$$ X + \\mathbf{b} = X + \\mathbf{1}_{n \\times 1} \\mathbf{b}^T $$\n张量广播: $$ X \\in \\mathbb{R}^{n \\times d_1 \\times d_2}, \\quad \\mathbf{b} \\in \\mathbb{R}^{d_2} $$\n$$ X + \\mathbf{b} = X + \\mathbf{1}{n \\times d_1 \\times 1} \\times \\mathbf{b}{1 \\times 1 \\times d_2} $$\n广播本质上是外积的特殊情况。\n2. 反向传播与梯度计算 2.1 链式法则的矩阵形式 标量情况: $$ \\frac{\\partial L}{\\partial x} = \\frac{\\partial L}{\\partial y} \\cdot \\frac{\\partial y}{\\partial x} $$\n向量情况: $$ \\frac{\\partial L}{\\partial \\mathbf{x}} = \\left(\\frac{\\partial \\mathbf{y}}{\\partial \\mathbf{x}}\\right)^\top \\frac{\\partial L}{\\partial \\mathbf{y}} $$\n其中 $\\frac{\\partial \\mathbf{y}}{\\partial \\mathbf{x}}$ 是 Jacobian 矩阵: $$ J_{ij} = \\frac{\\partial y_i}{\\partial x_j} $$\n全连接层: $$ \\mathbf{z} = W \\mathbf{x} + \\mathbf{b}, \\quad \\mathbf{y} = \\sigma(\\mathbf{z}) $$\n梯度计算: $$ \\frac{\\partial L}{\\partial \\mathbf{z}} = \\frac{\\partial L}{\\partial \\mathbf{y}} \\odot \\sigma’(\\mathbf{z}) $$\n$$ \\frac{\\partial L}{\\partial W} = \\frac{\\partial L}{\\partial \\mathbf{z}} \\mathbf{x}^T $$\n$$ \\frac{\\partial L}{\\partial \\mathbf{b}} = \\frac{\\partial L}{\\partial \\mathbf{z}} $$\n$$ \\frac{\\partial L}{\\partial \\mathbf{x}} = W^\top \\frac{\\partial L}{\\partial \\mathbf{z}} $$\n2.2 Jacobian 矩阵的计算 定义:对于 $f: \\mathbb{R}^n \\to \\mathbb{R}^m$, Jacobian 矩阵为: $$ J_f(\\mathbf{x}) = \\begin{pmatrix} \\frac{\\partial f_1}{\\partial x_1} \u0026 \\cdots \u0026 \\frac{\\partial f_1}{\\partial x_n} \\ \\vdots \u0026 \\ddots \u0026 \\vdots \\ \\frac{\\partial f_m}{\\partial x_1} \u0026 \\cdots \u0026 \\frac{\\partial f_m}{\\partial x_n} \\end{pmatrix} $$\n链式法则: $$ J_{g \\circ f}(\\mathbf{x}) = J_g(f(\\mathbf{x})) \\cdot J_f(\\mathbf{x}) $$\n自动微分:\n前向模式:计算 $J \\mathbf{v}$(适合 $n \\ll m$) 反向模式:计算 $J^T \\mathbf{v}$(适合 $m \\ll n$,即损失函数是标量) 深度学习使用反向模式,因为 $L$ 是标量。\n2.3 梯度消失/爆炸的线性代数视角 简化模型:考虑 $t$ 层线性网络(忽略激活): $$ \\mathbf{h}^{(t)} = W^{(t)} \\mathbf{h}^{(t-1)} $$\n输出对输入的梯度: $$ \\frac{\\partial L}{\\partial \\mathbf{h}^{(0)}} = (W^{(t)})^\top \\cdots (W^{(1)})^\top \\frac{\\partial L}{\\partial \\mathbf{h}^{(t)}} $$\n谱分析:令 $\\sigma_{\\max}^{(i)}$ 为 $W^{(i)}$ 的最大奇异值。梯度范数为: $$ \\left|\\frac{\\partial L}{\\partial \\mathbf{h}^{(0)}}\\right| \\approx \\left(\\prod_{i=1}^t \\sigma_{\\max}^{(i)}\\right) \\left|\\frac{\\partial L}{\\partial \\mathbf{h}^{(t)}}\\right| $$\n如果 $\\sigma_{\\max}^{(i)} \u003e 1$: 梯度爆炸 如果 $\\sigma_{\\max}^{(i)} \u003c 1$: 梯度消失 Xavier 初始化: $$ W_{ij} \\sim \\mathcal{N}\\left(0, \\frac{2}{n_{\\text{in}} + n_{\\text{out}}}\\right) $$\n保持前向和反向激活的方差稳定。\n3. 正则化的几何意义 3.1 L2 正则与欧氏空间投影 目标函数: $$ J(\\mathbf{w}) = |\\mathbf{y} - X\\mathbf{w}|^2 + \\lambda |\\mathbf{w}|^2 $$\n等价约束优化: $$ \\min_{\\mathbf{w}} |\\mathbf{y} - X\\mathbf{w}|^2 \\quad \\text{s.t.} \\quad |\\mathbf{w}|^2 \\leq C $$\n几何解释:\n无约束解 $\\mathbf{w}_{\\text{LS}} = (X^\top X)^{-1} X^\top \\mathbf{y}$ L2 正则解向原点收缩 等价于高斯先验: $\\mathbf{w} \\sim \\mathcal{N}(0, \\lambda^{-1} I)$ 贝叶斯解释: $$ \\text{MAP} = \\arg\\max_{\\mathbf{w}} \\log P(\\mathbf{y}|X, \\mathbf{w}) + \\log P(\\mathbf{w}) $$\n高斯似然 + 高斯先验 = 最小二乘 + L2 正则\n3.2 L1 正则与稀疏性 目标函数: $$ J(\\mathbf{w}) = |\\mathbf{y} - X\\mathbf{w}|^2 + \\lambda |\\mathbf{w}|_1 $$\n几何: L1 球是\"菱形\",角点在坐标轴上。优化倾向于解落在角点,导致某些坐标为零。\n次梯度: L1 不可导,使用次梯度: $$ \\partial |w_i| = \\begin{cases} {1} \u0026 w_i \u003e 0 \\ {-1} \u0026 w_i \u003c 0 \\ [-1, 1] \u0026 w_i = 0 \\end{cases} $$\n软阈值算子(ISTA): $$ w_i \\leftarrow \\operatorname{sign}(w_i) \\max(|w_i| - \\lambda, 0) $$\n应用:特征选择、压缩感知、稀疏编码。\n3.3 Dropout 的线性代数解释 训练时: $$ \\mathbf{h} = \\mathbf{m} \\odot \\sigma(W \\mathbf{x}) $$\n其中 $\\mathbf{m} \\sim \\operatorname{Bernoulli}(p)$。\n期望: $$ \\mathbb{E}[\\mathbf{h}] = p \\cdot \\sigma(W \\mathbf{x}) $$\n测试时:使用 $p \\sigma(W \\mathbf{x})$ 或 $\\sigma(p W \\mathbf{x})$(反向缩放)。\n正则化效果:\n防止共适应 等价于集成学习( Bagging) 近似贝叶斯推断(高斯过程) 4. 注意力机制 4.1 注意力的矩阵运算 缩放点积注意力: $$ \\operatorname{Attention}(Q, K, V) = \\operatorname{softmax}\\left(\\frac{QK^T}{\\sqrt{d_k}}\\right) V $$\n其中:\n$Q \\in \\mathbb{R}^{n \\times d_k}$: Query 矩阵 $K \\in \\mathbb{R}^{m \\times d_k}$: Key 矩阵 $V \\in \\mathbb{R}^{m \\times d_v}$: Value 矩阵 计算步骤:\n计算相似度: $S = QK^T \\in \\mathbb{R}^{n \\times m}$ 缩放: $S / \\sqrt{d_k}$(防止梯度消失) Softmax: $A = \\operatorname{softmax}(S, \\dim=1)$ 加权求和: $\\operatorname{Output} = AV \\in \\mathbb{R}^{n \\times d_v}$ 4.2 Query-Key-Value 的线性代数 物理直觉:\nQuery: 我在找什么? Key: 我有什么标签? Value: 我包含什么信息? 内积相似度: $$ S_{ij} = \\langle \\mathbf{q}_i, \\mathbf{k}_j \\rangle = |\\mathbf{q}_i| |\\mathbf{k}j| \\cos\\theta{ij} $$\nSoftmax 将相似度转换为概率分布: $$ A_{ij} = \\frac{\\exp(S_{ij} / \\sqrt{d_k})}{\\sum_{j’=1}^m \\exp(S_{ij’} / \\sqrt{d_k})} $$\n4.3 自注意力中的矩阵分解 自注意力: $Q = K = V = X W$(其中 $X$ 是输入序列)\n多头注意力: $$ \\operatorname{MultiHead}(Q, K, V) = \\operatorname{Concat}(\\text{head}_1, \\ldots, \\text{head}_h) W^O $$\n$$ \\text{head}_i = \\operatorname{Attention}(QW_i^Q, KW_i^K, VW_i^V) $$\n线性复杂度:对于序列长度 $n$,标准注意力是 $O(n^2)$。\n优化方法:\n稀疏注意力(只注意局部和全局) 线性注意力(使用核技巧) 低秩近似(分解注意力矩阵) 低秩注意力: $$ A \\approx \\tilde{Q} \\tilde{K}^T $$\n其中 $\\tilde{Q} \\in \\mathbb{R}^{n \\times r}$, $\\tilde{K} \\in \\mathbb{R}^{m \\times r}$, $r \\ll \\min(n, m)$。\n第四部分:高级主题 1. 张量分解 1.1 张量的定义 张量是多维数组,是向量和矩阵的推广:\n标量: 0 阶张量 向量: 1 阶张量 矩阵: 2 阶张量 3 阶及更高:高阶张量 符号:\n$\\mathcal{X} \\in \\mathbb{R}^{I_1 \\times I_2 \\times \\cdots \\times I_N}$ 元素: $x_{i_1 i_2 \\cdots i_N}$ 操作:\n模-$n$ 乘法: $\\mathcal{X} \\times_n U$(沿第 $n$ 维与矩阵 $U$ 相乘)\n展开(matricization):将张量重新排列为矩阵\n** Tucker 分解**: $$ \\mathcal{X} \\approx \\mathcal{G} \\times_1 A^{(1)} \\times_2 \\cdots \\times_N A^{(N)} $$\n其中 $\\mathcal{G}$ 是核心张量,$A^{(n)}$ 是因子矩阵。\n1.2 CP 分解 CANDECOMP/PARAFAC(CP)分解: $$ \\mathcal{X} \\approx \\sum_{r=1}^R \\lambda_r \\mathbf{a}_r^{(1)} \\circ \\mathbf{a}_r^{(2)} \\circ \\cdots \\circ \\mathbf{a}_r^{(N)} $$\n其中 $\\circ$ 是外积,$\\lambda_r$ 是权重。\n矩阵情况的特殊形式: $$ X \\approx \\sum_{r=1}^R \\sigma_r \\mathbf{u}_r \\mathbf{v}_r^T $$\n这就是 SVD!\n优点:\n唯一性(在温和条件下) 解释性强 缺点:\n计算困难(NP-hard) 数值不稳定 1.3 张量网络 应用:\n量子多体系统 深度学习压缩 MPS(Matrix Product State): $$ \\mathcal{X}{i_1 i_2 \\cdots i_N} = A^{(1)}{i_1} A^{(2)}{i_2} \\cdots A^{(N)}{i_N} $$\n张量列车(Tensor Train): $$ \\mathcal{X} \\approx \\sum_{r_1, \\ldots, r_{N-1}} G_1^{r_1} \\circ G_2^{r_1 r_2} \\circ \\cdots \\circ G_N^{r_{N-1}} $$\n在深度学习中:\n压缩全连接层 张量分解正则化 优化参数共享 2. 流形学习 2.1 从欧氏空间到黎曼流形 核心假设:高维数据实际位于低维流形上。\n例子:\n人脸图像:变化的只是姿态、光照、表情(少数自由度) 文档:主题空间是低维的 基因表达:受少数调控因子控制 数学定义: 流形 $M$ 是局部同胚于欧氏空间的 Hausdorff 空间。在点 $p \\in M$ 处,存在邻域 $U$ 和同胚 $\\phi: U \\to \\mathbb{R}^d$。\n切空间: $T_p M$ 是 $M$ 在 $p$ 处的线性近似。\n2.2 测地线距离 欧氏距离在流形上不准确: $$ d_{\\text{Euclidean}}(p, q) = |\\phi(p) - \\phi(q)| $$\n测地线距离是流形上最短路径长度: $$ d_{\\text{geodesic}}(p, q) = \\min_{\\gamma} \\int_0^1 |\\dot{\\gamma}(t)| , dt $$\n其中 $\\gamma: [0, 1] \\to M$ 是连接 $p, q$ 的曲线。\nIsomap 算法:\n构建邻域图( k-NN 或 $\\epsilon$-ball) 计算图上最短路径(Floyd-Warshall 或 Dijkstra) 在测地线距离矩阵上做 MDS 2.3 局部线性嵌入(LLE) 假设:流形局部是线性的。\n算法:\n对每个点 $\\mathbf{x}i$,在邻域内拟合线性组合: $$ \\min{W_{ij}} |\\mathbf{x}i - \\sum{j \\in \\mathcal{N}(i)} W_{ij} \\mathbf{x}_j|^2 $$\n约束: $\\sum_j W_{ij} = 1$\n保持权重,在低维空间中重构: $$ \\min_{\\mathbf{y}_i} \\sum_i \\left|\\mathbf{y}i - \\sum_j W{ij} \\mathbf{y}_j\\right|^2 $$\n数学: $W$ 刻画了局部几何,低维嵌入应保持这些关系。\n3. 优化算法的线性代数 3.1 梯度下降的收敛性 目标: $\\min_{\\mathbf{x}} f(\\mathbf{x})$\n梯度下降: $$ \\mathbf{x}^{(t+1)} = \\mathbf{x}^{(t)} - \\eta \\nabla f(\\mathbf{x}^{(t)}) $$\n强凸情况:假设 $f$ 是 $L$-光滑且 $\\mu$-强凸的,则: $$ \\lVert \\mathbf{x}^{(t)} - \\mathbf{x}^* \\rVert^2 \\leq \\left(1 - \\frac{\\mu}{L}\\right)^{t} \\lVert \\mathbf{x}^{(0)} - \\mathbf{x}^* \\rVert^2 $$\n收敛速度依赖于条件数 $\\kappa = L/\\mu$:\n$\\kappa \\approx 1$: 快速收敛 $\\kappa \\gg 1$: 慢收敛(山谷问题) 动量方法: $$ \\mathbf{v}^{(t+1)} = \\beta \\mathbf{v}^{(t)} + \\nabla f(\\mathbf{x}^{(t)}) $$\n$$ \\mathbf{x}^{(t+1)} = \\mathbf{x}^{(t)} - \\eta \\mathbf{v}^{(t+1)} $$\n几何上,动量抑制震荡,加速收敛。\n3.2 牛顿法与 Hessian 矩阵 二阶泰勒展开: $$ f(\\mathbf{x} + \\Delta \\mathbf{x}) \\approx f(\\mathbf{x}) + \\nabla f(\\mathbf{x})^\top \\Delta \\mathbf{x} + \\frac{1}{2} \\Delta \\mathbf{x}^T H(\\mathbf{x}) \\Delta \\mathbf{x} $$\n其中 $H(\\mathbf{x})$ 是 Hessian 矩阵: $$ H_{ij} = \\frac{\\partial^2 f}{\\partial x_i \\partial x_j} $$\n牛顿方向: $$ \\Delta \\mathbf{x} = -H^{-1} \\nabla f $$\n优点:\n二阶收敛(接近最优点时) 不受条件数影响 缺点:\n计算 Hessian: $O(d^2)$ 求解线性系统: $O(d^3)$ Hessian 可能不正定 拟牛顿法(BFGS, L-BFGS):用一阶信息近似 Hessian。\n3.3 二阶优化方法 对角 Hessian 近似(Adagrad, RMSprop): $$ G_{ii} = \\sum_t \\left(\\frac{\\partial L}{\\partial x_i}\\right)^2 $$\n$$ x_i \\leftarrow x_i - \\frac{\\eta}{\\sqrt{G_{ii} + \\epsilon}} \\frac{\\partial L}{\\partial x_i} $$\n几何上,自适应学习率补偿不同方向的曲率差异。\nAdam:结合动量 + RMSprop: $$ \\mathbf{m} = \\beta_1 \\mathbf{m} + (1-\\beta_1) \\mathbf{g} $$\n$$ \\mathbf{v} = \\beta_2 \\mathbf{v} + (1-\\beta_2) \\mathbf{g}^2 $$\n$$ \\mathbf{x} \\leftarrow \\mathbf{x} - \\frac{\\eta}{\\sqrt{\\hat{\\mathbf{v}}} + \\epsilon} \\hat{\\mathbf{m}} $$\n其中 $\\hat{\\mathbf{m}}, \\hat{\\mathbf{v}}$ 是偏差修正后的估计。\n自然梯度: $$ \\Delta \\mathbf{x} = -\\eta F^{-1} \\nabla f $$\n其中 $F$ 是 Fisher 信息矩阵。预条件使得梯度下降对参数重新参数化不变。\n结语:线性代数的生命力 回顾这段旅程,我们从向量空间的直观定义出发,经历了线性变换的几何之美,正交投影的代数之巧,奇异值分解的万能之用,最终抵达了深度学习的矩阵运算之实。线性代数之所以成为现代数学和人工智能的基石,正是因为它在抽象与具体之间找到了完美的平衡。\n一方面,线性代数的抽象结构——向量空间、线性变换、内积空间——捕捉了\"线性\"这个数学关系的本质,使得同一种理论可以应用于几何、代数、分析、物理等不同领域。另一方面,线性代数又是极其具体的:矩阵的数值计算、梯度下降的迭代优化、注意力的加权求和,每一项操作都可以在计算机上高效实现,每一步推导都有明确的几何解释。\n更重要的是,线性代数的生命力在于它的可扩展性。从二维平面到千万维的词嵌入空间,从简单的最小二乘到复杂的 Transformer,线性代数的规律始终不变。这使得我们可以在理解基本原理的基础上,驾驭复杂系统。\n在未来,随着量子计算、神经符号 AI、因果推断等新领域的发展,线性代数将继续扮演关键角色。理解线性代数,不仅是掌握一门数学工具,更是培养一种思维方式——将复杂问题分解为简单部分,将非线性世界线性化处理,将抽象概念转化为具体计算。\n正如伟大的数学家 Weyl 所说:“线性代数是所有数学中最重要的部分。“这句话在今天,比以往任何时候都更加真实。\n参考文献 Strang, G. (2016). Introduction to Linear Algebra (5th ed.). Wellesley-Cambridge Press. Golub, G. H., \u0026 Van Loan, C. F. (2013). Matrix Computations (4th ed.). Johns Hopkins University Press. Goodfellow, I., Bengio, Y., \u0026 Courville, A. (2016). Deep Learning. MIT Press. Bishop, C. M. (2006). Pattern Recognition and Machine Learning. Springer. Hastie, T., Tibshirani, R., \u0026 Friedman, J. (2009). The Elements of Statistical Learning (2nd ed.). Springer. Boyd, S., \u0026 Vandenberghe, L. (2018). Introduction to Applied Linear Algebra: Vectors, Matrices, and Least Squares. Cambridge University Press. Trefethen, L. N., \u0026 Bau, D. (1997). Numerical Linear Algebra. SIAM. Axler, S. (2015). Linear Algebra Done Right (3rd ed.). Springer. Parisi, G. (1988). Statistical Field Theory (Vol. 1). Perseus Publishing. Horn, R. A., \u0026 Johnson, C. R. (2012). Matrix Analysis (2nd ed.). Cambridge University Press. ","wordCount":"2816","inLanguage":"en","image":"https://s-ai-unix.github.io/images/covers/linear-algebra-journey.jpg","datePublished":"2026-01-25T08:45:00+08:00","dateModified":"2026-01-25T08:45:00+08:00","author":{"@type":"Person","name":"s-ai-unix"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s-ai-unix.github.io/posts/2026-01-25-linear-algebra-complete-guide/"},"publisher":{"@type":"Organization","name":"s-ai-unix's Blog","logo":{"@type":"ImageObject","url":"https://s-ai-unix.github.io/favicon.ico"}}}</script><link rel=stylesheet href=https://s-ai-unix.github.io/css/classical-quote.css></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://s-ai-unix.github.io/ accesskey=h title="s-ai-unix's Blog (Alt + H)">s-ai-unix's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://s-ai-unix.github.io/ title="🏠 首页"><span>🏠 首页</span></a></li><li><a href=https://s-ai-unix.github.io/posts/ title="📚 文章"><span>📚 文章</span></a></li><li><a href=https://s-ai-unix.github.io/archives/ title="📁 归档"><span>📁 归档</span></a></li><li><a href=https://s-ai-unix.github.io/tags/ title="🏷️ 标签"><span>🏷️ 标签</span></a></li><li><a href=https://s-ai-unix.github.io/search/ title="🔍 搜索 (Alt + /)" accesskey=/><span>🔍 搜索</span></a></li><li><a href=https://s-ai-unix.github.io/about/ title="👤 关于"><span>👤 关于</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://s-ai-unix.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://s-ai-unix.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">线性代数：从理论到 AI 应用的完整旅程</h1><div class=post-description>这是一篇关于线性代数的系统综述，从向量空间的几何直观到深度学习的矩阵运算，全面阐述线性代数在现代人工智能中的核心作用。</div><div class=post-meta><span title='2026-01-25 08:45:00 +0800 CST'>January 25, 2026</span>&nbsp;·&nbsp;<span>14 min</span>&nbsp;·&nbsp;<span>2816 words</span>&nbsp;·&nbsp;<span>s-ai-unix</span></div></header><figure class=entry-cover><a href=https://s-ai-unix.github.io/images/covers/linear-algebra-journey.jpg target=_blank rel="noopener noreferrer"><img loading=eager src=https://s-ai-unix.github.io/images/covers/linear-algebra-journey.jpg alt=线性代数的几何美感></a><figcaption>线性代数：描述空间的数学语言</figcaption></figure><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e5%bc%95%e8%a8%80%e4%b8%ba%e4%bb%80%e4%b9%88%e7%ba%bf%e6%80%a7%e4%bb%a3%e6%95%b0%e5%a6%82%e6%ad%a4%e9%87%8d%e8%a6%81 aria-label=引言：为什么线性代数如此重要？>引言：为什么线性代数如此重要？</a></li><li><a href=#%e7%ac%ac%e4%b8%80%e9%83%a8%e5%88%86%e7%ba%bf%e6%80%a7%e4%bb%a3%e6%95%b0%e5%9f%ba%e7%a1%80%e7%90%86%e8%ae%ba aria-label=第一部分:线性代数基础理论>第一部分:线性代数基础理论</a><ul><li><a href=#1-%e5%90%91%e9%87%8f%e7%a9%ba%e9%97%b4%e7%9a%84%e6%9c%ac%e8%b4%a8 aria-label="1. 向量空间的本质">1. 向量空间的本质</a><ul><li><a href=#11-%e4%bb%8e%e5%87%a0%e4%bd%95%e5%88%b0%e6%8a%bd%e8%b1%a1 aria-label="1.1 从几何到抽象">1.1 从几何到抽象</a></li><li><a href=#12-%e7%ba%bf%e6%80%a7%e7%9b%b8%e5%85%b3%e4%b8%8e%e7%ba%bf%e6%80%a7%e6%97%a0%e5%85%b3 aria-label="1.2 线性相关与线性无关">1.2 线性相关与线性无关</a></li><li><a href=#13-%e5%9f%ba%e4%b8%8e%e7%bb%b4%e6%95%b0 aria-label="1.3 基与维数">1.3 基与维数</a></li></ul></li><li><a href=#2-%e7%ba%bf%e6%80%a7%e5%8f%98%e6%8d%a2%e7%9a%84%e5%87%a0%e4%bd%95%e6%84%8f%e4%b9%89 aria-label="2. 线性变换的几何意义">2. 线性变换的几何意义</a><ul><li><a href=#21-%e7%9f%a9%e9%98%b5%e5%8d%b3%e5%8f%98%e6%8d%a2 aria-label="2.1 矩阵即变换">2.1 矩阵即变换</a></li><li><a href=#22-%e7%89%b9%e5%be%81%e5%80%bc%e4%b8%8e%e7%89%b9%e5%be%81%e5%90%91%e9%87%8f aria-label="2.2 特征值与特征向量">2.2 特征值与特征向量</a></li><li><a href=#23-%e5%af%b9%e8%a7%92%e5%8c%96%e4%b8%8e%e7%9b%b8%e4%bc%bc%e5%8f%98%e6%8d%a2 aria-label="2.3 对角化与相似变换">2.3 对角化与相似变换</a></li></ul></li><li><a href=#3-%e5%86%85%e7%a7%af%e7%a9%ba%e9%97%b4%e4%b8%8e%e6%ad%a3%e4%ba%a4%e6%80%a7 aria-label="3. 内积空间与正交性">3. 内积空间与正交性</a><ul><li><a href=#31-%e5%86%85%e7%a7%af%e7%9a%84%e5%8f%8c%e9%87%8d%e6%80%a7 aria-label="3.1 内积的双重性">3.1 内积的双重性</a></li><li><a href=#32-%e6%ad%a3%e4%ba%a4%e6%8a%95%e5%bd%b1%e4%b8%8e%e6%9c%80%e5%b0%8f%e4%ba%8c%e4%b9%98%e6%b3%95 aria-label="3.2 正交投影与最小二乘法">3.2 正交投影与最小二乘法</a></li><li><a href=#33-gram-schmidt-%e6%ad%a3%e4%ba%a4%e5%8c%96 aria-label="3.3 Gram-Schmidt 正交化">3.3 Gram-Schmidt 正交化</a></li></ul></li><li><a href=#4-%e5%a5%87%e5%bc%82%e5%80%bc%e5%88%86%e8%a7%a3svd aria-label="4. 奇异值分解(SVD)">4. 奇异值分解(SVD)</a><ul><li><a href=#41-svd-%e7%9a%84%e5%87%a0%e4%bd%95%e7%9b%b4%e8%a7%82 aria-label="4.1 SVD 的几何直观">4.1 SVD 的几何直观</a></li><li><a href=#42-%e4%b8%ba%e4%bb%80%e4%b9%88-svd-%e6%98%af%e7%91%9e%e5%a3%ab%e5%86%9b%e5%88%80 aria-label='4.2 为什么 SVD 是"瑞士军刀"?'>4.2 为什么 SVD 是"瑞士军刀"?</a></li><li><a href=#43-svd-%e7%9a%84%e8%ae%a1%e7%ae%97%e6%8e%a8%e5%af%bc aria-label="4.3 SVD 的计算推导">4.3 SVD 的计算推导</a></li></ul></li></ul></li><li><a href=#%e7%ac%ac%e4%ba%8c%e9%83%a8%e5%88%86%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%e4%b8%ad%e7%9a%84%e7%ba%bf%e6%80%a7%e4%bb%a3%e6%95%b0 aria-label=第二部分:机器学习中的线性代数>第二部分:机器学习中的线性代数</a><ul><li><a href=#1-%e6%9c%80%e5%b0%8f%e4%ba%8c%e4%b9%98%e6%b3%95%e4%b8%8e%e5%9b%9e%e5%bd%92 aria-label="1. 最小二乘法与回归">1. 最小二乘法与回归</a><ul><li><a href=#11-%e9%97%ae%e9%a2%98%e8%ae%be%e5%ae%9a aria-label="1.1 问题设定">1.1 问题设定</a></li><li><a href=#12-%e6%ad%a3%e8%a7%84%e6%96%b9%e7%a8%8b%e6%8e%a8%e5%af%bc aria-label="1.2 正规方程推导">1.2 正规方程推导</a></li><li><a href=#13-%e5%b2%ad%e5%9b%9e%e5%bd%92%e4%b8%8e%e5%87%a0%e4%bd%95%e6%84%8f%e4%b9%89 aria-label="1.3 岭回归与几何意义">1.3 岭回归与几何意义</a></li></ul></li><li><a href=#2-%e4%b8%bb%e6%88%90%e5%88%86%e5%88%86%e6%9e%90pca aria-label="2. 主成分分析(PCA)">2. 主成分分析(PCA)</a><ul><li><a href=#21-%e6%96%b9%e5%b7%ae%e6%9c%80%e5%a4%a7%e5%8c%96%e8%a7%86%e8%a7%92 aria-label="2.1 方差最大化视角">2.1 方差最大化视角</a></li><li><a href=#22-svd-%e8%a7%86%e8%a7%92%e4%b8%8b%e7%9a%84-pca aria-label="2.2 SVD 视角下的 PCA">2.2 SVD 视角下的 PCA</a></li><li><a href=#23-%e6%95%b0%e6%8d%ae%e5%8e%bb%e7%9b%b8%e5%85%b3 aria-label="2.3 数据去相关">2.3 数据去相关</a></li></ul></li><li><a href=#3-%e7%89%b9%e5%be%81%e5%80%bc%e9%97%ae%e9%a2%98%e7%9a%84%e5%ba%94%e7%94%a8 aria-label="3. 特征值问题的应用">3. 特征值问题的应用</a><ul><li><a href=#31-pagerank-%e7%ae%97%e6%b3%95 aria-label="3.1 PageRank 算法">3.1 PageRank 算法</a></li><li><a href=#32-%e8%b0%b1%e8%81%9a%e7%b1%bb aria-label="3.2 谱聚类">3.2 谱聚类</a></li><li><a href=#33-%e5%9b%be%e7%a5%9e%e7%bb%8f%e7%bd%91%e7%bb%9c aria-label="3.3 图神经网络">3.3 图神经网络</a></li></ul></li></ul></li><li><a href=#%e7%ac%ac%e4%b8%89%e9%83%a8%e5%88%86%e6%b7%b1%e5%ba%a6%e5%ad%a6%e4%b9%a0%e4%b8%ad%e7%9a%84%e7%ba%bf%e6%80%a7%e4%bb%a3%e6%95%b0 aria-label=第三部分:深度学习中的线性代数>第三部分:深度学习中的线性代数</a><ul><li><a href=#1-%e5%89%8d%e5%90%91%e4%bc%a0%e6%92%ad%e7%9a%84%e7%ba%bf%e6%80%a7%e4%bb%a3%e6%95%b0 aria-label="1. 前向传播的线性代数">1. 前向传播的线性代数</a><ul><li><a href=#11-%e7%9f%a9%e9%98%b5%e4%b9%98%e6%b3%95%e7%9a%84%e8%ae%a1%e7%ae%97%e6%95%88%e7%8e%87 aria-label="1.1 矩阵乘法的计算效率">1.1 矩阵乘法的计算效率</a></li><li><a href=#12-%e6%89%b9%e9%87%8f%e5%a4%84%e7%90%86%e7%9a%84%e5%90%91%e9%87%8f%e5%8c%96 aria-label="1.2 批量处理的向量化">1.2 批量处理的向量化</a></li><li><a href=#13-%e5%b9%bf%e6%92%ad%e6%9c%ba%e5%88%b6%e7%9a%84%e6%95%b0%e5%ad%a6%e6%9c%ac%e8%b4%a8 aria-label="1.3 广播机制的数学本质">1.3 广播机制的数学本质</a></li></ul></li><li><a href=#2-%e5%8f%8d%e5%90%91%e4%bc%a0%e6%92%ad%e4%b8%8e%e6%a2%af%e5%ba%a6%e8%ae%a1%e7%ae%97 aria-label="2. 反向传播与梯度计算">2. 反向传播与梯度计算</a><ul><li><a href=#21-%e9%93%be%e5%bc%8f%e6%b3%95%e5%88%99%e7%9a%84%e7%9f%a9%e9%98%b5%e5%bd%a2%e5%bc%8f aria-label="2.1 链式法则的矩阵形式">2.1 链式法则的矩阵形式</a></li><li><a href=#22-jacobian-%e7%9f%a9%e9%98%b5%e7%9a%84%e8%ae%a1%e7%ae%97 aria-label="2.2 Jacobian 矩阵的计算">2.2 Jacobian 矩阵的计算</a></li><li><a href=#23-%e6%a2%af%e5%ba%a6%e6%b6%88%e5%a4%b1%e7%88%86%e7%82%b8%e7%9a%84%e7%ba%bf%e6%80%a7%e4%bb%a3%e6%95%b0%e8%a7%86%e8%a7%92 aria-label="2.3 梯度消失/爆炸的线性代数视角">2.3 梯度消失/爆炸的线性代数视角</a></li></ul></li><li><a href=#3-%e6%ad%a3%e5%88%99%e5%8c%96%e7%9a%84%e5%87%a0%e4%bd%95%e6%84%8f%e4%b9%89 aria-label="3. 正则化的几何意义">3. 正则化的几何意义</a><ul><li><a href=#31-l2-%e6%ad%a3%e5%88%99%e4%b8%8e%e6%ac%a7%e6%b0%8f%e7%a9%ba%e9%97%b4%e6%8a%95%e5%bd%b1 aria-label="3.1 L2 正则与欧氏空间投影">3.1 L2 正则与欧氏空间投影</a></li><li><a href=#32-l1-%e6%ad%a3%e5%88%99%e4%b8%8e%e7%a8%80%e7%96%8f%e6%80%a7 aria-label="3.2 L1 正则与稀疏性">3.2 L1 正则与稀疏性</a></li><li><a href=#33-dropout-%e7%9a%84%e7%ba%bf%e6%80%a7%e4%bb%a3%e6%95%b0%e8%a7%a3%e9%87%8a aria-label="3.3 Dropout 的线性代数解释">3.3 Dropout 的线性代数解释</a></li></ul></li><li><a href=#4-%e6%b3%a8%e6%84%8f%e5%8a%9b%e6%9c%ba%e5%88%b6 aria-label="4. 注意力机制">4. 注意力机制</a><ul><li><a href=#41-%e6%b3%a8%e6%84%8f%e5%8a%9b%e7%9a%84%e7%9f%a9%e9%98%b5%e8%bf%90%e7%ae%97 aria-label="4.1 注意力的矩阵运算">4.1 注意力的矩阵运算</a></li><li><a href=#42-query-key-value-%e7%9a%84%e7%ba%bf%e6%80%a7%e4%bb%a3%e6%95%b0 aria-label="4.2 Query-Key-Value 的线性代数">4.2 Query-Key-Value 的线性代数</a></li><li><a href=#43-%e8%87%aa%e6%b3%a8%e6%84%8f%e5%8a%9b%e4%b8%ad%e7%9a%84%e7%9f%a9%e9%98%b5%e5%88%86%e8%a7%a3 aria-label="4.3 自注意力中的矩阵分解">4.3 自注意力中的矩阵分解</a></li></ul></li></ul></li><li><a href=#%e7%ac%ac%e5%9b%9b%e9%83%a8%e5%88%86%e9%ab%98%e7%ba%a7%e4%b8%bb%e9%a2%98 aria-label=第四部分:高级主题>第四部分:高级主题</a><ul><li><a href=#1-%e5%bc%a0%e9%87%8f%e5%88%86%e8%a7%a3 aria-label="1. 张量分解">1. 张量分解</a><ul><li><a href=#11-%e5%bc%a0%e9%87%8f%e7%9a%84%e5%ae%9a%e4%b9%89 aria-label="1.1 张量的定义">1.1 张量的定义</a></li><li><a href=#12-cp-%e5%88%86%e8%a7%a3 aria-label="1.2 CP 分解">1.2 CP 分解</a></li><li><a href=#13-%e5%bc%a0%e9%87%8f%e7%bd%91%e7%bb%9c aria-label="1.3 张量网络">1.3 张量网络</a></li></ul></li><li><a href=#2-%e6%b5%81%e5%bd%a2%e5%ad%a6%e4%b9%a0 aria-label="2. 流形学习">2. 流形学习</a><ul><li><a href=#21-%e4%bb%8e%e6%ac%a7%e6%b0%8f%e7%a9%ba%e9%97%b4%e5%88%b0%e9%bb%8e%e6%9b%bc%e6%b5%81%e5%bd%a2 aria-label="2.1 从欧氏空间到黎曼流形">2.1 从欧氏空间到黎曼流形</a></li><li><a href=#22-%e6%b5%8b%e5%9c%b0%e7%ba%bf%e8%b7%9d%e7%a6%bb aria-label="2.2 测地线距离">2.2 测地线距离</a></li><li><a href=#23-%e5%b1%80%e9%83%a8%e7%ba%bf%e6%80%a7%e5%b5%8c%e5%85%a5lle aria-label="2.3 局部线性嵌入(LLE)">2.3 局部线性嵌入(LLE)</a></li></ul></li><li><a href=#3-%e4%bc%98%e5%8c%96%e7%ae%97%e6%b3%95%e7%9a%84%e7%ba%bf%e6%80%a7%e4%bb%a3%e6%95%b0 aria-label="3. 优化算法的线性代数">3. 优化算法的线性代数</a><ul><li><a href=#31-%e6%a2%af%e5%ba%a6%e4%b8%8b%e9%99%8d%e7%9a%84%e6%94%b6%e6%95%9b%e6%80%a7 aria-label="3.1 梯度下降的收敛性">3.1 梯度下降的收敛性</a></li><li><a href=#32-%e7%89%9b%e9%a1%bf%e6%b3%95%e4%b8%8e-hessian-%e7%9f%a9%e9%98%b5 aria-label="3.2 牛顿法与 Hessian 矩阵">3.2 牛顿法与 Hessian 矩阵</a></li><li><a href=#33-%e4%ba%8c%e9%98%b6%e4%bc%98%e5%8c%96%e6%96%b9%e6%b3%95 aria-label="3.3 二阶优化方法">3.3 二阶优化方法</a></li></ul></li></ul></li><li><a href=#%e7%bb%93%e8%af%ad%e7%ba%bf%e6%80%a7%e4%bb%a3%e6%95%b0%e7%9a%84%e7%94%9f%e5%91%bd%e5%8a%9b aria-label=结语:线性代数的生命力>结语:线性代数的生命力</a></li><li><a href=#%e5%8f%82%e8%80%83%e6%96%87%e7%8c%ae aria-label=参考文献>参考文献</a></li></ul></div></details></div><div class=post-content><h2 id=引言为什么线性代数如此重要>引言：为什么线性代数如此重要？<a hidden class=anchor aria-hidden=true href=#引言为什么线性代数如此重要>#</a></h2><p>想象你站在一个开阔的平原上,手中拿着一支箭。这支箭可以指向任何方向,可以伸长或缩短,可以与另一支箭相加。这就是向量的原始概念——一个既有方向又有大小的量。从这样简单的直观出发,人类发展出了一整套描述空间、变换和数据结构的数学语言:线性代数。</p><p>线性代数的美妙之处在于它的<strong>简洁性</strong>和<strong>普遍性</strong>。在二维平面上,一个点可以用两个坐标 $(x, y)$ 表示;在三维空间中,需要三个坐标 $(x, y, z)$;而在机器学习中处理的数据可能有一千维、一万维,甚至更高。线性代数提供了一套统一的工具来处理这些高维空间,而且它的规律在任意维数下都保持不变。</p><p>更令人惊讶的是,当你使用 ChatGPT、看 Netflix 推荐、或在 Google 搜索时,背后都有线性代数的身影。深度学习的神经网络本质上就是一系列线性变换和非线性激活的交替组合;推荐系统中的矩阵分解技术直接源自奇异值分解;而搜索引擎的 PageRank 算法则是特征值问题的经典应用。</p><p>在这篇文章中,我们将踏上一段从理论到应用的完整旅程。我们会从向量空间的几何直观出发,理解线性变换的本质,然后逐步深入到机器学习和深度学习的核心算法中。我们不仅会学习"怎么做",更重要的是理解"为什么"——为什么奇异值分解如此强大?为什么梯度下降会收敛?为什么注意力机制能够工作?</p><p>让我们开始这段旅程。</p><h2 id=第一部分线性代数基础理论>第一部分:线性代数基础理论<a hidden class=anchor aria-hidden=true href=#第一部分线性代数基础理论>#</a></h2><h3 id=1-向量空间的本质>1. 向量空间的本质<a hidden class=anchor aria-hidden=true href=#1-向量空间的本质>#</a></h3><h4 id=11-从几何到抽象>1.1 从几何到抽象<a hidden class=anchor aria-hidden=true href=#11-从几何到抽象>#</a></h4><p>在二维平面上,我们习惯用坐标表示向量。向量 $\mathbf{v} = (3, 2)$ 表示从原点出发,沿 $x$ 轴移动 3 个单位,再沿 $y$ 轴移动 2 个单位。但向量的概念远不止于此。</p><p><strong>向量空间</strong>的抽象定义只需要 8 条公理:</p><ol><li>加法封闭性: $\mathbf{u} + \mathbf{v}$ 仍在空间中</li><li>加法交换律: $\mathbf{u} + \mathbf{v} = \mathbf{v} + \mathbf{u}$</li><li>加法结合律: $(\mathbf{u} + \mathbf{v}) + \mathbf{w} = \mathbf{u} + (\mathbf{v} + \mathbf{w})$</li><li>零向量存在: $\mathbf{0} + \mathbf{v} = \mathbf{v}$</li><li>负向量存在: $\mathbf{v} + (-\mathbf{v}) = \mathbf{0}$</li><li>数乘封闭性: $c\mathbf{v}$ 仍在空间中</li><li>数乘分配律: $c(\mathbf{u} + \mathbf{v}) = c\mathbf{u} + c\mathbf{v}$</li><li>数乘结合律: $c(d\mathbf{v}) = (cd)\mathbf{v}$</li></ol><p>这个定义看似抽象,但它统一了各种不同的对象:</p><ul><li>$\mathbb{R}^n$ 中的几何向量</li><li>多项式 $P_n = {a_0 + a_1x + \cdots + a_nx^n}$</li><li>$m \times n$ 矩阵的集合 $\mathbb{R}^{m \times n}$</li><li>函数空间 $L^2([a, b])$</li></ul><h4 id=12-线性相关与线性无关>1.2 线性相关与线性无关<a hidden class=anchor aria-hidden=true href=#12-线性相关与线性无关>#</a></h4><p><strong>核心思想</strong>:一组向量是线性相关的,如果其中一个向量可以表示为其他向量的线性组合。</p><p>考虑二维平面上的两个向量:
$$
\mathbf{v}_1 = \begin{pmatrix} 1 \ 0 \end{pmatrix}, \quad \mathbf{v}_2 = \begin{pmatrix} 2 \ 0 \end{pmatrix}
$$</p><p>显然 $\mathbf{v}_2 = 2\mathbf{v}_1$,所以它们线性相关。几何上,它们指向同一个方向,无法"张成"整个二维平面。</p><p>而如果选择:
$$
\mathbf{e}_1 = \begin{pmatrix} 1 \ 0 \end{pmatrix}, \quad \mathbf{e}_2 = \begin{pmatrix} 0 \ 1 \end{pmatrix}
$$</p><p>那么不存在 $c_1, c_2$ 使得 $c_1\mathbf{e}_1 + c_2\mathbf{e}_2 = \mathbf{0}$,除非 $c_1 = c_2 = 0$。这就是线性无关。</p><p><strong>线性无关的几何意义</strong>:每个向量都贡献了一个"独立的方向",无法用其他向量替代。</p><h4 id=13-基与维数>1.3 基与维数<a hidden class=anchor aria-hidden=true href=#13-基与维数>#</a></h4><p><strong>基</strong>是向量空间中最小的一组线性无关生成元。对于 $\mathbb{R}^3$,标准基是:
$$
\mathbf{e}_1 = \begin{pmatrix} 1 \ 0 \ 0 \end{pmatrix}, \quad \mathbf{e}_2 = \begin{pmatrix} 0 \ 1 \ 0 \end{pmatrix}, \quad \mathbf{e}_3 = \begin{pmatrix} 0 \ 0 \ 1 \end{pmatrix}
$$</p><p>任意向量 $\mathbf{v} = (v_1, v_2, v_3)^\top$ 都可以唯一表示为:
$$
\mathbf{v} = v_1\mathbf{e}_1 + v_2\mathbf{e}_2 + v_3\mathbf{e}_3
$$</p><p><strong>维数</strong>就是基中向量的个数。这是一个<strong>内蕴性质</strong>,不依赖于坐标系的选择。无论你用直角坐标、极坐标还是斜坐标,三维空间永远是三维的。</p><hr><h3 id=2-线性变换的几何意义>2. 线性变换的几何意义<a hidden class=anchor aria-hidden=true href=#2-线性变换的几何意义>#</a></h3><h4 id=21-矩阵即变换>2.1 矩阵即变换<a hidden class=anchor aria-hidden=true href=#21-矩阵即变换>#</a></h4><p>理解线性变换的关键是:<strong>矩阵不仅仅是数字的阵列,它是对空间的一种操作</strong>。</p><p>考虑 $2 \times 2$ 矩阵:
$$
A = \begin{pmatrix} 2 & 0 \ 0 & 1 \end{pmatrix}
$$</p><p>当它作用于向量 $\mathbf{x} = (x, y)^\top$ 时:
$$
A\mathbf{x} = \begin{pmatrix} 2 & 0 \ 0 & 1 \end{pmatrix} \begin{pmatrix} x \ y \end{pmatrix} = \begin{pmatrix} 2x \ y \end{pmatrix}
$$</p><p>这个变换将 $x$ 方向拉伸 2 倍,而 $y$ 方向保持不变。这就是<strong>拉伸变换</strong>。</p><p>再来看旋转矩阵:
$$
R_\theta = \begin{pmatrix} \cos\theta & -\sin\theta \ \sin\theta & \cos\theta \end{pmatrix}
$$</p><p>当 $\theta = 90^\circ$ 时:
$$
R_{90^\circ} = \begin{pmatrix} 0 & -1 \ 1 & 0 \end{pmatrix}
$$</p><p>它将 $(1, 0)^\top$ 变为 $(0, 1)^\top$,将 $(0, 1)^\top$ 变为 $(-1, 0)^\top$,实现了逆时针旋转 90 度。</p><p><strong>关键洞察</strong>:矩阵的列向量就是基向量变换后的位置。对于 $A = [\mathbf{a}_1, \mathbf{a}_2]$,$\mathbf{a}_1$ 就是 $\mathbf{e}_1$ 变换后的位置, $\mathbf{a}_2$ 是 $\mathbf{e}_2$ 变换后的位置。</p><p><img alt=线性变换的几何效果 loading=lazy src=/images/math/linear-transformation.png></p><p><em>图1：矩阵作为线性变换，展示了基向量的变换效果。蓝色和绿色是原始基向量，紫色和深蓝色是变换后的基向量。</em></p><h4 id=22-特征值与特征向量>2.2 特征值与特征向量<a hidden class=anchor aria-hidden=true href=#22-特征值与特征向量>#</a></h4><p><strong>核心问题</strong>:对于一个线性变换 $A$,是否存在某些方向,使得变换后只改变长度,不改变方向?</p><p>数学上,我们寻找满足:
$$
A\mathbf{v} = \lambda\mathbf{v}
$$</p><p>的非零向量 $\mathbf{v}$ 和标量 $\lambda$。这样的 $\mathbf{v}$ 称为<strong>特征向量</strong>,$\lambda$ 称为<strong>特征值</strong>。</p><p><strong>物理意义</strong>:</p><ul><li>$|\lambda| > 1$: 沿该方向拉伸</li><li>$|\lambda| &lt; 1$: 沿该方向压缩</li><li>$\lambda &lt; 0$: 沿该方向翻转</li><li>$\lambda = 0$: 将该方向压扁为零</li></ul><p><strong>计算方法</strong>:特征方程
$$
\det(A - \lambda I) = 0
$$</p><p>对于 $2 \times 2$ 矩阵:
$$
A = \begin{pmatrix} a & b \ c & d \end{pmatrix}
$$</p><p>特征方程为:
$$
\begin{vmatrix} a-\lambda & b \ c & d-\lambda \end{vmatrix} = (a-\lambda)(d-\lambda) - bc = 0
$$</p><p>展开得到:
$$
\lambda^2 - (a+d)\lambda + (ad-bc) = 0
$$</p><p>其中 $a+d = \operatorname{tr}(A)$ 是迹,$ad-bc = \det(A)$ 是行列式。</p><p><img alt=特征向量的方向保持特性 loading=lazy src=/images/math/eigenvalues-vectors.png></p><p><em>图2：特征向量是保持方向不变的变换方向。图中展示了变换前后的网格点以及特征向量（蓝色和橙色箭头）。</em></p><p><strong>几何应用</strong>:如果一个 $3 \times 3$ 矩阵有三个线性无关的特征向量,那么我们可以沿这些特征向量的方向理解变换。例如,应力张量的特征向量表示主应力方向。</p><h4 id=23-对角化与相似变换>2.3 对角化与相似变换<a hidden class=anchor aria-hidden=true href=#23-对角化与相似变换>#</a></h4><p><strong>对角化</strong>是将矩阵分解为:
$$
A = P \Lambda P^{-1}
$$</p><p>其中 $\Lambda$ 是对角矩阵(对角线上是特征值),$P$ 的列向量是对应的特征向量。</p><p><strong>为什么对角化有用?</strong></p><ol><li><p><strong>计算矩阵幂</strong>:
$$
A^k = P \Lambda^k P^{-1} = P \begin{pmatrix} \lambda_1^k & & \ & \ddots & \ & & \lambda_n^k \end{pmatrix} P^{-1}
$$</p><p>这在计算 Markov 链的长期行为时至关重要。</p></li><li><p><strong>解微分方程</strong>:
对于 $\frac{d\mathbf{x}}{dt} = A\mathbf{x}$,令 $\mathbf{x} = P\mathbf{y}$,则:
$$
\frac{d\mathbf{y}}{dt} = \Lambda \mathbf{y} \implies y_i(t) = y_i(0) e^{\lambda_i t}
$$</p></li><li><p><strong>理解系统演化</strong>:
特征值决定稳定性:</p><ul><li>$\operatorname{Re}(\lambda_i) &lt; 0$: 衰减</li><li>$\operatorname{Re}(\lambda_i) > 0$: 增长(不稳定)</li></ul></li></ol><p><strong>相似变换</strong>的几何意义: $B = P^{-1}AP$ 表示在另一个坐标系下看同一个变换。如果 $P$ 由特征向量组成,那么在这个坐标系下,变换矩阵是对角的——每个方向独立演化。</p><hr><h3 id=3-内积空间与正交性>3. 内积空间与正交性<a hidden class=anchor aria-hidden=true href=#3-内积空间与正交性>#</a></h3><h4 id=31-内积的双重性>3.1 内积的双重性<a hidden class=anchor aria-hidden=true href=#31-内积的双重性>#</a></h4><p><strong>内积</strong> $\langle \mathbf{u}, \mathbf{v} \rangle$ 有两个等价定义:</p><ol><li><p><strong>代数定义</strong>(标准内积):
$$
\langle \mathbf{u}, \mathbf{v} \rangle = \mathbf{u}^T \mathbf{v} = \sum_{i=1}^n u_i v_i
$$</p></li><li><p><strong>几何定义</strong>:
$$
\langle \mathbf{u}, \mathbf{v} \rangle = |\mathbf{u}| |\mathbf{v}| \cos\theta
$$</p></li></ol><p>其中 $\theta$ 是两向量夹角。这个等式给出了<strong>余弦定理</strong>:
$$
\cos\theta = \frac{\langle \mathbf{u}, \mathbf{v} \rangle}{|\mathbf{u}| |\mathbf{v}|}
$$</p><p><strong>关键应用</strong>:</p><ul><li>$\cos\theta = 0 \iff \langle \mathbf{u}, \mathbf{v} \rangle = 0$: <strong>正交</strong></li><li>$\cos\theta = 1 \iff \mathbf{u} = c\mathbf{v}, c > 0$: <strong>同向</strong></li><li>$\cos\theta = -1 \iff \mathbf{u} = c\mathbf{v}, c &lt; 0$: <strong>反向</strong></li></ul><p>在自然语言处理中,词向量的夹角余弦用于衡量语义相似度。</p><h4 id=32-正交投影与最小二乘法>3.2 正交投影与最小二乘法<a hidden class=anchor aria-hidden=true href=#32-正交投影与最小二乘法>#</a></h4><p><strong>投影问题</strong>:给定向量 $\mathbf{b}$ 和子空间 $W$,找到 $\mathbf{b}$ 在 $W$ 上的投影 $\mathbf{p}$。</p><p><strong>几何直觉</strong>:</p><ol><li>$\mathbf{p} \in W$</li><li>误差 $\mathbf{e} = \mathbf{b} - \mathbf{p}$ 与 $W$ 正交</li></ol><p><strong>代数推导</strong>:</p><p>设 $W$ 由 $\mathbf{a}_1, \ldots, \mathbf{a}_n$ 张成,记 $A = [\mathbf{a}_1, \ldots, \mathbf{a}_n]$。投影为:
$$
\mathbf{p} = A\hat{\mathbf{x}}
$$</p><p>正交条件: $A^ op(\mathbf{b} - A\hat{\mathbf{x}}) = \mathbf{0}$,因此:
$$
A^ op A \hat{\mathbf{x}} = A^ op \mathbf{b}
$$</p><p>这就是<strong>正规方程</strong>(Normal Equation)。</p><p><strong>最小二乘法</strong>:当 $A\mathbf{x} = \mathbf{b}$ 无解时(超定方程组),我们寻找使 $|\mathbf{b} - A\mathbf{x}|^2$ 最小的 $\hat{\mathbf{x}}$。这个最小解恰好满足正规方程。</p><p><strong>投影矩阵</strong>:
$$
P = A(A^ op A)^{-1} A^ op
$$</p><p>它将任意向量投影到 $A$ 的列空间。性质:</p><ul><li>$P^2 = P$(幂等)</li><li>$P^T = P$(对称)</li></ul><h4 id=33-gram-schmidt-正交化>3.3 Gram-Schmidt 正交化<a hidden class=anchor aria-hidden=true href=#33-gram-schmidt-正交化>#</a></h4><p><strong>目标</strong>:从一组线性无关向量 ${\mathbf{v}_1, \ldots, \mathbf{v}_n}$ 构造标准正交基 ${\mathbf{q}_1, \ldots, \mathbf{q}_n}$。</p><p><strong>算法</strong>:</p><ol><li><p>$\mathbf{u}_1 = \mathbf{v}_1$, $\mathbf{q}_1 = \frac{\mathbf{u}_1}{|\mathbf{u}_1|}$</p></li><li><p>$\mathbf{u}_2 = \mathbf{v}_2 - \langle \mathbf{v}_2, \mathbf{q}_1 \rangle \mathbf{q}_1$, $\mathbf{q}_2 = \frac{\mathbf{u}_2}{|\mathbf{u}_2|}$</p></li><li><p>一般地:
$$
\mathbf{u}_k = \mathbf{v}<em>k - \sum</em>{i=1}^{k-1} \langle \mathbf{v}_k, \mathbf{q}_i \rangle \mathbf{q}_i
$$</p></li></ol><p><strong>几何解释</strong>:每次减去已构造方向的投影,确保新方向与之前所有方向正交。</p><p><strong>矩阵分解</strong>: $A = QR$,其中 $Q$ 是正交矩阵($Q^T Q = I$),$R$ 是上三角矩阵。这在数值计算中非常稳定。</p><hr><h3 id=4-奇异值分解svd>4. 奇异值分解(SVD)<a hidden class=anchor aria-hidden=true href=#4-奇异值分解svd>#</a></h3><h4 id=41-svd-的几何直观>4.1 SVD 的几何直观<a hidden class=anchor aria-hidden=true href=#41-svd-的几何直观>#</a></h4><p><strong>奇异值分解定理</strong>:任意 $m \times n$ 矩阵 $A$ 都可以分解为:
$$
A = U \Sigma V^ op
$$</p><p>其中:</p><ul><li>$U$ 是 $m \times m$ 正交矩阵($U^T U = I_m$)</li><li>$V$ 是 $n \times n$ 正交矩阵($V^ op V = I_n$)</li><li>$\Sigma$ 是 $m \times n$ 对角矩阵,对角线元素 $\sigma_1 \geq \sigma_2 \geq \cdots \geq \sigma_r > 0$ 是奇异值</li></ul><p><strong>几何意义</strong>:任何线性变换都可以分解为三个步骤:</p><ol><li>旋转/反射($V^ op$)</li><li>沿坐标轴拉伸/压缩($\Sigma$)</li><li>再旋转/反射($U$)</li></ol><p><img alt="SVD 分解的几何步骤" loading=lazy src=/images/math/svd-geometry.png></p><p><em>图3：奇异值分解的几何步骤：原始单位圆（绿色）→ 旋转（橙色）→ 拉伸成椭圆（蓝色）→ 再旋转（紫色）。</em></p><p><strong>与特征值分解的关系</strong>:</p><ul><li>对于方阵 $A$,奇异值是特征值的平方根: $\sigma_i = \sqrt{\lambda_i(A^ op A)}$</li><li>特征值分解要求矩阵可对角化,SVD 对任意矩阵都成立</li><li>SVD 给出两个正交基(输入和输出空间),而特征值分解只给一个</li></ul><h4 id=42-为什么-svd-是瑞士军刀>4.2 为什么 SVD 是"瑞士军刀"?<a hidden class=anchor aria-hidden=true href=#42-为什么-svd-是瑞士军刀>#</a></h4><p><strong>应用 1:低秩近似</strong></p><p>取前 $k$ 个奇异值:
$$
A_k = \sum_{i=1}^k \sigma_i \mathbf{u}_i \mathbf{v}_i^T
$$</p><p>这在 Frobenius 范数下是最优的 $k$ 秩近似。图像压缩、推荐系统都基于此。</p><p><strong>Eckart-Young 定理</strong>:
$$
|A - A_k|<em>F = \sqrt{\sum</em>{i=k+1}^r \sigma_i^2} = \min_{\operatorname{rank}(B)=k} |A - B|_F
$$</p><p><strong>应用 2:伪逆</strong></p><p>对于 $A$ 的 Moore-Penrose 伪逆:
$$
A^+ = V \Sigma^+ U^T
$$</p><p>其中 $\Sigma^+$ 将 $\Sigma$ 的非零对角元取倒数后转置。最小二乘解为:
$$
\hat{\mathbf{x}} = A^+ \mathbf{b}
$$</p><p><strong>应用 3:条件数</strong></p><p>$$
\kappa(A) = \frac{\sigma_{\max}}{\sigma_{\min}}
$$</p><p>条件数衡量矩阵对扰动的敏感度。$\kappa(A)$ 大说明病态问题,小误差会被放大。</p><h4 id=43-svd-的计算推导>4.3 SVD 的计算推导<a hidden class=anchor aria-hidden=true href=#43-svd-的计算推导>#</a></h4><p><strong>核心思想</strong>: $A^ op A$ 和 $AA^ op$ 是对称半正定矩阵,必可对角化。</p><p><strong>推导步骤</strong>:</p><ol><li><p>$A^ op A = (V \Sigma^T U^T)(U \Sigma V^ op) = V \Sigma^T \Sigma V^ op$</p><p>这说明 $V$ 的列向量是 $A^ op A$ 的特征向量。</p></li><li><p>$AA^ op = (U \Sigma V^ op)(V \Sigma^T U^T) = U \Sigma \Sigma^T U^T$</p><p>这说明 $U$ 的列向量是 $AA^ op$ 的特征向量。</p></li><li><p>$\Sigma^T \Sigma$ 和 $\Sigma \Sigma^T$ 的对角元都是 $\sigma_i^2$。</p></li></ol><p><strong>数值稳定性</strong>:实际计算时,先对 $A^ op A$ 做 QR 分解,避免显式构造 $A^ op A$ 以减少误差。</p><hr><h2 id=第二部分机器学习中的线性代数>第二部分:机器学习中的线性代数<a hidden class=anchor aria-hidden=true href=#第二部分机器学习中的线性代数>#</a></h2><h3 id=1-最小二乘法与回归>1. 最小二乘法与回归<a hidden class=anchor aria-hidden=true href=#1-最小二乘法与回归>#</a></h3><h4 id=11-问题设定>1.1 问题设定<a hidden class=anchor aria-hidden=true href=#11-问题设定>#</a></h4><p>给定 $n$ 个样本 $(\mathbf{x}_i, y_i)$,其中 $\mathbf{x}_i \in \mathbb{R}^d$, $y_i \in \mathbb{R}$。线性模型:
$$
y = \mathbf{w}^T \mathbf{x} + b
$$</p><p>令 $\tilde{\mathbf{x}} = (1, \mathbf{x}^\top)^\top$,$\tilde{\mathbf{w}} = (b, \mathbf{w}^\top)^\top$,则:
$$
y = \tilde{\mathbf{w}}^T \tilde{\mathbf{x}}
$$</p><p>写成矩阵形式:
$$
\mathbf{y} = X \mathbf{w}
$$</p><p>其中 $X \in \mathbb{R}^{n \times (d+1)}$ 是设计矩阵。</p><h4 id=12-正规方程推导>1.2 正规方程推导<a hidden class=anchor aria-hidden=true href=#12-正规方程推导>#</a></h4><p><strong>目标</strong>:最小化平方误差:
$$
J(\mathbf{w}) = |\mathbf{y} - X\mathbf{w}|^2 = (\mathbf{y} - X\mathbf{w})^\top(\mathbf{y} - X\mathbf{w})
$$</p><p>展开:
$$
J(\mathbf{w}) = \mathbf{y}^T\mathbf{y} - 2\mathbf{w}^T X^ op \mathbf{y} + \mathbf{w}^T X^ op X \mathbf{w}
$$</p><p>求导:
$$
\frac{\partial J}{\partial \mathbf{w}} = -2 X^ op \mathbf{y} + 2 X^ op X \mathbf{w}
$$</p><p>令导数为零:
$$
X^ op X \mathbf{w} = X^ op \mathbf{y}
$$</p><p>这就是<strong>正规方程</strong>,解为:
$$
\mathbf{w}^* = (X^ op X)^{-1} X^ op \mathbf{y}
$$</p><p><strong>几何解释</strong>: $X\mathbf{w}$ 是 $X$ 列空间中的向量,正规方程确保 $\mathbf{y} - X\mathbf{w}$ 与列空间正交。</p><h4 id=13-岭回归与几何意义>1.3 岭回归与几何意义<a hidden class=anchor aria-hidden=true href=#13-岭回归与几何意义>#</a></h4><p><strong>问题</strong>:当 $X^ op X$ 接近奇异时,解不稳定。岭回归加入 $L_2$ 正则:
$$
J(\mathbf{w}) = |\mathbf{y} - X\mathbf{w}|^2 + \lambda |\mathbf{w}|^2
$$</p><p>推导得到:
$$
\mathbf{w}^* = (X^ op X + \lambda I)^{-1} X^ op \mathbf{y}
$$</p><p><strong>几何意义</strong>: $\lambda I$ 确保矩阵正定,等价于:</p><ul><li>限制解的范数</li><li>从贝叶斯角度,等价于高斯先验</li></ul><p><strong>核回归</strong>:通过特征映射 $\phi(\mathbf{x})$,将线性模型扩展到非线性:
$$
y = \mathbf{w}^T \phi(\mathbf{x})
$$</p><p>使用核技巧,只需计算 $K(\mathbf{x}_i, \mathbf{x}_j) = \langle \phi(\mathbf{x}_i), \phi(\mathbf{x}_j) \rangle$。</p><hr><h3 id=2-主成分分析pca>2. 主成分分析(PCA)<a hidden class=anchor aria-hidden=true href=#2-主成分分析pca>#</a></h3><h4 id=21-方差最大化视角>2.1 方差最大化视角<a hidden class=anchor aria-hidden=true href=#21-方差最大化视角>#</a></h4><p><strong>目标</strong>:找到投影方向 $\mathbf{u}$($|\mathbf{u}| = 1$),使投影后方差最大。</p><p>给定中心化数据 $X \in \mathbb{R}^{n \times d}$,投影为:
$$
\mathbf{z} = X \mathbf{u}
$$</p><p>方差为:
$$
\operatorname{Var}(\mathbf{z}) = \frac{1}{n} \mathbf{u}^T X^ op X \mathbf{u} = \mathbf{u}^T \Sigma \mathbf{u}
$$</p><p>其中 $\Sigma = \frac{1}{n} X^ op X$ 是协方差矩阵。</p><p><strong>优化问题</strong>:
$$
\max_{\mathbf{u}} \mathbf{u}^T \Sigma \mathbf{u} \quad \text{s.t.} \quad |\mathbf{u}| = 1
$$</p><p>使用拉格朗日乘子:
$$
\mathcal{L}(\mathbf{u}, \lambda) = \mathbf{u}^T \Sigma \mathbf{u} - \lambda(\mathbf{u}^T \mathbf{u} - 1)
$$</p><p>求导:
$$
2 \Sigma \mathbf{u} - 2 \lambda \mathbf{u} = 0 \implies \Sigma \mathbf{u} = \lambda \mathbf{u}
$$</p><p>这说明 $\mathbf{u}$ 是 $\Sigma$ 的特征向量,$\lambda$ 是特征值。目标函数值为:
$$
\mathbf{u}^T \Sigma \mathbf{u} = \mathbf{u}^T \lambda \mathbf{u} = \lambda |\mathbf{u}|^2 = \lambda
$$</p><p><strong>结论</strong>:第一主方向是最大特征值对应的特征向量,方差为该特征值。</p><h4 id=22-svd-视角下的-pca>2.2 SVD 视角下的 PCA<a hidden class=anchor aria-hidden=true href=#22-svd-视角下的-pca>#</a></h4><p>对数据中心化后做 SVD:
$$
X = U \Sigma V^ op
$$</p><p>主成分方向是 $V$ 的列向量,主成分得分是 $U \Sigma$。</p><p><strong>优势</strong>:</p><ul><li>避免显式计算协方差矩阵(数值更稳定)</li><li>同时得到方向、得分、方差</li></ul><p><img alt="PCA 降维演示" loading=lazy src=/images/math/pca-dimensionality-reduction.png></p><p><em>图4：主成分分析找到方差最大的投影方向。灰色点是原始数据，蓝色箭头是第一主成分（方差最大），橙色箭头是第二主成分，绿色点是投影到第一主成分的结果。</em></p><p><strong>降维</strong>:保留前 $k$ 个主成分:
$$
X \approx U_k \Sigma_k V_k^T
$$</p><p>低维表示: $Z = X V_k = U_k \Sigma_k$</p><h4 id=23-数据去相关>2.3 数据去相关<a hidden class=anchor aria-hidden=true href=#23-数据去相关>#</a></h4><p>原始数据的协方差矩阵 $\Sigma$ 一般不是对角的。PCA 后:
$$
\operatorname{Cov}(Z) = \operatorname{Cov}(X V) = V^ op \operatorname{Cov}(X) V = V^ op \Sigma V = \Lambda
$$</p><p>其中 $\Lambda$ 是对角矩阵,说明主成分之间不相关。</p><p><strong>应用</strong>:</p><ul><li>降维可视化(t-SNE 的预处理)</li><li>去噪(保留大方差成分)</li><li>特征提取(图像识别)</li></ul><hr><h3 id=3-特征值问题的应用>3. 特征值问题的应用<a hidden class=anchor aria-hidden=true href=#3-特征值问题的应用>#</a></h3><h4 id=31-pagerank-算法>3.1 PageRank 算法<a hidden class=anchor aria-hidden=true href=#31-pagerank-算法>#</a></h4><p><strong>核心思想</strong>:网页的重要性取决于指向它的其他网页的重要性。</p><p><strong>数学模型</strong>:网页的 PageRank 值是转移矩阵 $M$ 的平稳分布:
$$
\mathbf{p} = M \mathbf{p}
$$</p><p>其中:</p><ul><li>$p_i$ 是网页 $i$ 的 PageRank</li><li>$M_{ij} = \frac{1}{d_j}$ 如果网页 $j$ 链接到 $i$($d_j$ 是 $j$ 的出度)</li></ul><p>这本质上是求特征值 1 对应的特征向量。</p><p><strong>问题</strong>: $M$ 可能不可约,没有唯一平稳分布。Google 使用:
$$
G = \alpha M + (1-\alpha) \frac{1}{n}\mathbf{1}\mathbf{1}^T
$$</p><p>其中 $\alpha \approx 0.85$。 $G$ 是随机矩阵,由 Perron-Frobenius 定理,存在唯一正特征向量。</p><p><strong>幂法迭代</strong>:
$$
\mathbf{p}^{(t+1)} = G \mathbf{p}^{(t)}
$$</p><p>收敛到最大特征值对应的特征向量。</p><h4 id=32-谱聚类>3.2 谱聚类<a hidden class=anchor aria-hidden=true href=#32-谱聚类>#</a></h4><p><strong>目标</strong>:将图划分为若干社区,使得社区内连接紧密,社区间连接稀疏。</p><p><strong>拉普拉斯矩阵</strong>:
$$
L = D - A
$$</p><p>其中 $D$ 是度矩阵($D_{ii} = \sum_j A_{ij}$),$A$ 是邻接矩阵。</p><p><strong>性质</strong>:</p><ul><li>$L$ 是对称半正定矩阵</li><li>特征值 $0 = \lambda_1 \leq \lambda_2 \leq \cdots \leq \lambda_n$</li><li>$\lambda_2$ 称为<strong>代数连通度</strong>(algebraic connectivity)</li></ul><p><strong>谱聚类算法</strong>:</p><ol><li>计算拉普拉斯矩阵 $L$ 的前 $k$ 个小特征值对应的特征向量 $\mathbf{u}_1, \ldots, \mathbf{u}_k$</li><li>构造矩阵 $U \in \mathbb{R}^{n \times k}$</li><li>在 $\mathbb{R}^k$ 中对 $U$ 的行做 k-means 聚类</li></ol><p><strong>几何直觉</strong>:特征向量给出了节点在低维空间中的嵌入,相似节点距离近。</p><h4 id=33-图神经网络>3.3 图神经网络<a hidden class=anchor aria-hidden=true href=#33-图神经网络>#</a></h4><p><strong>消息传递</strong>:
$$
\mathbf{h}<em>v^{(t+1)} = \sigma\left(\sum</em>{u \in \mathcal{N}(v)} W^{(t)} \mathbf{h}_u^{(t)}\right)
$$</p><p>写成矩阵形式:
$$
H^{(t+1)} = \sigma(A H^{(t)} W^{(t)})
$$</p><p>其中 $A$ 是邻接矩阵(可能加上自环和归一化)。</p><p><strong>谱图卷积</strong>:通过图傅里叶变换定义卷积:
$$
\hat{f} = U^T f, \quad g * f = U (U^T g \odot U^T f)
$$</p><p>其中 $U$ 是拉普拉斯矩阵的特征向量矩阵。</p><hr><h2 id=第三部分深度学习中的线性代数>第三部分:深度学习中的线性代数<a hidden class=anchor aria-hidden=true href=#第三部分深度学习中的线性代数>#</a></h2><h3 id=1-前向传播的线性代数>1. 前向传播的线性代数<a hidden class=anchor aria-hidden=true href=#1-前向传播的线性代数>#</a></h3><h4 id=11-矩阵乘法的计算效率>1.1 矩阵乘法的计算效率<a hidden class=anchor aria-hidden=true href=#11-矩阵乘法的计算效率>#</a></h4><p><strong>全连接层</strong>:
$$
\mathbf{y} = \sigma(W \mathbf{x} + \mathbf{b})
$$</p><p>对于批量数据 $X \in \mathbb{R}^{n \times d_{\text{in}}}$:
$$
Z = X W^ op + \mathbf{b} = \begin{pmatrix} \mathbf{x}_1^T \ \vdots \ \mathbf{x}<em>n^T \end{pmatrix} \begin{pmatrix} \mathbf{w}<em>1 & \cdots & \mathbf{w}</em>{d</em>{\text{out}}} \end{pmatrix} + \mathbf{1}\mathbf{b}^T
$$</p><p><strong>计算复杂度</strong>: $O(n \cdot d_{\text{in}} \cdot d_{\text{out}})$</p><p><strong>内存布局</strong>:现代深度学习框架使用列主序存储,利用缓存局部性加速。</p><h4 id=12-批量处理的向量化>1.2 批量处理的向量化<a hidden class=anchor aria-hidden=true href=#12-批量处理的向量化>#</a></h4><p><strong>向量化 vs. 循环</strong>:</p><p>不高效:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>batch_size</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>output_dim</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>z</span><span class=p>[</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dot</span><span class=p>(</span><span class=n>x</span><span class=p>[</span><span class=n>i</span><span class=p>],</span> <span class=n>w</span><span class=p>[</span><span class=n>j</span><span class=p>])</span> <span class=o>+</span> <span class=n>b</span><span class=p>[</span><span class=n>j</span><span class=p>]</span>
</span></span></code></pre></div><p>高效:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>Z</span> <span class=o>=</span> <span class=n>X</span> <span class=o>@</span> <span class=n>W</span><span class=o>.</span><span class=n>T</span> <span class=o>+</span> <span class=n>b</span>  <span class=c1># 利用 BLAS 优化</span>
</span></span></code></pre></div><p><strong>GPU 加速</strong>:GPU 有数千个核心,适合并行执行大量小运算。矩阵乘法可以分解为:</p><ul><li>线程块处理子矩阵</li><li>线程内处理标量运算</li><li>共享内存减少全局内存访问</li></ul><h4 id=13-广播机制的数学本质>1.3 广播机制的数学本质<a hidden class=anchor aria-hidden=true href=#13-广播机制的数学本质>#</a></h4><p><strong>广播规则</strong>:</p><ol><li>对齐尾部维度</li><li>维度为 1 时复制</li><li>缺失维度视为 1</li></ol><p><strong>例子</strong>:
$$
X \in \mathbb{R}^{n \times d}, \quad \mathbf{b} \in \mathbb{R}^d
$$</p><p>$$
X + \mathbf{b} = X + \mathbf{1}_{n \times 1} \mathbf{b}^T
$$</p><p><strong>张量广播</strong>:
$$
X \in \mathbb{R}^{n \times d_1 \times d_2}, \quad \mathbf{b} \in \mathbb{R}^{d_2}
$$</p><p>$$
X + \mathbf{b} = X + \mathbf{1}<em>{n \times d_1 \times 1} \times \mathbf{b}</em>{1 \times 1 \times d_2}
$$</p><p>广播本质上是外积的特殊情况。</p><hr><h3 id=2-反向传播与梯度计算>2. 反向传播与梯度计算<a hidden class=anchor aria-hidden=true href=#2-反向传播与梯度计算>#</a></h3><h4 id=21-链式法则的矩阵形式>2.1 链式法则的矩阵形式<a hidden class=anchor aria-hidden=true href=#21-链式法则的矩阵形式>#</a></h4><p><strong>标量情况</strong>:
$$
\frac{\partial L}{\partial x} = \frac{\partial L}{\partial y} \cdot \frac{\partial y}{\partial x}
$$</p><p><strong>向量情况</strong>:
$$
\frac{\partial L}{\partial \mathbf{x}} = \left(\frac{\partial \mathbf{y}}{\partial \mathbf{x}}\right)^ op \frac{\partial L}{\partial \mathbf{y}}
$$</p><p>其中 $\frac{\partial \mathbf{y}}{\partial \mathbf{x}}$ 是 Jacobian 矩阵:
$$
J_{ij} = \frac{\partial y_i}{\partial x_j}
$$</p><p><strong>全连接层</strong>:
$$
\mathbf{z} = W \mathbf{x} + \mathbf{b}, \quad \mathbf{y} = \sigma(\mathbf{z})
$$</p><p>梯度计算:
$$
\frac{\partial L}{\partial \mathbf{z}} = \frac{\partial L}{\partial \mathbf{y}} \odot \sigma&rsquo;(\mathbf{z})
$$</p><p>$$
\frac{\partial L}{\partial W} = \frac{\partial L}{\partial \mathbf{z}} \mathbf{x}^T
$$</p><p>$$
\frac{\partial L}{\partial \mathbf{b}} = \frac{\partial L}{\partial \mathbf{z}}
$$</p><p>$$
\frac{\partial L}{\partial \mathbf{x}} = W^ op \frac{\partial L}{\partial \mathbf{z}}
$$</p><h4 id=22-jacobian-矩阵的计算>2.2 Jacobian 矩阵的计算<a hidden class=anchor aria-hidden=true href=#22-jacobian-矩阵的计算>#</a></h4><p><strong>定义</strong>:对于 $f: \mathbb{R}^n \to \mathbb{R}^m$, Jacobian 矩阵为:
$$
J_f(\mathbf{x}) = \begin{pmatrix} \frac{\partial f_1}{\partial x_1} & \cdots & \frac{\partial f_1}{\partial x_n} \ \vdots & \ddots & \vdots \ \frac{\partial f_m}{\partial x_1} & \cdots & \frac{\partial f_m}{\partial x_n} \end{pmatrix}
$$</p><p><strong>链式法则</strong>:
$$
J_{g \circ f}(\mathbf{x}) = J_g(f(\mathbf{x})) \cdot J_f(\mathbf{x})
$$</p><p><strong>自动微分</strong>:</p><ul><li>前向模式:计算 $J \mathbf{v}$(适合 $n \ll m$)</li><li>反向模式:计算 $J^T \mathbf{v}$(适合 $m \ll n$,即损失函数是标量)</li></ul><p>深度学习使用反向模式,因为 $L$ 是标量。</p><h4 id=23-梯度消失爆炸的线性代数视角>2.3 梯度消失/爆炸的线性代数视角<a hidden class=anchor aria-hidden=true href=#23-梯度消失爆炸的线性代数视角>#</a></h4><p><strong>简化模型</strong>:考虑 $t$ 层线性网络(忽略激活):
$$
\mathbf{h}^{(t)} = W^{(t)} \mathbf{h}^{(t-1)}
$$</p><p>输出对输入的梯度:
$$
\frac{\partial L}{\partial \mathbf{h}^{(0)}} = (W^{(t)})^ op \cdots (W^{(1)})^ op \frac{\partial L}{\partial \mathbf{h}^{(t)}}
$$</p><p><strong>谱分析</strong>:令 $\sigma_{\max}^{(i)}$ 为 $W^{(i)}$ 的最大奇异值。梯度范数为:
$$
\left|\frac{\partial L}{\partial \mathbf{h}^{(0)}}\right| \approx \left(\prod_{i=1}^t \sigma_{\max}^{(i)}\right) \left|\frac{\partial L}{\partial \mathbf{h}^{(t)}}\right|
$$</p><ul><li>如果 $\sigma_{\max}^{(i)} > 1$: 梯度爆炸</li><li>如果 $\sigma_{\max}^{(i)} &lt; 1$: 梯度消失</li></ul><p><strong>Xavier 初始化</strong>:
$$
W_{ij} \sim \mathcal{N}\left(0, \frac{2}{n_{\text{in}} + n_{\text{out}}}\right)
$$</p><p>保持前向和反向激活的方差稳定。</p><hr><h3 id=3-正则化的几何意义>3. 正则化的几何意义<a hidden class=anchor aria-hidden=true href=#3-正则化的几何意义>#</a></h3><h4 id=31-l2-正则与欧氏空间投影>3.1 L2 正则与欧氏空间投影<a hidden class=anchor aria-hidden=true href=#31-l2-正则与欧氏空间投影>#</a></h4><p><strong>目标函数</strong>:
$$
J(\mathbf{w}) = |\mathbf{y} - X\mathbf{w}|^2 + \lambda |\mathbf{w}|^2
$$</p><p><strong>等价约束优化</strong>:
$$
\min_{\mathbf{w}} |\mathbf{y} - X\mathbf{w}|^2 \quad \text{s.t.} \quad |\mathbf{w}|^2 \leq C
$$</p><p><strong>几何解释</strong>:</p><ul><li>无约束解 $\mathbf{w}_{\text{LS}} = (X^ op X)^{-1} X^ op \mathbf{y}$</li><li>L2 正则解向原点收缩</li><li>等价于高斯先验: $\mathbf{w} \sim \mathcal{N}(0, \lambda^{-1} I)$</li></ul><p><strong>贝叶斯解释</strong>:
$$
\text{MAP} = \arg\max_{\mathbf{w}} \log P(\mathbf{y}|X, \mathbf{w}) + \log P(\mathbf{w})
$$</p><p>高斯似然 + 高斯先验 = 最小二乘 + L2 正则</p><h4 id=32-l1-正则与稀疏性>3.2 L1 正则与稀疏性<a hidden class=anchor aria-hidden=true href=#32-l1-正则与稀疏性>#</a></h4><p><strong>目标函数</strong>:
$$
J(\mathbf{w}) = |\mathbf{y} - X\mathbf{w}|^2 + \lambda |\mathbf{w}|_1
$$</p><p><strong>几何</strong>: L1 球是"菱形",角点在坐标轴上。优化倾向于解落在角点,导致某些坐标为零。</p><p><strong>次梯度</strong>: L1 不可导,使用次梯度:
$$
\partial |w_i| = \begin{cases} {1} & w_i > 0 \ {-1} & w_i &lt; 0 \ [-1, 1] & w_i = 0 \end{cases}
$$</p><p><strong>软阈值算子</strong>(ISTA):
$$
w_i \leftarrow \operatorname{sign}(w_i) \max(|w_i| - \lambda, 0)
$$</p><p><strong>应用</strong>:特征选择、压缩感知、稀疏编码。</p><h4 id=33-dropout-的线性代数解释>3.3 Dropout 的线性代数解释<a hidden class=anchor aria-hidden=true href=#33-dropout-的线性代数解释>#</a></h4><p><strong>训练时</strong>:
$$
\mathbf{h} = \mathbf{m} \odot \sigma(W \mathbf{x})
$$</p><p>其中 $\mathbf{m} \sim \operatorname{Bernoulli}(p)$。</p><p><strong>期望</strong>:
$$
\mathbb{E}[\mathbf{h}] = p \cdot \sigma(W \mathbf{x})
$$</p><p><strong>测试时</strong>:使用 $p \sigma(W \mathbf{x})$ 或 $\sigma(p W \mathbf{x})$(反向缩放)。</p><p><strong>正则化效果</strong>:</p><ul><li>防止共适应</li><li>等价于集成学习( Bagging)</li><li>近似贝叶斯推断(高斯过程)</li></ul><hr><h3 id=4-注意力机制>4. 注意力机制<a hidden class=anchor aria-hidden=true href=#4-注意力机制>#</a></h3><h4 id=41-注意力的矩阵运算>4.1 注意力的矩阵运算<a hidden class=anchor aria-hidden=true href=#41-注意力的矩阵运算>#</a></h4><p><strong>缩放点积注意力</strong>:
$$
\operatorname{Attention}(Q, K, V) = \operatorname{softmax}\left(\frac{QK^T}{\sqrt{d_k}}\right) V
$$</p><p>其中:</p><ul><li>$Q \in \mathbb{R}^{n \times d_k}$: Query 矩阵</li><li>$K \in \mathbb{R}^{m \times d_k}$: Key 矩阵</li><li>$V \in \mathbb{R}^{m \times d_v}$: Value 矩阵</li></ul><p><strong>计算步骤</strong>:</p><ol><li>计算相似度: $S = QK^T \in \mathbb{R}^{n \times m}$</li><li>缩放: $S / \sqrt{d_k}$(防止梯度消失)</li><li>Softmax: $A = \operatorname{softmax}(S, \dim=1)$</li><li>加权求和: $\operatorname{Output} = AV \in \mathbb{R}^{n \times d_v}$</li></ol><h4 id=42-query-key-value-的线性代数>4.2 Query-Key-Value 的线性代数<a hidden class=anchor aria-hidden=true href=#42-query-key-value-的线性代数>#</a></h4><p><strong>物理直觉</strong>:</p><ul><li><strong>Query</strong>: 我在找什么?</li><li><strong>Key</strong>: 我有什么标签?</li><li><strong>Value</strong>: 我包含什么信息?</li></ul><p><strong>内积相似度</strong>:
$$
S_{ij} = \langle \mathbf{q}_i, \mathbf{k}_j \rangle = |\mathbf{q}_i| |\mathbf{k}<em>j| \cos\theta</em>{ij}
$$</p><p>Softmax 将相似度转换为概率分布:
$$
A_{ij} = \frac{\exp(S_{ij} / \sqrt{d_k})}{\sum_{j&rsquo;=1}^m \exp(S_{ij&rsquo;} / \sqrt{d_k})}
$$</p><h4 id=43-自注意力中的矩阵分解>4.3 自注意力中的矩阵分解<a hidden class=anchor aria-hidden=true href=#43-自注意力中的矩阵分解>#</a></h4><p><strong>自注意力</strong>: $Q = K = V = X W$(其中 $X$ 是输入序列)</p><p><strong>多头注意力</strong>:
$$
\operatorname{MultiHead}(Q, K, V) = \operatorname{Concat}(\text{head}_1, \ldots, \text{head}_h) W^O
$$</p><p>$$
\text{head}_i = \operatorname{Attention}(QW_i^Q, KW_i^K, VW_i^V)
$$</p><p><strong>线性复杂度</strong>:对于序列长度 $n$,标准注意力是 $O(n^2)$。</p><p><strong>优化方法</strong>:</p><ul><li>稀疏注意力(只注意局部和全局)</li><li>线性注意力(使用核技巧)</li><li>低秩近似(分解注意力矩阵)</li></ul><p><strong>低秩注意力</strong>:
$$
A \approx \tilde{Q} \tilde{K}^T
$$</p><p>其中 $\tilde{Q} \in \mathbb{R}^{n \times r}$, $\tilde{K} \in \mathbb{R}^{m \times r}$, $r \ll \min(n, m)$。</p><hr><h2 id=第四部分高级主题>第四部分:高级主题<a hidden class=anchor aria-hidden=true href=#第四部分高级主题>#</a></h2><h3 id=1-张量分解>1. 张量分解<a hidden class=anchor aria-hidden=true href=#1-张量分解>#</a></h3><h4 id=11-张量的定义>1.1 张量的定义<a hidden class=anchor aria-hidden=true href=#11-张量的定义>#</a></h4><p><strong>张量</strong>是多维数组,是向量和矩阵的推广:</p><ul><li>标量: 0 阶张量</li><li>向量: 1 阶张量</li><li>矩阵: 2 阶张量</li><li>3 阶及更高:高阶张量</li></ul><p><strong>符号</strong>:</p><ul><li>$\mathcal{X} \in \mathbb{R}^{I_1 \times I_2 \times \cdots \times I_N}$</li><li>元素: $x_{i_1 i_2 \cdots i_N}$</li></ul><p><strong>操作</strong>:</p><ul><li><p><strong>模-$n$ 乘法</strong>: $\mathcal{X} \times_n U$(沿第 $n$ 维与矩阵 $U$ 相乘)</p></li><li><p><strong>展开</strong>(matricization):将张量重新排列为矩阵</p></li><li><p>** Tucker 分解**:
$$
\mathcal{X} \approx \mathcal{G} \times_1 A^{(1)} \times_2 \cdots \times_N A^{(N)}
$$</p><p>其中 $\mathcal{G}$ 是核心张量,$A^{(n)}$ 是因子矩阵。</p></li></ul><h4 id=12-cp-分解>1.2 CP 分解<a hidden class=anchor aria-hidden=true href=#12-cp-分解>#</a></h4><p><strong>CANDECOMP/PARAFAC</strong>(CP)分解:
$$
\mathcal{X} \approx \sum_{r=1}^R \lambda_r \mathbf{a}_r^{(1)} \circ \mathbf{a}_r^{(2)} \circ \cdots \circ \mathbf{a}_r^{(N)}
$$</p><p>其中 $\circ$ 是外积,$\lambda_r$ 是权重。</p><p><strong>矩阵情况</strong>的特殊形式:
$$
X \approx \sum_{r=1}^R \sigma_r \mathbf{u}_r \mathbf{v}_r^T
$$</p><p>这就是 SVD!</p><p><strong>优点</strong>:</p><ul><li>唯一性(在温和条件下)</li><li>解释性强</li></ul><p><strong>缺点</strong>:</p><ul><li>计算困难(NP-hard)</li><li>数值不稳定</li></ul><h4 id=13-张量网络>1.3 张量网络<a hidden class=anchor aria-hidden=true href=#13-张量网络>#</a></h4><p><strong>应用</strong>:</p><ul><li>量子多体系统</li><li>深度学习压缩</li></ul><p><strong>MPS</strong>(Matrix Product State):
$$
\mathcal{X}<em>{i_1 i_2 \cdots i_N} = A^{(1)}</em>{i_1} A^{(2)}<em>{i_2} \cdots A^{(N)}</em>{i_N}
$$</p><p><strong>张量列车</strong>(Tensor Train):
$$
\mathcal{X} \approx \sum_{r_1, \ldots, r_{N-1}} G_1^{r_1} \circ G_2^{r_1 r_2} \circ \cdots \circ G_N^{r_{N-1}}
$$</p><p><strong>在深度学习中</strong>:</p><ul><li>压缩全连接层</li><li>张量分解正则化</li><li>优化参数共享</li></ul><hr><h3 id=2-流形学习>2. 流形学习<a hidden class=anchor aria-hidden=true href=#2-流形学习>#</a></h3><h4 id=21-从欧氏空间到黎曼流形>2.1 从欧氏空间到黎曼流形<a hidden class=anchor aria-hidden=true href=#21-从欧氏空间到黎曼流形>#</a></h4><p><strong>核心假设</strong>:高维数据实际位于低维流形上。</p><p><strong>例子</strong>:</p><ul><li>人脸图像:变化的只是姿态、光照、表情(少数自由度)</li><li>文档:主题空间是低维的</li><li>基因表达:受少数调控因子控制</li></ul><p><strong>数学定义</strong>:
流形 $M$ 是局部同胚于欧氏空间的 Hausdorff 空间。在点 $p \in M$ 处,存在邻域 $U$ 和同胚 $\phi: U \to \mathbb{R}^d$。</p><p><strong>切空间</strong>: $T_p M$ 是 $M$ 在 $p$ 处的线性近似。</p><h4 id=22-测地线距离>2.2 测地线距离<a hidden class=anchor aria-hidden=true href=#22-测地线距离>#</a></h4><p><strong>欧氏距离</strong>在流形上不准确:
$$
d_{\text{Euclidean}}(p, q) = |\phi(p) - \phi(q)|
$$</p><p><strong>测地线距离</strong>是流形上最短路径长度:
$$
d_{\text{geodesic}}(p, q) = \min_{\gamma} \int_0^1 |\dot{\gamma}(t)| , dt
$$</p><p>其中 $\gamma: [0, 1] \to M$ 是连接 $p, q$ 的曲线。</p><p><strong>Isomap 算法</strong>:</p><ol><li>构建邻域图( k-NN 或 $\epsilon$-ball)</li><li>计算图上最短路径(Floyd-Warshall 或 Dijkstra)</li><li>在测地线距离矩阵上做 MDS</li></ol><h4 id=23-局部线性嵌入lle>2.3 局部线性嵌入(LLE)<a hidden class=anchor aria-hidden=true href=#23-局部线性嵌入lle>#</a></h4><p><strong>假设</strong>:流形局部是线性的。</p><p><strong>算法</strong>:</p><ol><li><p>对每个点 $\mathbf{x}<em>i$,在邻域内拟合线性组合:
$$
\min</em>{W_{ij}} |\mathbf{x}<em>i - \sum</em>{j \in \mathcal{N}(i)} W_{ij} \mathbf{x}_j|^2
$$</p><p>约束: $\sum_j W_{ij} = 1$</p></li><li><p>保持权重,在低维空间中重构:
$$
\min_{\mathbf{y}_i} \sum_i \left|\mathbf{y}<em>i - \sum_j W</em>{ij} \mathbf{y}_j\right|^2
$$</p></li></ol><p><strong>数学</strong>: $W$ 刻画了局部几何,低维嵌入应保持这些关系。</p><hr><h3 id=3-优化算法的线性代数>3. 优化算法的线性代数<a hidden class=anchor aria-hidden=true href=#3-优化算法的线性代数>#</a></h3><h4 id=31-梯度下降的收敛性>3.1 梯度下降的收敛性<a hidden class=anchor aria-hidden=true href=#31-梯度下降的收敛性>#</a></h4><p><strong>目标</strong>: $\min_{\mathbf{x}} f(\mathbf{x})$</p><p><strong>梯度下降</strong>:
$$
\mathbf{x}^{(t+1)} = \mathbf{x}^{(t)} - \eta \nabla f(\mathbf{x}^{(t)})
$$</p><p><strong>强凸情况</strong>:假设 $f$ 是 $L$-光滑且 $\mu$-强凸的,则:
$$
\lVert \mathbf{x}^{(t)} - \mathbf{x}^* \rVert^2 \leq \left(1 - \frac{\mu}{L}\right)^{t} \lVert \mathbf{x}^{(0)} - \mathbf{x}^* \rVert^2
$$</p><p>收敛速度依赖于<strong>条件数</strong> $\kappa = L/\mu$:</p><ul><li>$\kappa \approx 1$: 快速收敛</li><li>$\kappa \gg 1$: 慢收敛(山谷问题)</li></ul><p><strong>动量方法</strong>:
$$
\mathbf{v}^{(t+1)} = \beta \mathbf{v}^{(t)} + \nabla f(\mathbf{x}^{(t)})
$$</p><p>$$
\mathbf{x}^{(t+1)} = \mathbf{x}^{(t)} - \eta \mathbf{v}^{(t+1)}
$$</p><p>几何上,动量抑制震荡,加速收敛。</p><h4 id=32-牛顿法与-hessian-矩阵>3.2 牛顿法与 Hessian 矩阵<a hidden class=anchor aria-hidden=true href=#32-牛顿法与-hessian-矩阵>#</a></h4><p><strong>二阶泰勒展开</strong>:
$$
f(\mathbf{x} + \Delta \mathbf{x}) \approx f(\mathbf{x}) + \nabla f(\mathbf{x})^ op \Delta \mathbf{x} + \frac{1}{2} \Delta \mathbf{x}^T H(\mathbf{x}) \Delta \mathbf{x}
$$</p><p>其中 $H(\mathbf{x})$ 是 Hessian 矩阵:
$$
H_{ij} = \frac{\partial^2 f}{\partial x_i \partial x_j}
$$</p><p><strong>牛顿方向</strong>:
$$
\Delta \mathbf{x} = -H^{-1} \nabla f
$$</p><p><strong>优点</strong>:</p><ul><li>二阶收敛(接近最优点时)</li><li>不受条件数影响</li></ul><p><strong>缺点</strong>:</p><ul><li>计算 Hessian: $O(d^2)$</li><li>求解线性系统: $O(d^3)$</li><li>Hessian 可能不正定</li></ul><p><strong>拟牛顿法</strong>(BFGS, L-BFGS):用一阶信息近似 Hessian。</p><h4 id=33-二阶优化方法>3.3 二阶优化方法<a hidden class=anchor aria-hidden=true href=#33-二阶优化方法>#</a></h4><p><strong>对角 Hessian 近似</strong>(Adagrad, RMSprop):
$$
G_{ii} = \sum_t \left(\frac{\partial L}{\partial x_i}\right)^2
$$</p><p>$$
x_i \leftarrow x_i - \frac{\eta}{\sqrt{G_{ii} + \epsilon}} \frac{\partial L}{\partial x_i}
$$</p><p>几何上,自适应学习率补偿不同方向的曲率差异。</p><p><strong>Adam</strong>:结合动量 + RMSprop:
$$
\mathbf{m} = \beta_1 \mathbf{m} + (1-\beta_1) \mathbf{g}
$$</p><p>$$
\mathbf{v} = \beta_2 \mathbf{v} + (1-\beta_2) \mathbf{g}^2
$$</p><p>$$
\mathbf{x} \leftarrow \mathbf{x} - \frac{\eta}{\sqrt{\hat{\mathbf{v}}} + \epsilon} \hat{\mathbf{m}}
$$</p><p>其中 $\hat{\mathbf{m}}, \hat{\mathbf{v}}$ 是偏差修正后的估计。</p><p><strong>自然梯度</strong>:
$$
\Delta \mathbf{x} = -\eta F^{-1} \nabla f
$$</p><p>其中 $F$ 是 Fisher 信息矩阵。预条件使得梯度下降对参数重新参数化不变。</p><hr><h2 id=结语线性代数的生命力>结语:线性代数的生命力<a hidden class=anchor aria-hidden=true href=#结语线性代数的生命力>#</a></h2><p>回顾这段旅程,我们从向量空间的直观定义出发,经历了线性变换的几何之美,正交投影的代数之巧,奇异值分解的万能之用,最终抵达了深度学习的矩阵运算之实。线性代数之所以成为现代数学和人工智能的基石,正是因为它在<strong>抽象</strong>与<strong>具体</strong>之间找到了完美的平衡。</p><p>一方面,线性代数的抽象结构——向量空间、线性变换、内积空间——捕捉了"线性"这个数学关系的本质,使得同一种理论可以应用于几何、代数、分析、物理等不同领域。另一方面,线性代数又是极其具体的:矩阵的数值计算、梯度下降的迭代优化、注意力的加权求和,每一项操作都可以在计算机上高效实现,每一步推导都有明确的几何解释。</p><p>更重要的是,线性代数的生命力在于它的<strong>可扩展性</strong>。从二维平面到千万维的词嵌入空间,从简单的最小二乘到复杂的 Transformer,线性代数的规律始终不变。这使得我们可以在理解基本原理的基础上,驾驭复杂系统。</p><p>在未来,随着量子计算、神经符号 AI、因果推断等新领域的发展,线性代数将继续扮演关键角色。理解线性代数,不仅是掌握一门数学工具,更是培养一种思维方式——将复杂问题分解为简单部分,将非线性世界线性化处理,将抽象概念转化为具体计算。</p><p>正如伟大的数学家 Weyl 所说:&ldquo;线性代数是所有数学中最重要的部分。&ldquo;这句话在今天,比以往任何时候都更加真实。</p><h2 id=参考文献>参考文献<a hidden class=anchor aria-hidden=true href=#参考文献>#</a></h2><ol><li>Strang, G. (2016). <em>Introduction to Linear Algebra</em> (5th ed.). Wellesley-Cambridge Press.</li><li>Golub, G. H., & Van Loan, C. F. (2013). <em>Matrix Computations</em> (4th ed.). Johns Hopkins University Press.</li><li>Goodfellow, I., Bengio, Y., & Courville, A. (2016). <em>Deep Learning</em>. MIT Press.</li><li>Bishop, C. M. (2006). <em>Pattern Recognition and Machine Learning</em>. Springer.</li><li>Hastie, T., Tibshirani, R., & Friedman, J. (2009). <em>The Elements of Statistical Learning</em> (2nd ed.). Springer.</li><li>Boyd, S., & Vandenberghe, L. (2018). <em>Introduction to Applied Linear Algebra: Vectors, Matrices, and Least Squares</em>. Cambridge University Press.</li><li>Trefethen, L. N., & Bau, D. (1997). <em>Numerical Linear Algebra</em>. SIAM.</li><li>Axler, S. (2015). <em>Linear Algebra Done Right</em> (3rd ed.). Springer.</li><li>Parisi, G. (1988). <em>Statistical Field Theory</em> (Vol. 1). Perseus Publishing.</li><li>Horn, R. A., & Johnson, C. R. (2012). <em>Matrix Analysis</em> (2nd ed.). Cambridge University Press.</li></ol></div><footer class=post-footer><ul class=post-tags><li><a href=https://s-ai-unix.github.io/tags/%E7%BB%BC%E8%BF%B0/>综述</a></li><li><a href=https://s-ai-unix.github.io/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/>机器学习</a></li><li><a href=https://s-ai-unix.github.io/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/>深度学习</a></li><li><a href=https://s-ai-unix.github.io/tags/%E6%95%B0%E5%AD%A6/>数学</a></li><li><a href=https://s-ai-unix.github.io/tags/%E5%87%A0%E4%BD%95/>几何</a></li></ul><nav class=paginav><a class=prev href=https://s-ai-unix.github.io/posts/2026-01-25-probability-statistics-ml-guide/><span class=title>« Prev</span><br><span>概率论与数理统计：机器学习的概率基石</span>
</a><a class=next href=https://s-ai-unix.github.io/posts/2026-01-24-variational-autoencoder/><span class=title>Next »</span><br><span>变分自编码器：从概率建模到深度生成的优雅桥梁</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share 线性代数：从理论到 AI 应用的完整旅程 on x" href="https://x.com/intent/tweet/?text=%e7%ba%bf%e6%80%a7%e4%bb%a3%e6%95%b0%ef%bc%9a%e4%bb%8e%e7%90%86%e8%ae%ba%e5%88%b0%20AI%20%e5%ba%94%e7%94%a8%e7%9a%84%e5%ae%8c%e6%95%b4%e6%97%85%e7%a8%8b&amp;url=https%3a%2f%2fs-ai-unix.github.io%2fposts%2f2026-01-25-linear-algebra-complete-guide%2f&amp;hashtags=%e7%bb%bc%e8%bf%b0%2c%e6%9c%ba%e5%99%a8%e5%ad%a6%e4%b9%a0%2c%e6%b7%b1%e5%ba%a6%e5%ad%a6%e4%b9%a0%2c%e6%95%b0%e5%ad%a6%2c%e5%87%a0%e4%bd%95"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 线性代数：从理论到 AI 应用的完整旅程 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fs-ai-unix.github.io%2fposts%2f2026-01-25-linear-algebra-complete-guide%2f&amp;title=%e7%ba%bf%e6%80%a7%e4%bb%a3%e6%95%b0%ef%bc%9a%e4%bb%8e%e7%90%86%e8%ae%ba%e5%88%b0%20AI%20%e5%ba%94%e7%94%a8%e7%9a%84%e5%ae%8c%e6%95%b4%e6%97%85%e7%a8%8b&amp;summary=%e7%ba%bf%e6%80%a7%e4%bb%a3%e6%95%b0%ef%bc%9a%e4%bb%8e%e7%90%86%e8%ae%ba%e5%88%b0%20AI%20%e5%ba%94%e7%94%a8%e7%9a%84%e5%ae%8c%e6%95%b4%e6%97%85%e7%a8%8b&amp;source=https%3a%2f%2fs-ai-unix.github.io%2fposts%2f2026-01-25-linear-algebra-complete-guide%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 线性代数：从理论到 AI 应用的完整旅程 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fs-ai-unix.github.io%2fposts%2f2026-01-25-linear-algebra-complete-guide%2f&title=%e7%ba%bf%e6%80%a7%e4%bb%a3%e6%95%b0%ef%bc%9a%e4%bb%8e%e7%90%86%e8%ae%ba%e5%88%b0%20AI%20%e5%ba%94%e7%94%a8%e7%9a%84%e5%ae%8c%e6%95%b4%e6%97%85%e7%a8%8b"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 线性代数：从理论到 AI 应用的完整旅程 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fs-ai-unix.github.io%2fposts%2f2026-01-25-linear-algebra-complete-guide%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li></ul></footer><script src=https://giscus.app/client.js data-repo=s-ai-unix/blog data-repo-id=R_kgDOQ3Njaw data-category=General data-category-id=DIC_kwDOQ3Nja84C0yve data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=zh-CN data-loading=lazy crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2026 <a href=https://s-ai-unix.github.io/>s-ai-unix's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>(function(){"use strict";function e(){var e=document.querySelectorAll("p, li, td, div, span, h1, h2, h3, h4, h5, h6, ol, ul");e.forEach(function(e){if(e.classList.contains("classical-quote-container")||e.classList.contains("quote-text")||e.closest(".classical-quote-container"))return;var t,n=e.innerHTML,s=!1;for(n.indexOf("<em>")!==-1&&(t=n.replace(/\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$/g,function(e,t,n,s){return/^[\d.,]+$/.test((t+n+s).replace(/[.,]/g,""))?e:"$"+t+"_"+n+s+"$"}),t=t.replace(/\$\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$\$/g,function(e,t,n,s){return"$$"+t+"_"+n+s+"$$"}),t!==n&&(n=t,s=!0)),n.indexOf("</em>")!==-1&&(t=n.replace(/\$([^$]*?)<\/em>([^$]*?)\$/g,function(e,t,n){return"$"+t+"_{"+n+"$"}),t=t.replace(/\$\$([^$]*?)<\/em>([^$]*?)\$\$/g,function(e,t,n){return"$$"+t+"_{"+n+"$$"}),t!==n&&(n=t,s=!0)),n.indexOf("<em>$")!==-1&&(t=n.replace(/<em>\$/g,"$"),t!==n&&(n=t,s=!0)),n.indexOf("</em>$")!==-1&&(t=n.replace(/<\/em>\$/g,"$"),t!==n&&(n=t,s=!0));n.indexOf("<em>")!==-1&&n.indexOf("</em>")!==-1;){if(t=n.replace(/\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$/g,function(e,t,n,s){return/^[\d.,]+$/.test((t+n+s).replace(/[.,]/g,""))?e:"$"+t+"_"+n+s+"$"}),t=t.replace(/\$\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$\$/g,function(e,t,n,s){return"$$"+t+"_"+n+s+"$$"}),t===n)break;n=t,s=!0}n.indexOf("_{")!==-1&&(t=n.replace(/_{/g,"_{"),t!==n&&(n=t,s=!0)),n.indexOf("}_")!==-1&&(t=n.replace(/}_/g,"}"),t!==n&&(n=t,s=!0)),n.includes("</em>{")&&(t=n.replace(/\\mathbf\{(W|x|y|z)\}<\/em>\{\\mathrm\{([a-z]+)\}\}/g,"\\mathbf{$1}_{\\mathrm{$2}}"),t=t.replace(/([LHf])<\/em>\{\\mathrm\{([a-z]+)\}\}/g,"$1_{\\mathrm{$2}}"),t=t.replace(/\\nabla ([LHf])<\/em>\{\\mathrm\{([a-z]+)\}\}/g,`\\nabla $1_{\\mathrm{$2}}`),t=t.replace(/([A-Z])<\/em>\{\\mathrm\{([a-z]+)\}\}/g,"$1_{\\mathrm{$2}}"),t!==n&&(n=t,s=!0)),n.includes("<em>{\\mathrm{")&&(t=n.replace(/\\mathbf\{(W|x|y|z)\}<em>\{\\mathrm\{([a-z]+)\}\}/g,"\\mathbf{$1}_{\\mathrm{$2}}"),t=t.replace(/([LHf])<em>\{\\mathrm\{([a-z]+)\}\}/g,"$1_{\\mathrm{$2}}"),t=t.replace(/\\nabla ([LHf])<em>\{\\mathrm\{([a-z]+)\}\}/g,`\\nabla $1_{\\mathrm{$2}}`),t=t.replace(/([A-Z])<em>\{\\mathrm\{([a-z]+)\}\}/g,"$1_{\\mathrm{$2}}"),t!==n&&(n=t,s=!0)),(n.includes("</em>")||n.includes("<em>"))&&(t=n.replace(/(\$[^$]*?)<em>([^$]*?)<\/em>/g,"$1_{$2}"),t=t.replace(/(\$\$[^$]*?)<em>([^$]*?)<\/em>/g,"$1_{$2}"),t=t.replace(/(\$[^$]*?)<em>/g,"$1"),t=t.replace(/<em>([^$]*?\$)/g,"$1"),t=t.replace(/(\$[^$]*?)<\/em>/g,"$1"),t=t.replace(/<\/em>([^$]*?\$)/g,"$1"),t!==n&&(n=t,s=!0)),n.indexOf("\\\\")!==-1&&(t=n.replace(/(\$\{1,2\})([^$]*?)(\$\{1,2\})/g,function(e,t,n,s){for(;n.indexOf("\\\\")!==-1;)n=n.replace(/\\\\/g,"\\");return t+n+s}),t!==n&&(n=t,s=!0)),s&&(e.innerHTML=n)})}window.MathJax={tex:{inlineMath:[["$","$"]],displayMath:[["$$","$$"]],processEscapes:!0,processEnvironments:!0,tags:"ams",packages:{"[+]":["noerrors","noundefined","boldsymbol"]},macros:{oiint:"\\mathop{∯}",oiiint:"\\mathop{∰}"}},options:{skipHtmlTags:["script","noscript","style","textarea","pre","code"]},startup:{pageReady:function(){return e(),MathJax.startup.defaultPageReady().then(function(){console.log("MathJax formulas rendered successfully")})}}}})()</script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link rel=stylesheet href=/css/mermaid-custom.css><script src=/js/mermaid-converter.js></script><script type=module>
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';

  
  setTimeout(() => {
    mermaid.initialize({
      startOnLoad: true,
      theme: 'base',
      themeVariables: {
        primaryColor: '#e3f2fd',
        primaryTextColor: '#1565c0',
        primaryBorderColor: '#2196f3',
        lineColor: '#42a5f5',
        secondaryColor: '#f3e5f5',
        tertiaryColor: '#fff9c4',
        background: '#ffffff',
        mainBkg: '#ffffff',
        nodeBorder: '#2196f3',
        clusterBkg: '#ffffff',
        clusterBorder: '#e0e0e0',
        titleColor: '#1565c0',
        edgeLabelBackground: '#fafafa',
      },
      securityLevel: 'loose',
    });
  }, 100);
</script><script src=/js/toc.js></script><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script>(function(){"use strict";function e(){var e=document.querySelectorAll("p, li, td, div, span, h1, h2, h3, h4, h5, h6, ol, ul");e.forEach(function(e){if(e.classList.contains("classical-quote-container")||e.classList.contains("quote-text")||e.closest(".classical-quote-container"))return;var t,n=e.innerHTML,s=!1;for(n.indexOf("<em>")!==-1&&(t=n.replace(/\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$/g,function(e,t,n,s){return/^[\d.,]+$/.test((t+n+s).replace(/[.,]/g,""))?e:"$"+t+"_"+n+s+"$"}),t=t.replace(/\$\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$\$/g,function(e,t,n,s){return"$$"+t+"_"+n+s+"$$"}),t!==n&&(n=t,s=!0)),n.indexOf("</em>")!==-1&&(t=n.replace(/\$([^$]*?)<\/em>([^$]*?)\$/g,function(e,t,n){return"$"+t+"_{"+n+"$"}),t=t.replace(/\$\$([^$]*?)<\/em>([^$]*?)\$\$/g,function(e,t,n){return"$$"+t+"_{"+n+"$$"}),t!==n&&(n=t,s=!0)),n.indexOf("<em>$")!==-1&&(t=n.replace(/<em>\$/g,"$"),t!==n&&(n=t,s=!0)),n.indexOf("</em>$")!==-1&&(t=n.replace(/<\/em>\$/g,"$"),t!==n&&(n=t,s=!0));n.indexOf("<em>")!==-1&&n.indexOf("</em>")!==-1;){if(t=n.replace(/\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$/g,function(e,t,n,s){return/^[\d.,]+$/.test((t+n+s).replace(/[.,]/g,""))?e:"$"+t+"_"+n+s+"$"}),t=t.replace(/\$\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$\$/g,function(e,t,n,s){return"$$"+t+"_"+n+s+"$$"}),t===n)break;n=t,s=!0}n.indexOf("_{")!==-1&&(t=n.replace(/_{/g,"_{"),t!==n&&(n=t,s=!0)),n.indexOf("}_")!==-1&&(t=n.replace(/}_/g,"}"),t!==n&&(n=t,s=!0)),n.includes("</em>{")&&(t=n.replace(/\\mathbf\{(W|x|y|z)\}<\/em>\{\\mathrm\{([a-z]+)\}\}/g,"\\mathbf{$1}_{\\mathrm{$2}}"),t=t.replace(/([LHf])<\/em>\{\\mathrm\{([a-z]+)\}\}/g,"$1_{\\mathrm{$2}}"),t=t.replace(/\\nabla ([LHf])<\/em>\{\\mathrm\{([a-z]+)\}\}/g,`\\nabla $1_{\\mathrm{$2}}`),t=t.replace(/([A-Z])<\/em>\{\\mathrm\{([a-z]+)\}\}/g,"$1_{\\mathrm{$2}}"),t!==n&&(n=t,s=!0)),n.includes("<em>{\\mathrm{")&&(t=n.replace(/\\mathbf\{(W|x|y|z)\}<em>\{\\mathrm\{([a-z]+)\}\}/g,"\\mathbf{$1}_{\\mathrm{$2}}"),t=t.replace(/([LHf])<em>\{\\mathrm\{([a-z]+)\}\}/g,"$1_{\\mathrm{$2}}"),t=t.replace(/\\nabla ([LHf])<em>\{\\mathrm\{([a-z]+)\}\}/g,`\\nabla $1_{\\mathrm{$2}}`),t=t.replace(/([A-Z])<em>\{\\mathrm\{([a-z]+)\}\}/g,"$1_{\\mathrm{$2}}"),t!==n&&(n=t,s=!0)),(n.includes("</em>")||n.includes("<em>"))&&(t=n.replace(/(\$[^$]*?)<em>([^$]*?)<\/em>/g,"$1_{$2}"),t=t.replace(/(\$\$[^$]*?)<em>([^$]*?)<\/em>/g,"$1_{$2}"),t=t.replace(/(\$[^$]*?)<em>/g,"$1"),t=t.replace(/<em>([^$]*?\$)/g,"$1"),t=t.replace(/(\$[^$]*?)<\/em>/g,"$1"),t=t.replace(/<\/em>([^$]*?\$)/g,"$1"),t!==n&&(n=t,s=!0)),n.indexOf("\\\\")!==-1&&(t=n.replace(/(\$\{1,2\})([^$]*?)(\$\{1,2\})/g,function(e,t,n,s){for(;n.indexOf("\\\\")!==-1;)n=n.replace(/\\\\/g,"\\");return t+n+s}),t!==n&&(n=t,s=!0)),s&&(e.innerHTML=n)})}window.MathJax={tex:{inlineMath:[["$","$"]],displayMath:[["$$","$$"]],processEscapes:!0,processEnvironments:!0,tags:"ams",packages:{"[+]":["noerrors","noundefined","boldsymbol"]},macros:{oiint:"\\mathop{∯}",oiiint:"\\mathop{∰}"}},options:{skipHtmlTags:["script","noscript","style","textarea","pre","code"]},startup:{pageReady:function(){return e(),MathJax.startup.defaultPageReady().then(function(){console.log("MathJax formulas rendered successfully")})}}}})()</script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link rel=stylesheet href=/css/mermaid-custom.css><script src=/js/mermaid-converter.js></script><script type=module>
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';

  
  setTimeout(() => {
    mermaid.initialize({
      startOnLoad: true,
      theme: 'base',
      themeVariables: {
        primaryColor: '#e3f2fd',
        primaryTextColor: '#1565c0',
        primaryBorderColor: '#2196f3',
        lineColor: '#42a5f5',
        secondaryColor: '#f3e5f5',
        tertiaryColor: '#fff9c4',
        background: '#ffffff',
        mainBkg: '#ffffff',
        nodeBorder: '#2196f3',
        clusterBkg: '#ffffff',
        clusterBorder: '#e0e0e0',
        titleColor: '#1565c0',
        edgeLabelBackground: '#fafafa',
      },
      securityLevel: 'loose',
    });
  }, 100);
</script><script src=/js/toc.js></script></body></html>