<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>留数定理：复变函数的神奇积分 | s-ai-unix's Blog</title><meta name=keywords content="留数定理,复变函数,积分,柯西积分定理,洛朗级数"><meta name=description content="从实数积分的难题到复变函数的优雅解法，深入浅出地介绍留数定理的背景、推导与应用。"><meta name=author content="s-ai-unix"><link rel=canonical href=https://s-ai-unix.github.io/posts/2026-01-24-residue-theorem-guide/><link crossorigin=anonymous href=/assets/css/stylesheet.0833aff7e1cf567ecfb9755701ee95a80535f671e2e1a0a770c9bc20a0a7b5bb.css integrity="sha256-CDOv9+HPVn7PuXVXAe6VqAU19nHi4aCncMm8IKCntbs=" rel="preload stylesheet" as=style><link rel=icon href=https://s-ai-unix.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s-ai-unix.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s-ai-unix.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s-ai-unix.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s-ai-unix.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s-ai-unix.github.io/posts/2026-01-24-residue-theorem-guide/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="https://s-ai-unix.github.io/posts/2026-01-24-residue-theorem-guide/"><meta property="og:site_name" content="s-ai-unix's Blog"><meta property="og:title" content="留数定理：复变函数的神奇积分"><meta property="og:description" content="从实数积分的难题到复变函数的优雅解法，深入浅出地介绍留数定理的背景、推导与应用。"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2026-01-24T10:54:00+08:00"><meta property="article:modified_time" content="2026-01-24T10:54:00+08:00"><meta property="article:tag" content="留数定理"><meta property="article:tag" content="复变函数"><meta property="article:tag" content="积分"><meta property="article:tag" content="柯西积分定理"><meta property="article:tag" content="洛朗级数"><meta property="og:image" content="https://s-ai-unix.github.io/images/covers/residue-theorem-cover.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://s-ai-unix.github.io/images/covers/residue-theorem-cover.jpg"><meta name=twitter:title content="留数定理：复变函数的神奇积分"><meta name=twitter:description content="从实数积分的难题到复变函数的优雅解法，深入浅出地介绍留数定理的背景、推导与应用。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://s-ai-unix.github.io/posts/"},{"@type":"ListItem","position":2,"name":"留数定理：复变函数的神奇积分","item":"https://s-ai-unix.github.io/posts/2026-01-24-residue-theorem-guide/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"留数定理：复变函数的神奇积分","name":"留数定理：复变函数的神奇积分","description":"从实数积分的难题到复变函数的优雅解法，深入浅出地介绍留数定理的背景、推导与应用。","keywords":["留数定理","复变函数","积分","柯西积分定理","洛朗级数"],"articleBody":"引言：一个棘手的积分问题 在微积分课程中，我们经常遇到各种有趣的积分问题。有些积分可以通过基本的积分技巧轻松解决，比如分部积分、换元法等。但有些积分却非常棘手，让人绞尽脑汁。\n让我们从一个经典的例子开始：\n$$ \\int_{-\\infty}^{\\infty} \\frac{dx}{1 + x^2} $$\n这个积分看起来并不复杂，被积函数 $\\frac{1}{1 + x^2}$ 在整个实数轴上都连续且趋于零。但是，如果我们试图用常规的微积分方法来求解，会发现这并不是一件容易的事情。\n当然，如果你熟悉基本的微积分技巧，可能会想到使用反正切函数的原函数 $\\arctan x$。但这只是一种特殊的情况。如果我们将问题稍微复杂化，比如考虑下面的积分：\n$$ \\int_{-\\infty}^{\\infty} \\frac{\\cos x}{x^2 + 1} dx $$\n这个积分就更加困难了。被积函数 $\\frac{\\cos x}{x^2 + 1}$ 并没有明显的原函数，分部积分也无法直接应用。\n面对这样的难题，数学家们发现了一个惊人的方法：将实数问题扩展到复数域中。通过复变函数的工具，许多看似困难的实数积分问题变得优雅而简洁。而留数定理正是复变函数中最强大的工具之一。\n历史背景：从欧拉到柯西 复变函数理论的发展是数学史上一个辉煌的篇章。早在 18 世纪，欧拉（Leonhard Euler）就开始研究复数和复变函数，但他更多地将复数作为一种计算工具，而不是深入研究其结构。\n真正开创复变函数理论的功臣是柯西（Augustin-Louis Cauchy，1789-1857）。这位法国数学家在 19 世纪上半叶做出了许多开创性的工作，其中最著名的包括柯西积分定理、柯西积分公式，以及我们今天要讨论的留数定理。\n柯西的工作不仅仅是技巧性的，更是概念性的。他深刻地理解了解析函数的性质，并发现了复数积分与解析函数性质之间的深刻联系。他的工作为后来整个复变函数理论奠定了基础。\n与柯西同时代，德国数学家魏尔斯特拉斯（Karl Weierstrass）则从另一个角度——幂级数——来研究复变函数。这两种方法各有优势，后来被证明是完全等价的。\n留数定理的发展正是建立在柯西积分定理和洛朗级数（由法国数学家洛朗提出）的基础之上。它将积分问题转化为代数问题，使得许多复杂的计算变得简单而优雅。\n复数积分基础 在深入留数定理之前，我们需要先了解一些复变函数和复数积分的基础知识。\n复变函数 复变函数是从复数域到复数域的映射。如果我们用 $z = x + iy$ 表示复数，其中 $x$ 和 $y$ 是实数，$i$ 是虚数单位（满足 $i^2 = -1$），那么复变函数可以表示为：\n$$ f(z) = u(x, y) + i v(x, y) $$\n其中 $u(x, y)$ 和 $v(x, y)$ 都是实值函数。\n图 1：复平面上的点表示复数 $z = x + iy$\n解析函数 复变函数理论中最核心的概念是解析函数。一个复变函数 $f(z)$ 在某个区域内解析，如果它在该区域内每一点都可导。\n但是，复变函数的可导性比实变函数要强得多。对于一个复变函数 $f(z) = u(x, y) + i v(x, y)$，它在某点可导的必要条件是：\n$$ \\frac{\\partial u}{\\partial x} = \\frac{\\partial v}{\\partial y}, \\quad \\frac{\\partial u}{\\partial y} = -\\frac{\\partial v}{\\partial x} $$\n这两个方程被称为柯西-黎曼方程。它们是解析函数的核心特征，深刻地反映了复变函数的特殊性质。\n柯西-黎曼方程的几何意义是：解析函数在局部是保角的映射。也就是说，解析函数保持角度不变，这是复变函数许多美妙性质的基础。\n复数积分 复数积分可以类比实数积分来定义。如果我们有一个连续的复变函数 $f(z)$ 和一条从点 $a$ 到点 $b$ 的曲线 $\\gamma$，那么 $f(z)$ 沿曲线 $\\gamma$ 的积分定义为：\n$$ \\int_{\\gamma} f(z) dz = \\lim_{n \\to \\infty} \\sum_{j=1}^{n} f(z_j) (z_j - z_{j-1}) $$\n其中 $z_0 = a, z_n = b$，而 $z_j$ 是曲线上的点。\n这个定义看起来有些抽象，但它与实数积分的定义是完全类似的。区别在于，这里的路径 $\\gamma$ 是复平面上的曲线，而 $dz$ 也是复数。\n柯西积分定理 柯西积分定理是复变函数理论中最基本的定理之一，它揭示了复数积分的一个重要性质。\n定理表述 柯西积分定理：如果 $f(z)$ 在单连通区域 $D$ 内解析，$\\gamma$ 是 $D$ 内的一条闭合曲线，那么：\n$$ \\oint_{\\gamma} f(z) dz = 0 $$\n这个定理的表述非常简洁，但它的含义却非常深刻。它告诉我们，解析函数沿闭合路径的积分恒为零。这与实数积分形成了鲜明对比——在实数情况下，只有当被积函数有原函数时，闭合路径积分才为零。\n几何直观 柯西积分定理的几何直观来源于解析函数的局部性质。由于解析函数在局部可以近似为线性变换，而且这种变换保持角度（保角性），因此当我们沿着闭合路径积分时，各个部分的贡献会相互抵消。\n想象一下你在复平面上沿着一个闭合路径行走，计算每一步的 $f(z) dz$。由于函数是解析的，这种\"旋转\"和\"伸缩\"会相互抵消，最终的总和为零。\n柯西积分公式 柯西积分定理的一个重要推论是柯西积分公式。这个公式让我们可以通过函数在边界上的值来确定函数在内部任意点的值。\n柯西积分公式：如果 $f(z)$ 在区域 $D$ 内解析，$\\gamma$ 是 $D$ 内包围点 $a$ 的简单闭合曲线，那么：\n$$ f(a) = \\frac{1}{2\\pi i} \\oint_{\\gamma} \\frac{f(z)}{z - a} dz $$\n这个公式非常强大，它告诉我们，一个解析函数在内部某点的值完全由它在边界上的行为决定。这在某种程度上类似于物理中的场论——边界条件决定了内部的状态。\n柯西积分公式的一个重要应用是计算积分。例如，如果我们想要计算 $\\oint_{\\gamma} \\frac{dz}{z - a}$，其中 $\\gamma$ 包围 $a$，那么根据柯西积分公式（取 $f(z) = 1$），我们有：\n$$ \\oint_{\\gamma} \\frac{dz}{z - a} = 2\\pi i $$\n这个结果在后面的讨论中会非常重要。\n洛朗级数 在讨论留数定理之前，我们还需要了解洛朗级数。洛朗级数是泰勒级数在有奇点情况下的推广。\n泰勒级数的局限 我们知道，如果一个函数在某点 $z_0$ 解析，那么它可以展开为泰勒级数：\n$$ f(z) = \\sum_{n=0}^{\\infty} \\frac{f^{(n)}(z_0)}{n!} (z - z_0)^n $$\n这个级数在以 $z_0$ 为中心的某个圆内收敛。但是，如果函数在 $z_0$ 点有奇点（即函数在该点无定义或不可导），那么泰勒级数就失效了。\n洛朗级数 洛朗级数解决了这个问题。它在泰勒级数的基础上增加了负幂次项，使得函数可以在环形区域内展开。\n洛朗级数：如果函数 $f(z)$ 在环形区域 $r \u003c |z - z_0| \u003c R$ 内解析（$z_0$ 是函数的孤立奇点），那么它可以展开为：\n$$ f(z) = \\sum_{n=-\\infty}^{\\infty} c_n (z - z_0)^n = \\cdots + \\frac{c_{-2}}{(z - z_0)^2} + \\frac{c_{-1}}{z - z_0} + c_0 + c_1 (z - z_0) + \\cdots $$\n其中系数为：\n$$ c_n = \\frac{1}{2\\pi i} \\oint_{\\gamma} \\frac{f(z)}{(z - z_0)^{n+1}} dz $$\n这里 $\\gamma$ 是环形区域内任意的简单闭合曲线，包围 $z_0$。\n图 2：洛朗级数的环形收敛域\n洛朗级数的分解 洛朗级数可以分解为两部分：\n主要部分（Principal Part）：包含负幂次项 $\\sum_{n=1}^{\\infty} \\frac{c_{-n}}{(z - z_0)^n}$，描述了函数在奇点附近的行为。\n解析部分（Analytic Part）：包含非负幂次项 $\\sum_{n=0}^{\\infty} c_n (z - z_0)^n$，在环形区域内解析。\n这个分解对于理解函数在奇点附近的行为非常重要。主要部分中负幂次项的个数决定了奇点的类型：\n如果主要部分为零，$z_0$ 是可去奇点 如果主要部分只有有限项，$z_0$ 是极点 如果主要部分有无穷多项，$z_0$ 是本性奇点 留数定理 现在我们终于要介绍留数定理了。留数定理是复变函数理论中最强大的工具之一，它将复数积分问题转化为代数问题。\n留数的定义 在洛朗级数展开中，我们特别关注系数 $c_{-1}$，即 $(z - z_0)^{-1}$ 项的系数。这个系数有一个特殊的名称——留数（Residue）。\n留数的定义：如果函数 $f(z)$ 在 $z_0$ 点有孤立奇点，那么 $f(z)$ 在 $z_0$ 点的留数记为 $\\text{Res}[f(z), z_0]$ 或 $\\text{Res}_{z=z_0} f(z)$，它是洛朗级数中 $(z - z_0)^{-1}$ 项的系数：\n$$ \\text{Res}{z=z_0} f(z) = c{-1} = \\frac{1}{2\\pi i} \\oint_{\\gamma} f(z) dz $$\n其中 $\\gamma$ 是围绕 $z_0$ 的一条简单闭合曲线，不包含其他奇点。\n为什么留数如此重要？因为在洛朗级数中，只有 $(z - z_0)^{-1}$ 项的积分不为零！其他所有项的积分都是零：\n$$ \\oint_{\\gamma} (z - z_0)^n dz = 0 \\quad (n \\neq -1) $$\n$$ \\oint_{\\gamma} \\frac{dz}{z - z_0} = 2\\pi i $$\n这意味着，当我们沿着闭合路径积分时，只有留数对积分有贡献。\n留数定理的表述 留数定理：如果函数 $f(z)$ 在闭合曲线 $\\gamma$ 内部有有限个孤立奇点 $z_1, z_2, \\ldots, z_n$，在 $\\gamma$ 上连续，那么：\n$$ \\oint_{\\gamma} f(z) dz = 2\\pi i \\sum_{k=1}^{n} \\text{Res}_{z=z_k} f(z) $$\n这就是留数定理的完整表述。它告诉我们，闭合路径上的积分等于 $2\\pi i$ 乘以路径内部所有留数的和。\n图 3：围道积分路径与奇点\n留数定理的推导 现在让我们从柯西积分定理出发，推导留数定理。\n设函数 $f(z)$ 在闭合曲线 $\\gamma$ 内部有有限个孤立奇点 $z_1, z_2, \\ldots, z_n$。对于每个奇点 $z_k$，我们构造一个很小的圆周 $\\gamma_k$ 包围 $z_k$，使得这些小圆周彼此不相交，并且都位于 $\\gamma$ 的内部。\n根据柯西积分定理的推广形式（变形定理），我们有：\n$$ \\oint_{\\gamma} f(z) dz = \\sum_{k=1}^{n} \\oint_{\\gamma_k} f(z) dz $$\n这个等式说明，沿大曲线的积分等于沿所有小曲线积分的和。\n现在，对于每个小曲线 $\\gamma_k$，我们利用洛朗级数展开：\n$$ f(z) = \\sum_{m=-\\infty}^{\\infty} c_m^{(k)} (z - z_k)^m $$\n其中 $c_m^{(k)}$ 是围绕 $z_k$ 展开的洛朗级数的系数。\n沿 $\\gamma_k$ 积分：\n$$ \\oint_{\\gamma_k} f(z) dz = \\sum_{m=-\\infty}^{\\infty} c_m^{(k)} \\oint_{\\gamma_k} (z - z_k)^m dz $$\n注意到：\n$$ \\oint_{\\gamma_k} (z - z_k)^m dz = \\begin{cases} 2\\pi i, \u0026 m = -1 \\\\ 0, \u0026 m \\neq -1 \\end{cases} $$\n因此，只有 $m = -1$ 的项对积分有贡献：\n$$ \\oint_{\\gamma_k} f(z) dz = c_{-1}^{(k)} \\cdot 2\\pi i = 2\\pi i \\cdot \\text{Res}_{z=z_k} f(z) $$\n将所有小曲线的积分加起来，得到：\n$$ \\oint_{\\gamma} f(z) dz = \\sum_{k=1}^{n} 2\\pi i \\cdot \\text{Res}{z=z_k} f(z) = 2\\pi i \\sum{k=1}^{n} \\text{Res}_{z=z_k} f(z) $$\n这就完成了留数定理的推导！\n留数的计算方法 在实际应用中，我们需要计算函数在各种奇点处的留数。以下是几种常见情况下的计算方法：\n1. 单极点的情况 如果 $z_0$ 是 $f(z)$ 的单极点（一阶极点），那么：\n$$ \\text{Res}{z=z_0} f(z) = \\lim{z \\to z_0} (z - z_0) f(z) $$\n特别地，如果 $f(z) = \\frac{g(z)}{h(z)}$，其中 $g(z_0) \\neq 0$，$h(z_0) = 0$，$h’(z_0) \\neq 0$，那么：\n$$ \\text{Res}_{z=z_0} f(z) = \\frac{g(z_0)}{h’(z_0)} $$\n2. 高阶极点的情况 如果 $z_0$ 是 $m$ 阶极点，那么：\n$$ \\text{Res}{z=z_0} f(z) = \\frac{1}{(m-1)!} \\lim{z \\to z_0} \\frac{d^{m-1}}{dz^{m-1}} \\left[ (z - z_0)^m f(z) \\right] $$\n3. 洛朗级数展开法 对于复杂的情况，我们可以直接进行洛朗级数展开，找到 $(z - z_0)^{-1}$ 项的系数。\n留数的几何直观 图 4：函数 $f(z) = \\frac{1}{z-1}$ 在奇点附近的行为\n留数有一个直观的几何解释。想象你在复平面上围绕一个奇点行走，记录函数值的\"累积旋转\"。这个累积旋转的量度就是留数。\n如果留数为零，函数在该点的行为相对\"温和\"。如果留数非零，函数在该点会产生显著的\"旋转效应\"。\n应用实例 留数定理的强大之处在于它能够解决许多看似困难的积分问题。让我们通过几个经典例子来展示留数定理的应用。\n例 1：计算实数积分 $\\int_{-\\infty}^{\\infty} \\frac{dx}{1 + x^2}$ 这是一个经典的积分，其值为 $\\pi$。现在我们用留数定理来求解。\n考虑复变函数 $f(z) = \\frac{1}{1 + z^2}$。这个函数有两个一阶极点：$z = i$ 和 $z = -i$。\n我们构造一个半圆形的闭合曲线 $\\gamma$，由实轴上从 $-R$ 到 $R$ 的线段和上半平面的半圆 $C_R$ 组成。\n$$ \\oint_{\\gamma} \\frac{dz}{1 + z^2} = \\int_{-R}^{R} \\frac{dx}{1 + x^2} + \\int_{C_R} \\frac{dz}{1 + z^2} $$\n当 $R \\to \\infty$ 时，沿半圆的积分趋于零（因为 $\\left|\\frac{1}{1 + z^2}\\right| \\sim \\frac{1}{R^2}$，而半圆长度是 $\\pi R$）。\n在上半平面内，只有 $z = i$ 一个极点。计算留数：\n$$ \\text{Res}{z=i} \\frac{1}{1 + z^2} = \\lim{z \\to i} (z - i) \\cdot \\frac{1}{(z - i)(z + i)} = \\frac{1}{2i} $$\n根据留数定理：\n$$ \\oint_{\\gamma} \\frac{dz}{1 + z^2} = 2\\pi i \\cdot \\frac{1}{2i} = \\pi $$\n因此：\n$$ \\int_{-\\infty}^{\\infty} \\frac{dx}{1 + x^2} = \\pi $$\n例 2：计算 $\\int_{-\\infty}^{\\infty} \\frac{\\cos x}{x^2 + 1} dx$ 这个积分看起来更加困难，但留数定理可以轻松处理。\n考虑复变函数 $f(z) = \\frac{e^{iz}}{z^2 + 1}$。我们注意到：\n$$ \\text{Re}\\left[ e^{ix} \\right] = \\cos x $$\n因此：\n$$ \\int_{-\\infty}^{\\infty} \\frac{\\cos x}{x^2 + 1} dx = \\text{Re} \\left[ \\int_{-\\infty}^{\\infty} \\frac{e^{ix}}{x^2 + 1} dx \\right] $$\n同样的，我们构造上半平面的半圆形闭合曲线。当 $R \\to \\infty$ 时，沿半圆的积分趋于零（这里需要用到 Jordan 引理）。\n在上半平面内，$f(z) = \\frac{e^{iz}}{z^2 + 1}$ 有一个极点 $z = i$。计算留数：\n$$ \\text{Res}{z=i} \\frac{e^{iz}}{z^2 + 1} = \\lim{z \\to i} (z - i) \\cdot \\frac{e^{iz}}{(z - i)(z + i)} = \\frac{e^{i \\cdot i}}{2i} = \\frac{e^{-1}}{2i} $$\n根据留数定理：\n$$ \\oint_{\\gamma} \\frac{e^{iz}}{z^2 + 1} dz = 2\\pi i \\cdot \\frac{e^{-1}}{2i} = \\pi e^{-1} $$\n因此：\n$$ \\int_{-\\infty}^{\\infty} \\frac{e^{ix}}{x^2 + 1} dx = \\pi e^{-1} $$\n取实部：\n$$ \\int_{-\\infty}^{\\infty} \\frac{\\cos x}{x^2 + 1} dx = \\pi e^{-1} = \\frac{\\pi}{e} $$\n这个结果非常优雅，用实数方法很难获得。\n例 3：计算 $\\int_0^{\\infty} \\frac{x^{a-1}}{1 + x} dx$（$0 \u003c a \u003c 1$） 这是一个更加复杂的积分，被称为欧拉第一类积分。我们可以用留数定理结合分支切割的方法来求解。\n考虑复变函数 $f(z) = \\frac{z^{a-1}}{1 + z}$。由于涉及分数幂次，我们需要在复平面上进行分支切割。通常选择沿负实轴切割。\n我们构造一个\"钥匙孔\"形状的闭合曲线，由以下部分组成：\n上沿负实轴从 $-R$ 到 $-\\varepsilon$ 小圆 $C_\\varepsilon$ 绕原点 下沿负实轴从 $-\\varepsilon$ 到 $-R$ 大圆 $C_R$ 绕原点 通过分析各部分的积分，并利用留数定理，最终可以得到：\n$$ \\int_0^{\\infty} \\frac{x^{a-1}}{1 + x} dx = \\frac{\\pi}{\\sin(\\pi a)} $$\n这个结果在数学和物理中都有广泛应用。\n留数定理的其他应用 除了计算实数积分，留数定理还有许多其他重要应用：\n1. 级数求和 留数定理可以用来求某些级数的和。例如，对于级数 $\\sum_{n=-\\infty}^{\\infty} \\frac{1}{n^2 + a^2}$，可以通过构造适当的辅助函数和围道来计算。\n2. 物理中的应用 在量子场论、统计物理、电磁学等领域，留数定理被广泛应用于计算各种积分和级数。特别是在计算格林函数、配分函数等物理量时，留数定理是不可或缺的工具。\n3. 信号处理 在信号处理和控制理论中，留数定理用于分析系统的稳定性、计算系统的频率响应等。\n4. 数值计算 留数定理为某些数值积分方法提供了理论基础，特别是在计算奇异积分时。\n总结 留数定理是复变函数理论中的一颗明珠。它将复杂的积分问题转化为简洁的代数计算，展现了数学的统一性和优雅性。\n从柯西积分定理到洛朗级数，再到留数定理，我们看到了数学概念的层层递进。每一个概念都是下一个概念的基础，这种结构化的思维方式正是数学的魅力所在。\n留数定理不仅是一个强大的计算工具，它还深刻地揭示了复变函数的内在结构。通过留数，我们可以窥见函数在奇点附近的行为，理解局部与整体之间的联系。\n从实用的角度来看，留数定理让我们能够解决许多在实数域中极其困难的积分问题。在物理学、工程学、金融学等领域，留数定理都有着广泛的应用。\n最重要的是，留数定理展示了数学思维的威力。通过扩展问题的范围（从实数到复数），我们能够获得更加深刻、更加优美的解决方案。这种\"迂回前进\"的思维方式，正是解决复杂问题的重要策略。\n正如数学家阿达马所说：“实数域中两个真理之间的最短路径是通过复数域。“留数定理正是这句话的最好体现。\n","wordCount":"935","inLanguage":"en","image":"https://s-ai-unix.github.io/images/covers/residue-theorem-cover.jpg","datePublished":"2026-01-24T10:54:00+08:00","dateModified":"2026-01-24T10:54:00+08:00","author":{"@type":"Person","name":"s-ai-unix"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s-ai-unix.github.io/posts/2026-01-24-residue-theorem-guide/"},"publisher":{"@type":"Organization","name":"s-ai-unix's Blog","logo":{"@type":"ImageObject","url":"https://s-ai-unix.github.io/favicon.ico"}}}</script><link rel=stylesheet href=https://s-ai-unix.github.io/css/classical-quote.css></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://s-ai-unix.github.io/ accesskey=h title="s-ai-unix's Blog (Alt + H)">s-ai-unix's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://s-ai-unix.github.io/ title="🏠 首页"><span>🏠 首页</span></a></li><li><a href=https://s-ai-unix.github.io/posts/ title="📚 文章"><span>📚 文章</span></a></li><li><a href=https://s-ai-unix.github.io/archives/ title="📁 归档"><span>📁 归档</span></a></li><li><a href=https://s-ai-unix.github.io/tags/ title="🏷️ 标签"><span>🏷️ 标签</span></a></li><li><a href=https://s-ai-unix.github.io/search/ title="🔍 搜索 (Alt + /)" accesskey=/><span>🔍 搜索</span></a></li><li><a href=https://s-ai-unix.github.io/about/ title="👤 关于"><span>👤 关于</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://s-ai-unix.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://s-ai-unix.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">留数定理：复变函数的神奇积分</h1><div class=post-description>从实数积分的难题到复变函数的优雅解法，深入浅出地介绍留数定理的背景、推导与应用。</div><div class=post-meta><span title='2026-01-24 10:54:00 +0800 CST'>January 24, 2026</span>&nbsp;·&nbsp;<span>5 min</span>&nbsp;·&nbsp;<span>935 words</span>&nbsp;·&nbsp;<span>s-ai-unix</span></div></header><figure class=entry-cover><a href=https://s-ai-unix.github.io/images/covers/residue-theorem-cover.jpg target=_blank rel="noopener noreferrer"><img loading=eager src=https://s-ai-unix.github.io/images/covers/residue-theorem-cover.jpg alt=抽象几何图形></a><figcaption>复平面上的优雅</figcaption></figure><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e5%bc%95%e8%a8%80%e4%b8%80%e4%b8%aa%e6%a3%98%e6%89%8b%e7%9a%84%e7%a7%af%e5%88%86%e9%97%ae%e9%a2%98 aria-label=引言：一个棘手的积分问题>引言：一个棘手的积分问题</a></li><li><a href=#%e5%8e%86%e5%8f%b2%e8%83%8c%e6%99%af%e4%bb%8e%e6%ac%a7%e6%8b%89%e5%88%b0%e6%9f%af%e8%a5%bf aria-label=历史背景：从欧拉到柯西>历史背景：从欧拉到柯西</a></li><li><a href=#%e5%a4%8d%e6%95%b0%e7%a7%af%e5%88%86%e5%9f%ba%e7%a1%80 aria-label=复数积分基础>复数积分基础</a><ul><li><a href=#%e5%a4%8d%e5%8f%98%e5%87%bd%e6%95%b0 aria-label=复变函数>复变函数</a></li><li><a href=#%e8%a7%a3%e6%9e%90%e5%87%bd%e6%95%b0 aria-label=解析函数>解析函数</a></li><li><a href=#%e5%a4%8d%e6%95%b0%e7%a7%af%e5%88%86 aria-label=复数积分>复数积分</a></li></ul></li><li><a href=#%e6%9f%af%e8%a5%bf%e7%a7%af%e5%88%86%e5%ae%9a%e7%90%86 aria-label=柯西积分定理>柯西积分定理</a><ul><li><a href=#%e5%ae%9a%e7%90%86%e8%a1%a8%e8%bf%b0 aria-label=定理表述>定理表述</a></li><li><a href=#%e5%87%a0%e4%bd%95%e7%9b%b4%e8%a7%82 aria-label=几何直观>几何直观</a></li><li><a href=#%e6%9f%af%e8%a5%bf%e7%a7%af%e5%88%86%e5%85%ac%e5%bc%8f aria-label=柯西积分公式>柯西积分公式</a></li></ul></li><li><a href=#%e6%b4%9b%e6%9c%97%e7%ba%a7%e6%95%b0 aria-label=洛朗级数>洛朗级数</a><ul><li><a href=#%e6%b3%b0%e5%8b%92%e7%ba%a7%e6%95%b0%e7%9a%84%e5%b1%80%e9%99%90 aria-label=泰勒级数的局限>泰勒级数的局限</a></li><li><a href=#%e6%b4%9b%e6%9c%97%e7%ba%a7%e6%95%b0-1 aria-label=洛朗级数>洛朗级数</a></li><li><a href=#%e6%b4%9b%e6%9c%97%e7%ba%a7%e6%95%b0%e7%9a%84%e5%88%86%e8%a7%a3 aria-label=洛朗级数的分解>洛朗级数的分解</a></li></ul></li><li><a href=#%e7%95%99%e6%95%b0%e5%ae%9a%e7%90%86 aria-label=留数定理>留数定理</a><ul><li><a href=#%e7%95%99%e6%95%b0%e7%9a%84%e5%ae%9a%e4%b9%89 aria-label=留数的定义>留数的定义</a></li><li><a href=#%e7%95%99%e6%95%b0%e5%ae%9a%e7%90%86%e7%9a%84%e8%a1%a8%e8%bf%b0 aria-label=留数定理的表述>留数定理的表述</a></li><li><a href=#%e7%95%99%e6%95%b0%e5%ae%9a%e7%90%86%e7%9a%84%e6%8e%a8%e5%af%bc aria-label=留数定理的推导>留数定理的推导</a></li><li><a href=#%e7%95%99%e6%95%b0%e7%9a%84%e8%ae%a1%e7%ae%97%e6%96%b9%e6%b3%95 aria-label=留数的计算方法>留数的计算方法</a><ul><li><a href=#1-%e5%8d%95%e6%9e%81%e7%82%b9%e7%9a%84%e6%83%85%e5%86%b5 aria-label="1. 单极点的情况">1. 单极点的情况</a></li><li><a href=#2-%e9%ab%98%e9%98%b6%e6%9e%81%e7%82%b9%e7%9a%84%e6%83%85%e5%86%b5 aria-label="2. 高阶极点的情况">2. 高阶极点的情况</a></li><li><a href=#3-%e6%b4%9b%e6%9c%97%e7%ba%a7%e6%95%b0%e5%b1%95%e5%bc%80%e6%b3%95 aria-label="3. 洛朗级数展开法">3. 洛朗级数展开法</a></li></ul></li><li><a href=#%e7%95%99%e6%95%b0%e7%9a%84%e5%87%a0%e4%bd%95%e7%9b%b4%e8%a7%82 aria-label=留数的几何直观>留数的几何直观</a></li></ul></li><li><a href=#%e5%ba%94%e7%94%a8%e5%ae%9e%e4%be%8b aria-label=应用实例>应用实例</a><ul><li><a href=#%e4%be%8b-1%e8%ae%a1%e7%ae%97%e5%ae%9e%e6%95%b0%e7%a7%af%e5%88%86-int_-inftyinfty-fracdx1--x2 aria-label="例 1：计算实数积分 $\int_{-\infty}^{\infty} \frac{dx}{1 + x^2}$">例 1：计算实数积分 $\int_{-\infty}^{\infty} \frac{dx}{1 + x^2}$</a></li><li><a href=#%e4%be%8b-2%e8%ae%a1%e7%ae%97-int_-inftyinfty-fraccos-xx2--1-dx aria-label="例 2：计算 $\int_{-\infty}^{\infty} \frac{\cos x}{x^2 + 1} dx$">例 2：计算 $\int_{-\infty}^{\infty} \frac{\cos x}{x^2 + 1} dx$</a></li><li><a href=#%e4%be%8b-3%e8%ae%a1%e7%ae%97-int_0infty-fracxa-11--x-dx0--a--1 aria-label="例 3：计算 $\int_0^{\infty} \frac{x^{a-1}}{1 + x} dx$（$0 < a < 1$）">例 3：计算 $\int_0^{\infty} \frac{x^{a-1}}{1 + x} dx$（$0 &lt; a &lt; 1$）</a></li></ul></li><li><a href=#%e7%95%99%e6%95%b0%e5%ae%9a%e7%90%86%e7%9a%84%e5%85%b6%e4%bb%96%e5%ba%94%e7%94%a8 aria-label=留数定理的其他应用>留数定理的其他应用</a><ul><li><a href=#1-%e7%ba%a7%e6%95%b0%e6%b1%82%e5%92%8c aria-label="1. 级数求和">1. 级数求和</a></li><li><a href=#2-%e7%89%a9%e7%90%86%e4%b8%ad%e7%9a%84%e5%ba%94%e7%94%a8 aria-label="2. 物理中的应用">2. 物理中的应用</a></li><li><a href=#3-%e4%bf%a1%e5%8f%b7%e5%a4%84%e7%90%86 aria-label="3. 信号处理">3. 信号处理</a></li><li><a href=#4-%e6%95%b0%e5%80%bc%e8%ae%a1%e7%ae%97 aria-label="4. 数值计算">4. 数值计算</a></li></ul></li><li><a href=#%e6%80%bb%e7%bb%93 aria-label=总结>总结</a></li></ul></div></details></div><div class=post-content><h2 id=引言一个棘手的积分问题>引言：一个棘手的积分问题<a hidden class=anchor aria-hidden=true href=#引言一个棘手的积分问题>#</a></h2><p>在微积分课程中，我们经常遇到各种有趣的积分问题。有些积分可以通过基本的积分技巧轻松解决，比如分部积分、换元法等。但有些积分却非常棘手，让人绞尽脑汁。</p><p>让我们从一个经典的例子开始：</p><p>$$ \int_{-\infty}^{\infty} \frac{dx}{1 + x^2} $$</p><p>这个积分看起来并不复杂，被积函数 $\frac{1}{1 + x^2}$ 在整个实数轴上都连续且趋于零。但是，如果我们试图用常规的微积分方法来求解，会发现这并不是一件容易的事情。</p><p>当然，如果你熟悉基本的微积分技巧，可能会想到使用反正切函数的原函数 $\arctan x$。但这只是一种特殊的情况。如果我们将问题稍微复杂化，比如考虑下面的积分：</p><p>$$ \int_{-\infty}^{\infty} \frac{\cos x}{x^2 + 1} dx $$</p><p>这个积分就更加困难了。被积函数 $\frac{\cos x}{x^2 + 1}$ 并没有明显的原函数，分部积分也无法直接应用。</p><p>面对这样的难题，数学家们发现了一个惊人的方法：将实数问题扩展到复数域中。通过复变函数的工具，许多看似困难的实数积分问题变得优雅而简洁。而留数定理正是复变函数中最强大的工具之一。</p><h2 id=历史背景从欧拉到柯西>历史背景：从欧拉到柯西<a hidden class=anchor aria-hidden=true href=#历史背景从欧拉到柯西>#</a></h2><p>复变函数理论的发展是数学史上一个辉煌的篇章。早在 18 世纪，欧拉（Leonhard Euler）就开始研究复数和复变函数，但他更多地将复数作为一种计算工具，而不是深入研究其结构。</p><p>真正开创复变函数理论的功臣是柯西（Augustin-Louis Cauchy，1789-1857）。这位法国数学家在 19 世纪上半叶做出了许多开创性的工作，其中最著名的包括柯西积分定理、柯西积分公式，以及我们今天要讨论的留数定理。</p><p>柯西的工作不仅仅是技巧性的，更是概念性的。他深刻地理解了解析函数的性质，并发现了复数积分与解析函数性质之间的深刻联系。他的工作为后来整个复变函数理论奠定了基础。</p><p>与柯西同时代，德国数学家魏尔斯特拉斯（Karl Weierstrass）则从另一个角度——幂级数——来研究复变函数。这两种方法各有优势，后来被证明是完全等价的。</p><p>留数定理的发展正是建立在柯西积分定理和洛朗级数（由法国数学家洛朗提出）的基础之上。它将积分问题转化为代数问题，使得许多复杂的计算变得简单而优雅。</p><h2 id=复数积分基础>复数积分基础<a hidden class=anchor aria-hidden=true href=#复数积分基础>#</a></h2><p>在深入留数定理之前，我们需要先了解一些复变函数和复数积分的基础知识。</p><h3 id=复变函数>复变函数<a hidden class=anchor aria-hidden=true href=#复变函数>#</a></h3><p>复变函数是从复数域到复数域的映射。如果我们用 $z = x + iy$ 表示复数，其中 $x$ 和 $y$ 是实数，$i$ 是虚数单位（满足 $i^2 = -1$），那么复变函数可以表示为：</p><p>$$ f(z) = u(x, y) + i v(x, y) $$</p><p>其中 $u(x, y)$ 和 $v(x, y)$ 都是实值函数。</p><p><img alt=复平面 loading=lazy src=/images/math/complex-plane.png></p><p><strong>图 1</strong>：复平面上的点表示复数 $z = x + iy$</p><h3 id=解析函数>解析函数<a hidden class=anchor aria-hidden=true href=#解析函数>#</a></h3><p>复变函数理论中最核心的概念是解析函数。一个复变函数 $f(z)$ 在某个区域内解析，如果它在该区域内每一点都可导。</p><p>但是，复变函数的可导性比实变函数要强得多。对于一个复变函数 $f(z) = u(x, y) + i v(x, y)$，它在某点可导的必要条件是：</p><p>$$ \frac{\partial u}{\partial x} = \frac{\partial v}{\partial y}, \quad \frac{\partial u}{\partial y} = -\frac{\partial v}{\partial x} $$</p><p>这两个方程被称为<strong>柯西-黎曼方程</strong>。它们是解析函数的核心特征，深刻地反映了复变函数的特殊性质。</p><p>柯西-黎曼方程的几何意义是：解析函数在局部是保角的映射。也就是说，解析函数保持角度不变，这是复变函数许多美妙性质的基础。</p><h3 id=复数积分>复数积分<a hidden class=anchor aria-hidden=true href=#复数积分>#</a></h3><p>复数积分可以类比实数积分来定义。如果我们有一个连续的复变函数 $f(z)$ 和一条从点 $a$ 到点 $b$ 的曲线 $\gamma$，那么 $f(z)$ 沿曲线 $\gamma$ 的积分定义为：</p><p>$$ \int_{\gamma} f(z) dz = \lim_{n \to \infty} \sum_{j=1}^{n} f(z_j) (z_j - z_{j-1}) $$</p><p>其中 $z_0 = a, z_n = b$，而 $z_j$ 是曲线上的点。</p><p>这个定义看起来有些抽象，但它与实数积分的定义是完全类似的。区别在于，这里的路径 $\gamma$ 是复平面上的曲线，而 $dz$ 也是复数。</p><h2 id=柯西积分定理>柯西积分定理<a hidden class=anchor aria-hidden=true href=#柯西积分定理>#</a></h2><p>柯西积分定理是复变函数理论中最基本的定理之一，它揭示了复数积分的一个重要性质。</p><h3 id=定理表述>定理表述<a hidden class=anchor aria-hidden=true href=#定理表述>#</a></h3><p><strong>柯西积分定理</strong>：如果 $f(z)$ 在单连通区域 $D$ 内解析，$\gamma$ 是 $D$ 内的一条闭合曲线，那么：</p><p>$$ \oint_{\gamma} f(z) dz = 0 $$</p><p>这个定理的表述非常简洁，但它的含义却非常深刻。它告诉我们，解析函数沿闭合路径的积分恒为零。这与实数积分形成了鲜明对比——在实数情况下，只有当被积函数有原函数时，闭合路径积分才为零。</p><h3 id=几何直观>几何直观<a hidden class=anchor aria-hidden=true href=#几何直观>#</a></h3><p>柯西积分定理的几何直观来源于解析函数的局部性质。由于解析函数在局部可以近似为线性变换，而且这种变换保持角度（保角性），因此当我们沿着闭合路径积分时，各个部分的贡献会相互抵消。</p><p>想象一下你在复平面上沿着一个闭合路径行走，计算每一步的 $f(z) dz$。由于函数是解析的，这种"旋转"和"伸缩"会相互抵消，最终的总和为零。</p><h3 id=柯西积分公式>柯西积分公式<a hidden class=anchor aria-hidden=true href=#柯西积分公式>#</a></h3><p>柯西积分定理的一个重要推论是柯西积分公式。这个公式让我们可以通过函数在边界上的值来确定函数在内部任意点的值。</p><p><strong>柯西积分公式</strong>：如果 $f(z)$ 在区域 $D$ 内解析，$\gamma$ 是 $D$ 内包围点 $a$ 的简单闭合曲线，那么：</p><p>$$ f(a) = \frac{1}{2\pi i} \oint_{\gamma} \frac{f(z)}{z - a} dz $$</p><p>这个公式非常强大，它告诉我们，一个解析函数在内部某点的值完全由它在边界上的行为决定。这在某种程度上类似于物理中的场论——边界条件决定了内部的状态。</p><p>柯西积分公式的一个重要应用是计算积分。例如，如果我们想要计算 $\oint_{\gamma} \frac{dz}{z - a}$，其中 $\gamma$ 包围 $a$，那么根据柯西积分公式（取 $f(z) = 1$），我们有：</p><p>$$ \oint_{\gamma} \frac{dz}{z - a} = 2\pi i $$</p><p>这个结果在后面的讨论中会非常重要。</p><h2 id=洛朗级数>洛朗级数<a hidden class=anchor aria-hidden=true href=#洛朗级数>#</a></h2><p>在讨论留数定理之前，我们还需要了解洛朗级数。洛朗级数是泰勒级数在有奇点情况下的推广。</p><h3 id=泰勒级数的局限>泰勒级数的局限<a hidden class=anchor aria-hidden=true href=#泰勒级数的局限>#</a></h3><p>我们知道，如果一个函数在某点 $z_0$ 解析，那么它可以展开为泰勒级数：</p><p>$$ f(z) = \sum_{n=0}^{\infty} \frac{f^{(n)}(z_0)}{n!} (z - z_0)^n $$</p><p>这个级数在以 $z_0$ 为中心的某个圆内收敛。但是，如果函数在 $z_0$ 点有奇点（即函数在该点无定义或不可导），那么泰勒级数就失效了。</p><h3 id=洛朗级数-1>洛朗级数<a hidden class=anchor aria-hidden=true href=#洛朗级数-1>#</a></h3><p>洛朗级数解决了这个问题。它在泰勒级数的基础上增加了负幂次项，使得函数可以在环形区域内展开。</p><p><strong>洛朗级数</strong>：如果函数 $f(z)$ 在环形区域 $r &lt; |z - z_0| &lt; R$ 内解析（$z_0$ 是函数的孤立奇点），那么它可以展开为：</p><p>$$ f(z) = \sum_{n=-\infty}^{\infty} c_n (z - z_0)^n = \cdots + \frac{c_{-2}}{(z - z_0)^2} + \frac{c_{-1}}{z - z_0} + c_0 + c_1 (z - z_0) + \cdots $$</p><p>其中系数为：</p><p>$$ c_n = \frac{1}{2\pi i} \oint_{\gamma} \frac{f(z)}{(z - z_0)^{n+1}} dz $$</p><p>这里 $\gamma$ 是环形区域内任意的简单闭合曲线，包围 $z_0$。</p><p><img alt=洛朗级数收敛域 loading=lazy src=/images/math/laurent-series-region.png></p><p><strong>图 2</strong>：洛朗级数的环形收敛域</p><h3 id=洛朗级数的分解>洛朗级数的分解<a hidden class=anchor aria-hidden=true href=#洛朗级数的分解>#</a></h3><p>洛朗级数可以分解为两部分：</p><ol><li><p><strong>主要部分</strong>（Principal Part）：包含负幂次项 $\sum_{n=1}^{\infty} \frac{c_{-n}}{(z - z_0)^n}$，描述了函数在奇点附近的行为。</p></li><li><p><strong>解析部分</strong>（Analytic Part）：包含非负幂次项 $\sum_{n=0}^{\infty} c_n (z - z_0)^n$，在环形区域内解析。</p></li></ol><p>这个分解对于理解函数在奇点附近的行为非常重要。主要部分中负幂次项的个数决定了奇点的类型：</p><ul><li>如果主要部分为零，$z_0$ 是可去奇点</li><li>如果主要部分只有有限项，$z_0$ 是极点</li><li>如果主要部分有无穷多项，$z_0$ 是本性奇点</li></ul><h2 id=留数定理>留数定理<a hidden class=anchor aria-hidden=true href=#留数定理>#</a></h2><p>现在我们终于要介绍留数定理了。留数定理是复变函数理论中最强大的工具之一，它将复数积分问题转化为代数问题。</p><h3 id=留数的定义>留数的定义<a hidden class=anchor aria-hidden=true href=#留数的定义>#</a></h3><p>在洛朗级数展开中，我们特别关注系数 $c_{-1}$，即 $(z - z_0)^{-1}$ 项的系数。这个系数有一个特殊的名称——<strong>留数</strong>（Residue）。</p><p><strong>留数的定义</strong>：如果函数 $f(z)$ 在 $z_0$ 点有孤立奇点，那么 $f(z)$ 在 $z_0$ 点的留数记为 $\text{Res}[f(z), z_0]$ 或 $\text{Res}_{z=z_0} f(z)$，它是洛朗级数中 $(z - z_0)^{-1}$ 项的系数：</p><p>$$ \text{Res}<em>{z=z_0} f(z) = c</em>{-1} = \frac{1}{2\pi i} \oint_{\gamma} f(z) dz $$</p><p>其中 $\gamma$ 是围绕 $z_0$ 的一条简单闭合曲线，不包含其他奇点。</p><p>为什么留数如此重要？因为在洛朗级数中，只有 $(z - z_0)^{-1}$ 项的积分不为零！其他所有项的积分都是零：</p><p>$$ \oint_{\gamma} (z - z_0)^n dz = 0 \quad (n \neq -1) $$</p><p>$$ \oint_{\gamma} \frac{dz}{z - z_0} = 2\pi i $$</p><p>这意味着，当我们沿着闭合路径积分时，只有留数对积分有贡献。</p><h3 id=留数定理的表述>留数定理的表述<a hidden class=anchor aria-hidden=true href=#留数定理的表述>#</a></h3><p><strong>留数定理</strong>：如果函数 $f(z)$ 在闭合曲线 $\gamma$ 内部有有限个孤立奇点 $z_1, z_2, \ldots, z_n$，在 $\gamma$ 上连续，那么：</p><p>$$ \oint_{\gamma} f(z) dz = 2\pi i \sum_{k=1}^{n} \text{Res}_{z=z_k} f(z) $$</p><p>这就是留数定理的完整表述。它告诉我们，闭合路径上的积分等于 $2\pi i$ 乘以路径内部所有留数的和。</p><p><img alt=围道积分路径 loading=lazy src=/images/math/contour-integral.png></p><p><strong>图 3</strong>：围道积分路径与奇点</p><h3 id=留数定理的推导>留数定理的推导<a hidden class=anchor aria-hidden=true href=#留数定理的推导>#</a></h3><p>现在让我们从柯西积分定理出发，推导留数定理。</p><p>设函数 $f(z)$ 在闭合曲线 $\gamma$ 内部有有限个孤立奇点 $z_1, z_2, \ldots, z_n$。对于每个奇点 $z_k$，我们构造一个很小的圆周 $\gamma_k$ 包围 $z_k$，使得这些小圆周彼此不相交，并且都位于 $\gamma$ 的内部。</p><p>根据柯西积分定理的推广形式（变形定理），我们有：</p><p>$$ \oint_{\gamma} f(z) dz = \sum_{k=1}^{n} \oint_{\gamma_k} f(z) dz $$</p><p>这个等式说明，沿大曲线的积分等于沿所有小曲线积分的和。</p><p>现在，对于每个小曲线 $\gamma_k$，我们利用洛朗级数展开：</p><p>$$ f(z) = \sum_{m=-\infty}^{\infty} c_m^{(k)} (z - z_k)^m $$</p><p>其中 $c_m^{(k)}$ 是围绕 $z_k$ 展开的洛朗级数的系数。</p><p>沿 $\gamma_k$ 积分：</p><p>$$ \oint_{\gamma_k} f(z) dz = \sum_{m=-\infty}^{\infty} c_m^{(k)} \oint_{\gamma_k} (z - z_k)^m dz $$</p><p>注意到：</p><p>$$ \oint_{\gamma_k} (z - z_k)^m dz = \begin{cases} 2\pi i, & m = -1 \\ 0, & m \neq -1 \end{cases} $$</p><p>因此，只有 $m = -1$ 的项对积分有贡献：</p><p>$$ \oint_{\gamma_k} f(z) dz = c_{-1}^{(k)} \cdot 2\pi i = 2\pi i \cdot \text{Res}_{z=z_k} f(z) $$</p><p>将所有小曲线的积分加起来，得到：</p><p>$$ \oint_{\gamma} f(z) dz = \sum_{k=1}^{n} 2\pi i \cdot \text{Res}<em>{z=z_k} f(z) = 2\pi i \sum</em>{k=1}^{n} \text{Res}_{z=z_k} f(z) $$</p><p>这就完成了留数定理的推导！</p><h3 id=留数的计算方法>留数的计算方法<a hidden class=anchor aria-hidden=true href=#留数的计算方法>#</a></h3><p>在实际应用中，我们需要计算函数在各种奇点处的留数。以下是几种常见情况下的计算方法：</p><h4 id=1-单极点的情况>1. 单极点的情况<a hidden class=anchor aria-hidden=true href=#1-单极点的情况>#</a></h4><p>如果 $z_0$ 是 $f(z)$ 的单极点（一阶极点），那么：</p><p>$$ \text{Res}<em>{z=z_0} f(z) = \lim</em>{z \to z_0} (z - z_0) f(z) $$</p><p>特别地，如果 $f(z) = \frac{g(z)}{h(z)}$，其中 $g(z_0) \neq 0$，$h(z_0) = 0$，$h&rsquo;(z_0) \neq 0$，那么：</p><p>$$ \text{Res}_{z=z_0} f(z) = \frac{g(z_0)}{h&rsquo;(z_0)} $$</p><h4 id=2-高阶极点的情况>2. 高阶极点的情况<a hidden class=anchor aria-hidden=true href=#2-高阶极点的情况>#</a></h4><p>如果 $z_0$ 是 $m$ 阶极点，那么：</p><p>$$ \text{Res}<em>{z=z_0} f(z) = \frac{1}{(m-1)!} \lim</em>{z \to z_0} \frac{d^{m-1}}{dz^{m-1}} \left[ (z - z_0)^m f(z) \right] $$</p><h4 id=3-洛朗级数展开法>3. 洛朗级数展开法<a hidden class=anchor aria-hidden=true href=#3-洛朗级数展开法>#</a></h4><p>对于复杂的情况，我们可以直接进行洛朗级数展开，找到 $(z - z_0)^{-1}$ 项的系数。</p><h3 id=留数的几何直观>留数的几何直观<a hidden class=anchor aria-hidden=true href=#留数的几何直观>#</a></h3><p><img alt=留数可视化 loading=lazy src=/images/math/residue-visualization.png></p><p><strong>图 4</strong>：函数 $f(z) = \frac{1}{z-1}$ 在奇点附近的行为</p><p>留数有一个直观的几何解释。想象你在复平面上围绕一个奇点行走，记录函数值的"累积旋转"。这个累积旋转的量度就是留数。</p><p>如果留数为零，函数在该点的行为相对"温和"。如果留数非零，函数在该点会产生显著的"旋转效应"。</p><h2 id=应用实例>应用实例<a hidden class=anchor aria-hidden=true href=#应用实例>#</a></h2><p>留数定理的强大之处在于它能够解决许多看似困难的积分问题。让我们通过几个经典例子来展示留数定理的应用。</p><h3 id=例-1计算实数积分-int_-inftyinfty-fracdx1--x2>例 1：计算实数积分 $\int_{-\infty}^{\infty} \frac{dx}{1 + x^2}$<a hidden class=anchor aria-hidden=true href=#例-1计算实数积分-int_-inftyinfty-fracdx1--x2>#</a></h3><p>这是一个经典的积分，其值为 $\pi$。现在我们用留数定理来求解。</p><p>考虑复变函数 $f(z) = \frac{1}{1 + z^2}$。这个函数有两个一阶极点：$z = i$ 和 $z = -i$。</p><p>我们构造一个半圆形的闭合曲线 $\gamma$，由实轴上从 $-R$ 到 $R$ 的线段和上半平面的半圆 $C_R$ 组成。</p><p>$$ \oint_{\gamma} \frac{dz}{1 + z^2} = \int_{-R}^{R} \frac{dx}{1 + x^2} + \int_{C_R} \frac{dz}{1 + z^2} $$</p><p>当 $R \to \infty$ 时，沿半圆的积分趋于零（因为 $\left|\frac{1}{1 + z^2}\right| \sim \frac{1}{R^2}$，而半圆长度是 $\pi R$）。</p><p>在上半平面内，只有 $z = i$ 一个极点。计算留数：</p><p>$$ \text{Res}<em>{z=i} \frac{1}{1 + z^2} = \lim</em>{z \to i} (z - i) \cdot \frac{1}{(z - i)(z + i)} = \frac{1}{2i} $$</p><p>根据留数定理：</p><p>$$ \oint_{\gamma} \frac{dz}{1 + z^2} = 2\pi i \cdot \frac{1}{2i} = \pi $$</p><p>因此：</p><p>$$ \int_{-\infty}^{\infty} \frac{dx}{1 + x^2} = \pi $$</p><h3 id=例-2计算-int_-inftyinfty-fraccos-xx2--1-dx>例 2：计算 $\int_{-\infty}^{\infty} \frac{\cos x}{x^2 + 1} dx$<a hidden class=anchor aria-hidden=true href=#例-2计算-int_-inftyinfty-fraccos-xx2--1-dx>#</a></h3><p>这个积分看起来更加困难，但留数定理可以轻松处理。</p><p>考虑复变函数 $f(z) = \frac{e^{iz}}{z^2 + 1}$。我们注意到：</p><p>$$ \text{Re}\left[ e^{ix} \right] = \cos x $$</p><p>因此：</p><p>$$ \int_{-\infty}^{\infty} \frac{\cos x}{x^2 + 1} dx = \text{Re} \left[ \int_{-\infty}^{\infty} \frac{e^{ix}}{x^2 + 1} dx \right] $$</p><p>同样的，我们构造上半平面的半圆形闭合曲线。当 $R \to \infty$ 时，沿半圆的积分趋于零（这里需要用到 Jordan 引理）。</p><p>在上半平面内，$f(z) = \frac{e^{iz}}{z^2 + 1}$ 有一个极点 $z = i$。计算留数：</p><p>$$ \text{Res}<em>{z=i} \frac{e^{iz}}{z^2 + 1} = \lim</em>{z \to i} (z - i) \cdot \frac{e^{iz}}{(z - i)(z + i)} = \frac{e^{i \cdot i}}{2i} = \frac{e^{-1}}{2i} $$</p><p>根据留数定理：</p><p>$$ \oint_{\gamma} \frac{e^{iz}}{z^2 + 1} dz = 2\pi i \cdot \frac{e^{-1}}{2i} = \pi e^{-1} $$</p><p>因此：</p><p>$$ \int_{-\infty}^{\infty} \frac{e^{ix}}{x^2 + 1} dx = \pi e^{-1} $$</p><p>取实部：</p><p>$$ \int_{-\infty}^{\infty} \frac{\cos x}{x^2 + 1} dx = \pi e^{-1} = \frac{\pi}{e} $$</p><p>这个结果非常优雅，用实数方法很难获得。</p><h3 id=例-3计算-int_0infty-fracxa-11--x-dx0--a--1>例 3：计算 $\int_0^{\infty} \frac{x^{a-1}}{1 + x} dx$（$0 &lt; a &lt; 1$）<a hidden class=anchor aria-hidden=true href=#例-3计算-int_0infty-fracxa-11--x-dx0--a--1>#</a></h3><p>这是一个更加复杂的积分，被称为欧拉第一类积分。我们可以用留数定理结合分支切割的方法来求解。</p><p>考虑复变函数 $f(z) = \frac{z^{a-1}}{1 + z}$。由于涉及分数幂次，我们需要在复平面上进行分支切割。通常选择沿负实轴切割。</p><p>我们构造一个"钥匙孔"形状的闭合曲线，由以下部分组成：</p><ul><li>上沿负实轴从 $-R$ 到 $-\varepsilon$</li><li>小圆 $C_\varepsilon$ 绕原点</li><li>下沿负实轴从 $-\varepsilon$ 到 $-R$</li><li>大圆 $C_R$ 绕原点</li></ul><p>通过分析各部分的积分，并利用留数定理，最终可以得到：</p><p>$$ \int_0^{\infty} \frac{x^{a-1}}{1 + x} dx = \frac{\pi}{\sin(\pi a)} $$</p><p>这个结果在数学和物理中都有广泛应用。</p><h2 id=留数定理的其他应用>留数定理的其他应用<a hidden class=anchor aria-hidden=true href=#留数定理的其他应用>#</a></h2><p>除了计算实数积分，留数定理还有许多其他重要应用：</p><h3 id=1-级数求和>1. 级数求和<a hidden class=anchor aria-hidden=true href=#1-级数求和>#</a></h3><p>留数定理可以用来求某些级数的和。例如，对于级数 $\sum_{n=-\infty}^{\infty} \frac{1}{n^2 + a^2}$，可以通过构造适当的辅助函数和围道来计算。</p><h3 id=2-物理中的应用>2. 物理中的应用<a hidden class=anchor aria-hidden=true href=#2-物理中的应用>#</a></h3><p>在量子场论、统计物理、电磁学等领域，留数定理被广泛应用于计算各种积分和级数。特别是在计算格林函数、配分函数等物理量时，留数定理是不可或缺的工具。</p><h3 id=3-信号处理>3. 信号处理<a hidden class=anchor aria-hidden=true href=#3-信号处理>#</a></h3><p>在信号处理和控制理论中，留数定理用于分析系统的稳定性、计算系统的频率响应等。</p><h3 id=4-数值计算>4. 数值计算<a hidden class=anchor aria-hidden=true href=#4-数值计算>#</a></h3><p>留数定理为某些数值积分方法提供了理论基础，特别是在计算奇异积分时。</p><h2 id=总结>总结<a hidden class=anchor aria-hidden=true href=#总结>#</a></h2><p>留数定理是复变函数理论中的一颗明珠。它将复杂的积分问题转化为简洁的代数计算，展现了数学的统一性和优雅性。</p><p>从柯西积分定理到洛朗级数，再到留数定理，我们看到了数学概念的层层递进。每一个概念都是下一个概念的基础，这种结构化的思维方式正是数学的魅力所在。</p><p>留数定理不仅是一个强大的计算工具，它还深刻地揭示了复变函数的内在结构。通过留数，我们可以窥见函数在奇点附近的行为，理解局部与整体之间的联系。</p><p>从实用的角度来看，留数定理让我们能够解决许多在实数域中极其困难的积分问题。在物理学、工程学、金融学等领域，留数定理都有着广泛的应用。</p><p>最重要的是，留数定理展示了数学思维的威力。通过扩展问题的范围（从实数到复数），我们能够获得更加深刻、更加优美的解决方案。这种"迂回前进"的思维方式，正是解决复杂问题的重要策略。</p><p>正如数学家阿达马所说：&ldquo;实数域中两个真理之间的最短路径是通过复数域。&ldquo;留数定理正是这句话的最好体现。</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://s-ai-unix.github.io/tags/%E7%95%99%E6%95%B0%E5%AE%9A%E7%90%86/>留数定理</a></li><li><a href=https://s-ai-unix.github.io/tags/%E5%A4%8D%E5%8F%98%E5%87%BD%E6%95%B0/>复变函数</a></li><li><a href=https://s-ai-unix.github.io/tags/%E7%A7%AF%E5%88%86/>积分</a></li><li><a href=https://s-ai-unix.github.io/tags/%E6%9F%AF%E8%A5%BF%E7%A7%AF%E5%88%86%E5%AE%9A%E7%90%86/>柯西积分定理</a></li><li><a href=https://s-ai-unix.github.io/tags/%E6%B4%9B%E6%9C%97%E7%BA%A7%E6%95%B0/>洛朗级数</a></li></ul><nav class=paginav><a class=prev href=https://s-ai-unix.github.io/posts/2026-01-24-liouville-theorem-guide/><span class=title>« Prev</span><br><span>刘维尔定理：有界整函数的唯一命运</span>
</a><a class=next href=https://s-ai-unix.github.io/posts/2026-01-24-cauchy-integral-formula/><span class=title>Next »</span><br><span>柯西积分公式：复变函数论中的明珠</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share 留数定理：复变函数的神奇积分 on x" href="https://x.com/intent/tweet/?text=%e7%95%99%e6%95%b0%e5%ae%9a%e7%90%86%ef%bc%9a%e5%a4%8d%e5%8f%98%e5%87%bd%e6%95%b0%e7%9a%84%e7%a5%9e%e5%a5%87%e7%a7%af%e5%88%86&amp;url=https%3a%2f%2fs-ai-unix.github.io%2fposts%2f2026-01-24-residue-theorem-guide%2f&amp;hashtags=%e7%95%99%e6%95%b0%e5%ae%9a%e7%90%86%2c%e5%a4%8d%e5%8f%98%e5%87%bd%e6%95%b0%2c%e7%a7%af%e5%88%86%2c%e6%9f%af%e8%a5%bf%e7%a7%af%e5%88%86%e5%ae%9a%e7%90%86%2c%e6%b4%9b%e6%9c%97%e7%ba%a7%e6%95%b0"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 留数定理：复变函数的神奇积分 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fs-ai-unix.github.io%2fposts%2f2026-01-24-residue-theorem-guide%2f&amp;title=%e7%95%99%e6%95%b0%e5%ae%9a%e7%90%86%ef%bc%9a%e5%a4%8d%e5%8f%98%e5%87%bd%e6%95%b0%e7%9a%84%e7%a5%9e%e5%a5%87%e7%a7%af%e5%88%86&amp;summary=%e7%95%99%e6%95%b0%e5%ae%9a%e7%90%86%ef%bc%9a%e5%a4%8d%e5%8f%98%e5%87%bd%e6%95%b0%e7%9a%84%e7%a5%9e%e5%a5%87%e7%a7%af%e5%88%86&amp;source=https%3a%2f%2fs-ai-unix.github.io%2fposts%2f2026-01-24-residue-theorem-guide%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 留数定理：复变函数的神奇积分 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fs-ai-unix.github.io%2fposts%2f2026-01-24-residue-theorem-guide%2f&title=%e7%95%99%e6%95%b0%e5%ae%9a%e7%90%86%ef%bc%9a%e5%a4%8d%e5%8f%98%e5%87%bd%e6%95%b0%e7%9a%84%e7%a5%9e%e5%a5%87%e7%a7%af%e5%88%86"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share 留数定理：复变函数的神奇积分 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fs-ai-unix.github.io%2fposts%2f2026-01-24-residue-theorem-guide%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li></ul></footer><script src=https://giscus.app/client.js data-repo=s-ai-unix/blog data-repo-id=R_kgDOQ3Njaw data-category=General data-category-id=DIC_kwDOQ3Nja84C0yve data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=zh-CN data-loading=lazy crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2026 <a href=https://s-ai-unix.github.io/>s-ai-unix's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>(function(){"use strict";function e(){var e=document.querySelectorAll("p, li, td, div, span, h1, h2, h3, h4, h5, h6, ol, ul");e.forEach(function(e){if(e.classList.contains("classical-quote-container")||e.classList.contains("quote-text")||e.closest(".classical-quote-container"))return;var t,n=e.innerHTML,s=!1;for(n.indexOf("<em>")!==-1&&(t=n.replace(/\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$/g,function(e,t,n,s){return/^[\d.,]+$/.test((t+n+s).replace(/[.,]/g,""))?e:"$"+t+"_"+n+s+"$"}),t=t.replace(/\$\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$\$/g,function(e,t,n,s){return"$$"+t+"_"+n+s+"$$"}),t!==n&&(n=t,s=!0)),n.indexOf("</em>")!==-1&&(t=n.replace(/\$([^$]*?)<\/em>([^$]*?)\$/g,function(e,t,n){return"$"+t+"_{"+n+"$"}),t=t.replace(/\$\$([^$]*?)<\/em>([^$]*?)\$\$/g,function(e,t,n){return"$$"+t+"_{"+n+"$$"}),t!==n&&(n=t,s=!0)),n.indexOf("<em>$")!==-1&&(t=n.replace(/<em>\$/g,"$"),t!==n&&(n=t,s=!0)),n.indexOf("</em>$")!==-1&&(t=n.replace(/<\/em>\$/g,"$"),t!==n&&(n=t,s=!0));n.indexOf("<em>")!==-1&&n.indexOf("</em>")!==-1;){if(t=n.replace(/\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$/g,function(e,t,n,s){return/^[\d.,]+$/.test((t+n+s).replace(/[.,]/g,""))?e:"$"+t+"_"+n+s+"$"}),t=t.replace(/\$\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$\$/g,function(e,t,n,s){return"$$"+t+"_"+n+s+"$$"}),t===n)break;n=t,s=!0}n.indexOf("_{")!==-1&&(t=n.replace(/_{/g,"_{"),t!==n&&(n=t,s=!0)),n.indexOf("}_")!==-1&&(t=n.replace(/}_/g,"}"),t!==n&&(n=t,s=!0)),n.includes("</em>{")&&(t=n.replace(/\\mathbf\{(W|x|y|z)\}<\/em>\{\\mathrm\{([a-z]+)\}\}/g,"\\mathbf{$1}_{\\mathrm{$2}}"),t=t.replace(/([LHf])<\/em>\{\\mathrm\{([a-z]+)\}\}/g,"$1_{\\mathrm{$2}}"),t=t.replace(/\\nabla ([LHf])<\/em>\{\\mathrm\{([a-z]+)\}\}/g,`\\nabla $1_{\\mathrm{$2}}`),t=t.replace(/([A-Z])<\/em>\{\\mathrm\{([a-z]+)\}\}/g,"$1_{\\mathrm{$2}}"),t!==n&&(n=t,s=!0)),n.includes("<em>{\\mathrm{")&&(t=n.replace(/\\mathbf\{(W|x|y|z)\}<em>\{\\mathrm\{([a-z]+)\}\}/g,"\\mathbf{$1}_{\\mathrm{$2}}"),t=t.replace(/([LHf])<em>\{\\mathrm\{([a-z]+)\}\}/g,"$1_{\\mathrm{$2}}"),t=t.replace(/\\nabla ([LHf])<em>\{\\mathrm\{([a-z]+)\}\}/g,`\\nabla $1_{\\mathrm{$2}}`),t=t.replace(/([A-Z])<em>\{\\mathrm\{([a-z]+)\}\}/g,"$1_{\\mathrm{$2}}"),t!==n&&(n=t,s=!0)),(n.includes("</em>")||n.includes("<em>"))&&(t=n.replace(/(\$[^$]*?)<em>([^$]*?)<\/em>/g,"$1_{$2}"),t=t.replace(/(\$\$[^$]*?)<em>([^$]*?)<\/em>/g,"$1_{$2}"),t=t.replace(/(\$[^$]*?)<em>/g,"$1"),t=t.replace(/<em>([^$]*?\$)/g,"$1"),t=t.replace(/(\$[^$]*?)<\/em>/g,"$1"),t=t.replace(/<\/em>([^$]*?\$)/g,"$1"),t!==n&&(n=t,s=!0)),n.indexOf("\\\\")!==-1&&(t=n.replace(/(\$\{1,2\})([^$]*?)(\$\{1,2\})/g,function(e,t,n,s){for(;n.indexOf("\\\\")!==-1;)n=n.replace(/\\\\/g,"\\");return t+n+s}),t!==n&&(n=t,s=!0)),s&&(e.innerHTML=n)})}window.MathJax={tex:{inlineMath:[["$","$"]],displayMath:[["$$","$$"]],processEscapes:!0,processEnvironments:!0,tags:"ams",packages:{"[+]":["noerrors","noundefined","boldsymbol"]},macros:{oiint:"\\mathop{∯}",oiiint:"\\mathop{∰}"}},options:{skipHtmlTags:["script","noscript","style","textarea","pre","code"]},startup:{pageReady:function(){return e(),MathJax.startup.defaultPageReady().then(function(){console.log("MathJax formulas rendered successfully")})}}}})()</script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link rel=stylesheet href=/css/mermaid-custom.css><script src=/js/mermaid-converter.js></script><script type=module>
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';

  
  setTimeout(() => {
    mermaid.initialize({
      startOnLoad: true,
      theme: 'base',
      themeVariables: {
        primaryColor: '#e3f2fd',
        primaryTextColor: '#1565c0',
        primaryBorderColor: '#2196f3',
        lineColor: '#42a5f5',
        secondaryColor: '#f3e5f5',
        tertiaryColor: '#fff9c4',
        background: '#ffffff',
        mainBkg: '#ffffff',
        nodeBorder: '#2196f3',
        clusterBkg: '#ffffff',
        clusterBorder: '#e0e0e0',
        titleColor: '#1565c0',
        edgeLabelBackground: '#fafafa',
      },
      securityLevel: 'loose',
    });
  }, 100);
</script><script src=/js/toc.js></script><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script>(function(){"use strict";function e(){var e=document.querySelectorAll("p, li, td, div, span, h1, h2, h3, h4, h5, h6, ol, ul");e.forEach(function(e){if(e.classList.contains("classical-quote-container")||e.classList.contains("quote-text")||e.closest(".classical-quote-container"))return;var t,n=e.innerHTML,s=!1;for(n.indexOf("<em>")!==-1&&(t=n.replace(/\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$/g,function(e,t,n,s){return/^[\d.,]+$/.test((t+n+s).replace(/[.,]/g,""))?e:"$"+t+"_"+n+s+"$"}),t=t.replace(/\$\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$\$/g,function(e,t,n,s){return"$$"+t+"_"+n+s+"$$"}),t!==n&&(n=t,s=!0)),n.indexOf("</em>")!==-1&&(t=n.replace(/\$([^$]*?)<\/em>([^$]*?)\$/g,function(e,t,n){return"$"+t+"_{"+n+"$"}),t=t.replace(/\$\$([^$]*?)<\/em>([^$]*?)\$\$/g,function(e,t,n){return"$$"+t+"_{"+n+"$$"}),t!==n&&(n=t,s=!0)),n.indexOf("<em>$")!==-1&&(t=n.replace(/<em>\$/g,"$"),t!==n&&(n=t,s=!0)),n.indexOf("</em>$")!==-1&&(t=n.replace(/<\/em>\$/g,"$"),t!==n&&(n=t,s=!0));n.indexOf("<em>")!==-1&&n.indexOf("</em>")!==-1;){if(t=n.replace(/\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$/g,function(e,t,n,s){return/^[\d.,]+$/.test((t+n+s).replace(/[.,]/g,""))?e:"$"+t+"_"+n+s+"$"}),t=t.replace(/\$\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$\$/g,function(e,t,n,s){return"$$"+t+"_"+n+s+"$$"}),t===n)break;n=t,s=!0}n.indexOf("_{")!==-1&&(t=n.replace(/_{/g,"_{"),t!==n&&(n=t,s=!0)),n.indexOf("}_")!==-1&&(t=n.replace(/}_/g,"}"),t!==n&&(n=t,s=!0)),n.includes("</em>{")&&(t=n.replace(/\\mathbf\{(W|x|y|z)\}<\/em>\{\\mathrm\{([a-z]+)\}\}/g,"\\mathbf{$1}_{\\mathrm{$2}}"),t=t.replace(/([LHf])<\/em>\{\\mathrm\{([a-z]+)\}\}/g,"$1_{\\mathrm{$2}}"),t=t.replace(/\\nabla ([LHf])<\/em>\{\\mathrm\{([a-z]+)\}\}/g,`\\nabla $1_{\\mathrm{$2}}`),t=t.replace(/([A-Z])<\/em>\{\\mathrm\{([a-z]+)\}\}/g,"$1_{\\mathrm{$2}}"),t!==n&&(n=t,s=!0)),n.includes("<em>{\\mathrm{")&&(t=n.replace(/\\mathbf\{(W|x|y|z)\}<em>\{\\mathrm\{([a-z]+)\}\}/g,"\\mathbf{$1}_{\\mathrm{$2}}"),t=t.replace(/([LHf])<em>\{\\mathrm\{([a-z]+)\}\}/g,"$1_{\\mathrm{$2}}"),t=t.replace(/\\nabla ([LHf])<em>\{\\mathrm\{([a-z]+)\}\}/g,`\\nabla $1_{\\mathrm{$2}}`),t=t.replace(/([A-Z])<em>\{\\mathrm\{([a-z]+)\}\}/g,"$1_{\\mathrm{$2}}"),t!==n&&(n=t,s=!0)),(n.includes("</em>")||n.includes("<em>"))&&(t=n.replace(/(\$[^$]*?)<em>([^$]*?)<\/em>/g,"$1_{$2}"),t=t.replace(/(\$\$[^$]*?)<em>([^$]*?)<\/em>/g,"$1_{$2}"),t=t.replace(/(\$[^$]*?)<em>/g,"$1"),t=t.replace(/<em>([^$]*?\$)/g,"$1"),t=t.replace(/(\$[^$]*?)<\/em>/g,"$1"),t=t.replace(/<\/em>([^$]*?\$)/g,"$1"),t!==n&&(n=t,s=!0)),n.indexOf("\\\\")!==-1&&(t=n.replace(/(\$\{1,2\})([^$]*?)(\$\{1,2\})/g,function(e,t,n,s){for(;n.indexOf("\\\\")!==-1;)n=n.replace(/\\\\/g,"\\");return t+n+s}),t!==n&&(n=t,s=!0)),s&&(e.innerHTML=n)})}window.MathJax={tex:{inlineMath:[["$","$"]],displayMath:[["$$","$$"]],processEscapes:!0,processEnvironments:!0,tags:"ams",packages:{"[+]":["noerrors","noundefined","boldsymbol"]},macros:{oiint:"\\mathop{∯}",oiiint:"\\mathop{∰}"}},options:{skipHtmlTags:["script","noscript","style","textarea","pre","code"]},startup:{pageReady:function(){return e(),MathJax.startup.defaultPageReady().then(function(){console.log("MathJax formulas rendered successfully")})}}}})()</script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link rel=stylesheet href=/css/mermaid-custom.css><script src=/js/mermaid-converter.js></script><script type=module>
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';

  
  setTimeout(() => {
    mermaid.initialize({
      startOnLoad: true,
      theme: 'base',
      themeVariables: {
        primaryColor: '#e3f2fd',
        primaryTextColor: '#1565c0',
        primaryBorderColor: '#2196f3',
        lineColor: '#42a5f5',
        secondaryColor: '#f3e5f5',
        tertiaryColor: '#fff9c4',
        background: '#ffffff',
        mainBkg: '#ffffff',
        nodeBorder: '#2196f3',
        clusterBkg: '#ffffff',
        clusterBorder: '#e0e0e0',
        titleColor: '#1565c0',
        edgeLabelBackground: '#fafafa',
      },
      securityLevel: 'loose',
    });
  }, 100);
</script><script src=/js/toc.js></script></body></html>