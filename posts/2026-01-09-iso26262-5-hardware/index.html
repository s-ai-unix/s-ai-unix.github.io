<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>ISO 26262-5 硬件级开发：构建安全的硬件基础 | s-ai-unix's Blog</title><meta name=keywords content="ISO 26262,功能安全"><meta name=description content="深入解读 ISO 26262-5 硬件级开发部分，学习如何设计、实现和验证安全的硬件，包括硬件安全需求、硬件设计、FMEDA 分析等。"><meta name=author content="s-ai-unix"><link rel=canonical href=https://s-ai-unix.github.io/posts/2026-01-09-iso26262-5-hardware/><link crossorigin=anonymous href=/assets/css/stylesheet.0833aff7e1cf567ecfb9755701ee95a80535f671e2e1a0a770c9bc20a0a7b5bb.css integrity="sha256-CDOv9+HPVn7PuXVXAe6VqAU19nHi4aCncMm8IKCntbs=" rel="preload stylesheet" as=style><link rel=icon href=https://s-ai-unix.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://s-ai-unix.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://s-ai-unix.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://s-ai-unix.github.io/apple-touch-icon.png><link rel=mask-icon href=https://s-ai-unix.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://s-ai-unix.github.io/posts/2026-01-09-iso26262-5-hardware/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><meta property="og:url" content="https://s-ai-unix.github.io/posts/2026-01-09-iso26262-5-hardware/"><meta property="og:site_name" content="s-ai-unix's Blog"><meta property="og:title" content="ISO 26262-5 硬件级开发：构建安全的硬件基础"><meta property="og:description" content="深入解读 ISO 26262-5 硬件级开发部分，学习如何设计、实现和验证安全的硬件，包括硬件安全需求、硬件设计、FMEDA 分析等。"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2026-01-09T00:00:00+00:00"><meta property="article:modified_time" content="2026-01-09T00:00:00+00:00"><meta property="article:tag" content="ISO 26262"><meta property="article:tag" content="功能安全"><meta property="og:image" content="https://s-ai-unix.github.io/images/covers/iso26262-5-hardware.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://s-ai-unix.github.io/images/covers/iso26262-5-hardware.jpg"><meta name=twitter:title content="ISO 26262-5 硬件级开发：构建安全的硬件基础"><meta name=twitter:description content="深入解读 ISO 26262-5 硬件级开发部分，学习如何设计、实现和验证安全的硬件，包括硬件安全需求、硬件设计、FMEDA 分析等。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://s-ai-unix.github.io/posts/"},{"@type":"ListItem","position":2,"name":"ISO 26262-5 硬件级开发：构建安全的硬件基础","item":"https://s-ai-unix.github.io/posts/2026-01-09-iso26262-5-hardware/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"ISO 26262-5 硬件级开发：构建安全的硬件基础","name":"ISO 26262-5 硬件级开发：构建安全的硬件基础","description":"深入解读 ISO 26262-5 硬件级开发部分，学习如何设计、实现和验证安全的硬件，包括硬件安全需求、硬件设计、FMEDA 分析等。","keywords":["ISO 26262","功能安全"],"articleBody":"引言 在汽车电子系统中，硬件是功能安全的物理基础。无论软件多么完美，如果硬件设计存在缺陷，整个系统的安全性都会受到威胁。\n想象一个真实场景：某汽车厂商的电动助力转向系统（EPS）采用了先进的控制算法，但由于选用的电机驱动芯片在高温环境下容易发生闩锁效应（latch-up），导致车辆在夏季高温天气中突然失去转向助力，造成了多起事故。\n这个案例告诉我们：**硬件级开发不仅要满足性能要求，更要确保在所有预期的工作条件下都能安全运行。**这正是 ISO 26262-5 硬件级开发的核心使命。\n硬件级开发的目标和范围 硬件级开发的核心活动 ISO 26262-5 定义了硬件级开发的七个核心活动：\n硬件安全需求（HSR）的初始化\n分析系统级安全需求 硬件架构的初步设计 硬件安全需求清单 硬件架构设计\n设计硬件组件的架构 定义硬件组件之间的接口 评估硬件架构的适用性 硬件详细设计\n电路设计 元器件选型 PCB 布局布线 硬件架构指标评估\n单点故障度量（SPFM） 潜在故障度量（LFM） 硬件架构度量（HF） FMEDA 分析\n识别硬件失效模式 评估失效影响 计算硬件架构指标 硬件集成和验证\n硬件原型制作 硬件测试 硬件验证 硬件生产\n生产过程开发 生产质量控制 硬件级开发的输入和输出 输入 系统安全需求（SSyR）：来自系统级开发 技术安全概念（TSC）：来自系统级开发 硬件/软件接口规范（HSIS）：来自系统级开发 硬件约束：成本、尺寸、功耗、温度范围等 输出 硬件安全需求（HSR）：硬件级安全需求 硬件架构设计文档：硬件架构设计 硬件详细设计文档：电路设计、元器件清单 FMEDA 报告：失效模式、影响和诊断分析 硬件测试报告：测试结果 硬件生产文档：生产流程、质量控制 硬件安全需求（HSR）的初始化 HSR 的来源 硬件安全需求主要来自以下几个方面：\n从系统级安全需求（SSyR）派生 从技术安全概念（TSC）派生 从硬件/软件接口规范（HSIS）派生 HSR 的分类 1. 功能性需求 描述硬件应该实现的功能。\n2. 性能需求 描述硬件的性能指标，如响应时间、精度等。\n3. 安全机制需求 描述硬件应该实现的安全机制，如看门狗、ECC 内存等。\n4. 环境需求 描述硬件应该满足的环境条件，如温度、湿度、振动等。\n5. 可靠性需求 描述硬件的可靠性要求，如 FIT 率、MTBF 等。\n案例：制动系统的硬件安全需求 来自 SSyR 的 HSR：\nHSR-1.1（来自 SSyR-1.1）：\n“压力传感器的采样周期不得大于 10 ms”\n具体要求：\n采样频率 ≥ 100 Hz ADC 转换时间 ≤ 5 ms 数据传输时间 ≤ 2 ms HSR-1.2（来自 SSyR-1.3）：\n“系统应实现压力传感器故障诊断算法”\n具体要求：\n硬件应支持开路检测 硬件应支持短路检测 硬件应支持信号范围检测 HSR-1.3（来自 SSyR-1.3.1）：\n“硬件应实现独立于 CPU 的看门狗定时器”\n具体要求：\n看门狗类型：外部窗口看门狗 超时时间：可配置（默认 100 ms） 复位类型：系统复位 独立性：看门狗的时钟和电源应独立于 CPU 硬件架构设计 硬件架构设计的原则 独立性原则：冗余硬件组件之间应该独立，避免共因故障 多样性原则：不同冗余通道采用不同的实现方式 诊断性原则：硬件应具备自诊断能力 容错性原则：硬件应能容忍一定的故障 硬件架构的类型 1. 单通道架构 适用于 ASIL A/B。\n优点：\n成本低 功耗低 空间小 缺点：\n安全性有限 单点故障可能导致危险失效 2. 双通道冗余架构 适用于 ASIL C/D。\n优点：\n安全性高 可以容忍一个通道的故障 缺点：\n成本中等 功耗中等 空间中等 3. 三模冗余架构（TMR） 适用于 ASIL D 高要求场景。\n优点：\n安全性最高 可以容忍一个通道的故障 缺点：\n成本高 功耗高 空间大 案例：ASIL D 系统的三模冗余架构 对于 ASIL D 的电子驻车制动系统（EPB），采用三模冗余架构：\n传感器 │ ┌────────┼────────┐ │ │ │ MCU1 MCU2 MCU3 │ │ │ └────────┼────────┘ │ 投票器 │ 执行器 可靠性计算：\n假设单个 MCU 的可靠度为 $R = 0.9999$（在任务时间内）。\n系统成功运行的条件是：至少两个 MCU 正常工作。\n$$ R_{\\text{system}} = R^3 + 3 \\times R^2 \\times (1-R) $$\n代入数值： $$ R_{\\text{system}} = 0.9999^3 + 3 \\times 0.9999^2 \\times 0.0001 $$ $$ R_{\\text{system}} = 0.9997 + 0.00029997 $$ $$ R_{\\text{system}} = 0.99999997 $$\n可以看到，通过三模冗余，系统可靠度从 99.99% 提升到了 99.999997%。\n硬件详细设计 电路设计 电路设计包括原理图设计和 PCB 布局布线。\n原理图设计 原理图设计要点：\n元器件选型：选择符合功能安全要求的元器件 电路保护：添加过压、过流、防静电保护 滤波和去耦：添加滤波电容、去耦电容 信号完整性：考虑信号的阻抗匹配、串扰、反射等问题 PCB 布局布线 PCB 布局布线要点：\n元器件布局：考虑散热、EMC、信号完整性 走线设计：考虑阻抗匹配、差分走线、地平面 电源设计：考虑电源分配、去耦、纹波 EMC 设计：考虑屏蔽、滤波、地平面 元器件选型 元器件选型的原则 质量等级：选择汽车级或工业级元器件 可靠性：选择低 FIT 率的元器件 功能安全认证：选择有功能安全认证的元器件 可获取性：选择长期可获取的元器件 成本：在满足要求的前提下，选择成本合理的元器件 元器件的可靠性指标 FIT 率（Failure In Time）：每十亿小时内的故障次数。\n$$ \\text{FIT} = \\frac{10^9}{\\text{MTBF}} $$\n其中，MTBF（Mean Time Between Failures）是平均故障间隔时间。\n案例：MCU 选型 对于 ASIL D 的应用，MCU 选型要求：\n要求 描述 示例 功能安全认证 具备 ISO 26262 ASIL D 认证 Infineon AURIX TC3 系列 架构 双核或三核架构 双核 ARM Cortex-R52 内存 具备 ECC 保护的 Flash 和 RAM 4MB Flash + 512KB RAM 看门狗 独立于 CPU 的外部看门狗 内置窗口看门狗 FIT 率 FIT 率 ≤ 100 典型 FIT 率 10-50 案例：制动系统的硬件详细设计 原理图设计 MCU 电路：\n3.3V │ │ ┌────▼────┐ │ MCU1 │ │ ┌───┐ │ │ │CPU│ │ │ └───┘ │ │ ┌───┐ │ │ │RAM│ │ │ │ECC│ │ │ └───┘ │ └────┬────┘ │ GND 传感器电路：\n5V │ │ ┌▼────────────────────────────┐ │ 压力传感器 │ │ ┌──────────────────────┐ │ │ │ 信号调理电路 │ │ │ └──────────────────────┘ │ └────────────┬────────────────┘ │ │ 0-5V 模拟信号 │ ┌────▼────┐ │ ADC │ └────┬────┘ │ │ 12-bit 数字信号 │ ┌───▼───┐ │ MCU1 │ └───────┘ 看门狗电路：\n3.3V │ │ ┌──▼──┐ │WDT │ │Timer│ └──┬──┘ │ │ 复位信号 │ ┌──▼──┐ │MCU1 │ └──┬──┘ │ │ 喂狗信号 │ ┌──▼──┐ │WDT │ │Timer│ └──┬──┘ │ GND PCB 布局布线 分层设计：\n┌────────────────────────────────┐ │ 第1层：信号层（Top Layer） │ │ - MCU │ │ - 传感器 │ │ - 看门狗 │ ├────────────────────────────────┤ │ 第2层：地层（Ground Plane） │ │ - 完整地平面 │ ├────────────────────────────────┤ │ 第3层：电源层（Power Plane） │ │ - 5V 电源平面 │ │ - 3.3V 电源平面 │ ├────────────────────────────────┤ │ 第4层：信号层（Bottom Layer） │ │ - 去耦电容 │ │ - 测试点 │ └────────────────────────────────┘ 去耦电容布局：\n5V │ │ ┌──▼──┐ │ 10uF│ │ 电容│ └──┬──┘ │ │ ┌──▼──┐ │ 0.1uF│ │ 电容│ └──┬──┘ │ │ ┌──▼──┐ │ MCU1 │ └──┬──┘ │ GND 硬件架构指标 graph LR subgraph 硬件安全指标体系 Input[硬件设计] --\u003e Metrics[硬件架构指标] Metrics --\u003e SPFM[单点故障度量SPFM单点故障覆盖率] Metrics --\u003e LFM[潜伏故障度量LFM潜伏故障覆盖率] Metrics --\u003e PMHF[随机硬件失效概率PMHF失效率] end Metrics --\u003e ASIL{ASIL等级要求} SPFM --\u003e ASILB[ASIL B: ≥90%] SPFM --\u003e ASILC[ASIL C: ≥97%] SPFM --\u003e ASILD[ASIL D: ≥99%] LFM --\u003e LFM_B[ASIL B: ≥60%] LFM --\u003e LFM_C[ASIL C: ≥80%] LFM --\u003e LFM_D[ASIL D: ≥90%] PMHF --\u003e PMHF_B[ASIL B: ≤100 FIT] PMHF --\u003e PMHF_c[ASIL C: ≤100 FIT] PMHF --\u003e PMHF_d[ASIL D: ≤10 FIT] style Input fill:#5AC8FA,stroke:#007AFF,stroke-width:2px,color:#ffffff style Metrics fill:#AF52DE,stroke:#AF52DE,stroke-width:2px,color:#ffffff style ASIL fill:#FF9500,stroke:#FF9500,stroke-width:2px,color:#ffffff style SPFM fill:#34C759,stroke:#34C759,stroke-width:2px,color:#ffffff style LFM fill:#34C759,stroke:#34C759,stroke-width:2px,color:#ffffff style PMHF fill:#34C759,stroke:#34C759,stroke-width:2px,color:#ffffff style ASILB fill:#30D158,stroke:#34C759,stroke-width:2px,color:#ffffff style ASILC fill:#32D74B,stroke:#32D74B,stroke-width:2px,color:#ffffff style ASILD fill:#007AFF,stroke:#007AFF,stroke-width:2px,color:#ffffff style LFM_B fill:#30D158,stroke:#34C759,stroke-width:2px,color:#ffffff style LFM_C fill:#32D74B,stroke:#32D74B,stroke-width:2px,color:#ffffff style LFM_D fill:#007AFF,stroke:#007AFF,stroke-width:2px,color:#ffffff style PMHF_B fill:#30D158,stroke:#34C759,stroke-width:2px,color:#ffffff style PMHF_c fill:#32D74B,stroke:#32D74B,stroke-width:2px,color:#ffffff style PMHF_d fill:#007AFF,stroke:#007AFF,stroke-width:2px,color:#ffffff 评估\nISO 26262-5 定义了三个硬件架构指标：\n1. 单点故障度量（SPFM） SPFM（Single Point Fault Metric） 衡量的是系统对单点故障的防护能力。\n$$ \\text{SPFM} = \\frac{\\sum \\lambda_{\\text{SPF}} - \\sum \\lambda_{\\text{RF}}}{\\sum \\lambda_{\\text{SPF}}} \\times 100% $$\n其中：\n$\\lambda_{\\text{SPF}}$：单点故障率 $\\lambda_{\\text{RF}}$：未被安全机制覆盖的单点故障率 ASIL 要求：\nASIL 等级 SPFM 要求 ASIL A ≥ 60% ASIL B ≥ 90% ASIL C ≥ 97% ASIL D ≥ 99% 2. 潜在故障度量（LFM） LFM（Latent Fault Metric） 衡量的是系统对潜在故障的检测能力。\n$$ \\text{LFM} = \\frac{\\sum \\lambda_{\\text{LF}} - \\sum \\lambda_{\\text{RF}}}{\\sum \\lambda_{\\text{LF}}} \\times 100% $$\n其中：\n$\\lambda_{\\text{LF}}$：潜在故障率 $\\lambda_{\\text{RF}}$：未被安全机制覆盖的潜在故障率 ASIL 要求：\nASIL 等级 LFM 要求 ASIL A 不要求 ASIL B ≥ 60% ASIL C ≥ 80% ASIL D ≥ 90% 3. 硬件架构度量（HF） HF（Hardware Architecture Metric） 结合了 SPFM 和 LFM，用于评估硬件架构的适用性。\nASIL 要求：\nASIL 等级 HF 要求 ASIL A 不要求 ASIL B 满足 SPFM 或 LFM ASIL C 满足 SPFM 和 LFM ASIL D 满足 SPFM 和 LFM 案例：制动系统的硬件架构指标计算 假设制动系统的硬件组件包括：\n组件 FIT 率 单点故障 潜在故障 安全机制覆盖 MCU1 50 40 10 90% MCU2 50 40 10 90% 压力传感器1 20 15 5 80% 压力传感器2 20 15 5 80% 阀门驱动器 30 25 5 70% SPFM 计算：\n$$ \\sum \\lambda_{\\text{SPF}} = 40 + 40 + 15 + 15 + 25 = 135 \\text{ FIT} $$\n$$ \\sum \\lambda_{\\text{RF}} = 40 \\times (1 - 0.9) + 40 \\times (1 - 0.9) + 15 \\times (1 - 0.8) + 15 \\times (1 - 0.8) + 25 \\times (1 - 0.7) $$ $$ \\sum \\lambda_{\\text{RF}} = 4 + 4 + 3 + 3 + 7.5 = 21.5 \\text{ FIT} $$\n$$ \\text{SPFM} = \\frac{135 - 21.5}{135} \\times 100% = 84.07% $$\nLFM 计算：\n$$ \\sum \\lambda_{\\text{LF}} = 10 + 10 + 5 + 5 + 5 = 35 \\text{ FIT} $$\n$$ \\sum \\lambda_{\\text{RF}} = 10 \\times (1 - 0.9) + 10 \\times (1 - 0.9) + 5 \\times (1 - 0.8) + 5 \\times (1 - 0.8) + 5 \\times (1 - 0.7) $$ $$ \\sum \\lambda_{\\text{RF}} = 1 + 1 + 1 + 1 + 1.5 = 5.5 \\text{ FIT} $$\n$$ \\text{LFM} = \\frac{35 - 5.5}{35} \\times 100% = 84.29% $$\n结论：\nSPFM = 84.07%，满足 ASIL B 要求（≥ 90%），但不满足 ASIL C/D 要求 LFM = 84.29%，满足 ASIL C 要求（≥ 80%），但不满足 ASIL D 要求 如果该系统的 ASIL 等级是 C，则满足要求。如果是 ASIL D，则需要改进安全机制，提高覆盖率。\nFMEDA 分析 FMEDA 的定义 FMEDA（Failure Modes, Effects and Diagnostic Analysis） 是一种用于分析硬件失效模式、影响和诊断能力的方法。\nFMEDA 的步骤 第一步：识别硬件组件 列出系统中的所有硬件组件。\n第二步：识别失效模式 对于每个硬件组件，识别其可能的失效模式。\n第三步：分析失效影响 分析每个失效模式对系统的影响。\n第四步：分析诊断覆盖率 分析现有安全机制对失效模式的诊断覆盖率。\n第五步：计算硬件架构指标 计算 SPFM 和 LFM。\nFMEDA 表格示例 组件 失效模式 失效率（FIT） 失效影响 安全机制 覆盖率 MCU1 CPU 挂死 10 系统失效 看门狗 90% MCU1 Flash 坏块 15 数据丢失 ECC 95% MCU1 RAM 位翻转 20 计算错误 ECC + 定期检查 80% MCU2 CPU 挂死 10 系统失效 看门狗 90% MCU2 Flash 坏块 15 数据丢失 ECC 95% 压力传感器1 开路 5 信号丢失 开路检测 100% 压力传感器1 短路 5 信号错误 短路检测 100% 压力传感器1 漂移 10 测量误差 冗余传感器 60% 案例：制动系统的 FMEDA 分析 第一步：识别硬件组件 制动系统的硬件组件：\nMCU1（主控制器） MCU2（备份控制器） 压力传感器1 压力传感器2 阀门驱动器 看门狗定时器 电源管理芯片 第二步：识别失效模式 以 MCU1 为例：\n失效模式 描述 失效率（FIT） CPU 挂死 CPU 停止执行指令 10 Flash 坏块 Flash 存储单元损坏 15 RAM 位翻转 RAM 存储单元翻转 20 时钟故障 时钟信号异常 5 I/O 故障 I/O 引脚故障 10 总计：60 FIT\n第三步：分析失效影响 失效模式 失效影响 危险等级 CPU 挂死 系统停止响应 高 Flash 坏块 控制算法数据损坏 高 RAM 位翻转 计算结果错误 中 时钟故障 定时错误 高 I/O 故障 通信错误 中 第四步：分析诊断覆盖率 失效模式 安全机制 覆盖率 CPU 挂死 看门狗定时器 90% Flash 坏块 ECC 校验 95% RAM 位翻转 ECC 校验 + 定期检查 80% 时钟故障 时钟监测电路 70% I/O 故障 回环测试 85% 第五步：计算硬件架构指标 单点故障（SPF）：\nCPU 挂死：10 FIT Flash 坏块：15 FIT 时钟故障：5 FIT I/O 故障：10 FIT 潜在故障（LF）：\nRAM 位翻转：20 FIT SPFM 计算：\n$$ \\sum \\lambda_{\\text{SPF}} = 10 + 15 + 5 + 10 = 40 \\text{ FIT} $$\n$$ \\sum \\lambda_{\\text{RF}} = 10 \\times (1 - 0.9) + 15 \\times (1 - 0.95) + 5 \\times (1 - 0.7) + 10 \\times (1 - 0.85) $$ $$ \\sum \\lambda_{\\text{RF}} = 1 + 0.75 + 1.5 + 1.5 = 4.75 \\text{ FIT} $$\n$$ \\text{SPFM} = \\frac{40 - 4.75}{40} \\times 100% = 88.125% $$\nLFM 计算：\n$$ \\sum \\lambda_{\\text{LF}} = 20 \\text{ FIT} $$\n$$ \\sum \\lambda_{\\text{RF}} = 20 \\times (1 - 0.8) = 4 \\text{ FIT} $$\n$$ \\text{LFM} = \\frac{20 - 4}{20} \\times 100% = 80% $$\n结论：\nSPFM = 88.125%，满足 ASIL B 要求（≥ 90%），但不满足 ASIL C/D 要求 LFM = 80%，满足 ASIL C 要求（≥ 80%），但不满足 ASIL D 要求 如果该系统的 ASIL 等级是 C，则满足要求。如果是 ASIL D，则需要改进安全机制，特别是提高时钟故障和 I/O 故障的诊断覆盖率。\n硬件集成和验证 硬件集成 硬件集成的步骤：\n原型制作：制作硬件原型板 硬件测试：测试硬件的基本功能 硬件验证：验证硬件满足设计要求 硬件确认：确认硬件满足安全需求 硬件测试 测试类型 功能测试：\n测试硬件的基本功能 测试硬件的性能指标 环境测试：\n温度测试（高温、低温、温度循环） 湿度测试 振动测试 EMC 测试 可靠性测试：\n寿命测试 加速寿命测试 安全测试：\n故障注入测试 安全机制测试 案例：制动系统的硬件测试 测试用例 1：MCU 看门狗测试\n测试目的：验证看门狗定时器能够检测到 CPU 挂死。\n测试步骤：\n系统上电初始化 正常运行，喂狗 模拟 CPU 挂死（停止喂狗） 等待看门狗超时 检查系统是否复位 预期结果：\n看门狗超时时间到后，系统复位 测试用例 2：压力传感器开路测试\n测试目的：验证压力传感器开路检测功能。\n测试步骤：\n系统上电初始化 正常运行，读取压力传感器数据 断开压力传感器1（模拟开路故障） 等待诊断周期 检查系统是否检测到开路故障 预期结果：\n系统在诊断周期内检测到压力传感器1开路故障 系统切换到压力传感器2 系统向驾驶员发出报警 测试用例 3：RAM 位翻转测试\n测试目的：验证 ECC 能够检测和纠正 RAM 位翻转。\n测试步骤：\n系统上电初始化 向 RAM 写入已知数据 使用硬件故障注入工具注入位翻转 读取 RAM 数据 检查 ECC 是否检测到位翻转并纠正 预期结果：\nECC 检测到位翻转 ECC 纠正位翻转 系统记录错误 实战案例：电动车电池管理系统（BMS）的硬件级开发 让我们以一个实际项目为例，展示硬件级开发的完整流程。\n项目背景 某电动车厂商正在开发新一代 BMS，用于管理 400V/80kWh 的动力电池包。ASIL 等级：C。\n第一步：硬件安全需求初始化 来自系统级开发的 HSR：\nHSR-1.1：\n“BMS 应每 10 ms 读取一次所有单体电池电压”\n具体要求：\n电压采样频率 ≥ 100 Hz 采样精度 ≥ 5 mV 采样通道数 ≥ 96（假设 96 个单体电池） HSR-1.2：\n“BMS 应实现过温保护，当电池温度超过 60°C 时切断充电”\n具体要求：\n温度采样频率 ≥ 10 Hz 温度精度 ≥ 1°C 温度检测点数 ≥ 32（假设 32 个温度传感器） HSR-1.3：\n“BMS 应实现过充保护，当电池电压超过 4.2V 时切断充电”\n具体要求：\n电压采样实时性：采样 + 判断 ≤ 20 ms 切断充电时间：≤ 50 ms 第二步：硬件架构设计 双通道冗余架构：\n电池模组 │ ┌───────────┼───────────┐ │ │ │ 模组1 模组2 模组N │ │ │ ┌─────┼─────┐ ┌───┼─────┐ ┌──┼─────┐ │单体电池单体│ │单体电池单体│ │单体电池单体│ │电压监测 │ │电压监测 │ │电压监测 │ │温度监测 │ │温度监测 │ │温度监测 │ └─────┬─────┘ └───┬─────┘ └──┬─────┘ │ │ │ └───────────┼───────────┘ │ ┌─────┴─────┐ │ 模组控制器│ │ （MCU） │ └─────┬─────┘ │ ┌─────┴─────┐ │ 主控制器 │ │ （MCU） │ └─────┬─────┘ │ ┌─────┴─────┐ │ 安全监控器│ └──────────┘ 第三步：硬件详细设计 模组控制器电路：\nMCU：Infineon XMC4200（ASIL B 认证） ADC：TI ADS1118（16-bit，4 通道） 温度传感器：NTC 10kΩ（β = 3950） 通信：隔离 CAN（ISO 1050） 主控制器电路：\nMCU：Infineon AURIX TC377（ASIL D 认证） 看门狗：Maxim MAX6370（窗口看门狗） 通信：双 CAN（CAN 1 + CAN 2） 电源：隔离 DC/DC 转换器 第四步：FMEDA 分析 MCU 失效模式分析：\n失效模式 失效率（FIT） 单点/潜在 安全机制 覆盖率 CPU 挂死 10 单点 看门狗 95% Flash 坏块 15 潜在 ECC + 自检 90% RAM 位翻转 20 潜在 ECC + 定期检查 85% 时钟故障 5 单点 时钟监测 80% ADC 失效模式分析：\n失效模式 失效率（FIT） 单点/潜在 安全机制 覆盖率 采样错误 5 单点 冗余 ADC 90% 偏移漂移 3 潜在 定期校准 70% SPFM 计算：\n$$ \\sum \\lambda_{\\text{SPF}} = 10 + 5 = 15 \\text{ FIT} $$\n$$ \\sum \\lambda_{\\text{RF}} = 10 \\times (1 - 0.95) + 5 \\times (1 - 0.9) = 0.5 + 0.5 = 1 \\text{ FIT} $$\n$$ \\text{SPFM} = \\frac{15 - 1}{15} \\times 100% = 93.33% $$\nLFM 计算：\n$$ \\sum \\lambda_{\\text{LF}} = 15 + 20 + 3 = 38 \\text{ FIT} $$\n$$ \\sum \\lambda_{\\text{RF}} = 15 \\times (1 - 0.9) + 20 \\times (1 - 0.85) + 3 \\times (1 - 0.7) $$ $$ \\sum \\lambda_{\\text{RF}} = 1.5 + 3 + 0.9 = 5.4 \\text{ FIT} $$\n$$ \\text{LFM} = \\frac{38 - 5.4}{38} \\times 100% = 85.79% $$\n结论：\nSPFM = 93.33%，满足 ASIL C 要求（≥ 97%？不对，看下表） 等等，让我重新检查 ASIL 要求 ASIL 等级 SPFM 要求 LFM 要求 ASIL A ≥ 60% 不要求 ASIL B ≥ 90% ≥ 60% ASIL C ≥ 97% ≥ 80% ASIL D ≥ 99% ≥ 90% 所以 SPFM = 93.33% 满足 ASIL B 要求，但不满足 ASIL C 要求（≥ 97%）。 LFM = 85.79% 满足 ASIL C 要求（≥ 80%）。\n如果系统的 ASIL 等级是 C，则 SPFM 不满足要求，需要改进安全机制，提高覆盖率。\n第五步：硬件测试 测试用例 1：电压采样精度测试\n测试目的：验证电压采样精度 ≥ 5 mV。\n测试步骤：\n使用标准电压源施加已知电压 读取 BMS 采样值 计算误差 重复测试多个电压点 预期结果：\n所有采样点的误差 ≤ 5 mV 测试用例 2：过温保护测试\n测试目的：验证过温保护功能。\n测试步骤：\n系统上电初始化 模拟温度升高（使用温度箱） 当温度超过 60°C 时，检查系统是否切断充电 检查切断时间 ≤ 50 ms 预期结果：\n温度 \u003e 60°C 时，系统切断充电 切断时间 ≤ 50 ms 常见错误和最佳实践 常见错误 硬件架构设计不合理\n冗余设计不足 缺乏独立性 共因故障未考虑 元器件选型不当\n选用了非汽车级元器件 忽视了功能安全认证 可靠性数据不准确 FMEDA 分析不完整\n未识别所有失效模式 安全机制覆盖率过高估计 硬件架构指标计算错误 硬件测试不充分\n只测试正常场景 未进行故障注入测试 环境测试不全面 最佳实践 使用专业的 FMEDA 工具\n如 Reliasoft FMEDA、Isograph Reliability Workbench 提高分析效率和准确性 参考元器件厂商的 FMEDA 报告\nMCU、传感器等厂商通常提供 FMEDA 报告 可以作为分析的参考 充分的硬件测试\n覆盖所有失效模式 使用硬件故障注入工具 进行全面的可靠性测试 建立失效案例库\n记录实际发生的故障 定期回顾和更新 FMEDA 总结 ISO 26262-5 硬件级开发是构建安全的硬件基础的关键环节。通过本文的深入解读和丰富的案例实践，我们掌握了：\n硬件安全需求（HSR）的初始化：\nHSR 的来源和分类 HSR 的制定方法 硬件架构设计：\n硬件架构设计的原则 单通道、双通道、三模冗余架构 三模冗余的可靠性计算 硬件详细设计：\n电路设计（原理图设计、PCB 布局布线） 元器件选型 制动系统的硬件设计实例 硬件架构指标评估：\nSPFM（单点故障度量）的计算 LFM（潜在故障度量）的计算 HF（硬件架构度量） ASIL 要求对照 FMEDA 分析：\nFMEDA 的五个步骤 FMEDA 表格的制作 制动系统的 FMEDA 实践 硬件集成和验证：\n硬件集成的步骤 硬件测试的类型 制动系统的测试用例 实战案例：\nBMS 硬件级开发完整实践 核心要点：\n硬件是功能安全的物理基础，必须确保安全可靠 硬件架构设计必须考虑独立性、多样性和诊断性 FMEDA 是评估硬件安全性的重要方法，必须认真执行 硬件架构指标（SPFM、LFM）必须满足 ASIL 要求 充分的硬件测试是确保硬件安全的关键 在下一篇文章中，我们将深入解读 ISO 26262-6 软件级开发部分，学习如何设计和开发安全的软件。\n延伸阅读 ISO 26262-1: 词汇 ISO 26262-2: 功能安全管理 ISO 26262-4: 系统级开发 ISO 26262-6: 软件级开发 ISO 26262 整体综述 ","wordCount":"1955","inLanguage":"en","image":"https://s-ai-unix.github.io/images/covers/iso26262-5-hardware.jpg","datePublished":"2026-01-09T00:00:00Z","dateModified":"2026-01-09T00:00:00Z","author":{"@type":"Person","name":"s-ai-unix"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://s-ai-unix.github.io/posts/2026-01-09-iso26262-5-hardware/"},"publisher":{"@type":"Organization","name":"s-ai-unix's Blog","logo":{"@type":"ImageObject","url":"https://s-ai-unix.github.io/favicon.ico"}}}</script><link rel=stylesheet href=https://s-ai-unix.github.io/css/classical-quote.css></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://s-ai-unix.github.io/ accesskey=h title="s-ai-unix's Blog (Alt + H)">s-ai-unix's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://s-ai-unix.github.io/ title="🏠 首页"><span>🏠 首页</span></a></li><li><a href=https://s-ai-unix.github.io/posts/ title="📚 文章"><span>📚 文章</span></a></li><li><a href=https://s-ai-unix.github.io/archives/ title="📁 归档"><span>📁 归档</span></a></li><li><a href=https://s-ai-unix.github.io/tags/ title="🏷️ 标签"><span>🏷️ 标签</span></a></li><li><a href=https://s-ai-unix.github.io/search/ title="🔍 搜索 (Alt + /)" accesskey=/><span>🔍 搜索</span></a></li><li><a href=https://s-ai-unix.github.io/about/ title="👤 关于"><span>👤 关于</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://s-ai-unix.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://s-ai-unix.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">ISO 26262-5 硬件级开发：构建安全的硬件基础</h1><div class=post-description>深入解读 ISO 26262-5 硬件级开发部分，学习如何设计、实现和验证安全的硬件，包括硬件安全需求、硬件设计、FMEDA 分析等。</div><div class=post-meta><span title='2026-01-09 00:00:00 +0000 UTC'>January 9, 2026</span>&nbsp;·&nbsp;<span>10 min</span>&nbsp;·&nbsp;<span>1955 words</span>&nbsp;·&nbsp;<span>s-ai-unix</span></div></header><figure class=entry-cover><a href=https://s-ai-unix.github.io/images/covers/iso26262-5-hardware.jpg target=_blank rel="noopener noreferrer"><img loading=eager src=https://s-ai-unix.github.io/images/covers/iso26262-5-hardware.jpg alt="ISO 26262 硬件级开发"></a><figcaption>构建安全的硬件基础</figcaption></figure><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e5%bc%95%e8%a8%80 aria-label=引言>引言</a></li><li><a href=#%e7%a1%ac%e4%bb%b6%e7%ba%a7%e5%bc%80%e5%8f%91%e7%9a%84%e7%9b%ae%e6%a0%87%e5%92%8c%e8%8c%83%e5%9b%b4 aria-label=硬件级开发的目标和范围>硬件级开发的目标和范围</a><ul><li><a href=#%e7%a1%ac%e4%bb%b6%e7%ba%a7%e5%bc%80%e5%8f%91%e7%9a%84%e6%a0%b8%e5%bf%83%e6%b4%bb%e5%8a%a8 aria-label=硬件级开发的核心活动>硬件级开发的核心活动</a></li><li><a href=#%e7%a1%ac%e4%bb%b6%e7%ba%a7%e5%bc%80%e5%8f%91%e7%9a%84%e8%be%93%e5%85%a5%e5%92%8c%e8%be%93%e5%87%ba aria-label=硬件级开发的输入和输出>硬件级开发的输入和输出</a><ul><li><a href=#%e8%be%93%e5%85%a5 aria-label=输入>输入</a></li><li><a href=#%e8%be%93%e5%87%ba aria-label=输出>输出</a></li></ul></li></ul></li><li><a href=#%e7%a1%ac%e4%bb%b6%e5%ae%89%e5%85%a8%e9%9c%80%e6%b1%82hsr%e7%9a%84%e5%88%9d%e5%a7%8b%e5%8c%96 aria-label=硬件安全需求（HSR）的初始化>硬件安全需求（HSR）的初始化</a><ul><li><a href=#hsr-%e7%9a%84%e6%9d%a5%e6%ba%90 aria-label="HSR 的来源">HSR 的来源</a></li><li><a href=#hsr-%e7%9a%84%e5%88%86%e7%b1%bb aria-label="HSR 的分类">HSR 的分类</a><ul><li><a href=#1-%e5%8a%9f%e8%83%bd%e6%80%a7%e9%9c%80%e6%b1%82 aria-label="1. 功能性需求">1. 功能性需求</a></li><li><a href=#2-%e6%80%a7%e8%83%bd%e9%9c%80%e6%b1%82 aria-label="2. 性能需求">2. 性能需求</a></li><li><a href=#3-%e5%ae%89%e5%85%a8%e6%9c%ba%e5%88%b6%e9%9c%80%e6%b1%82 aria-label="3. 安全机制需求">3. 安全机制需求</a></li><li><a href=#4-%e7%8e%af%e5%a2%83%e9%9c%80%e6%b1%82 aria-label="4. 环境需求">4. 环境需求</a></li><li><a href=#5-%e5%8f%af%e9%9d%a0%e6%80%a7%e9%9c%80%e6%b1%82 aria-label="5. 可靠性需求">5. 可靠性需求</a></li></ul></li><li><a href=#%e6%a1%88%e4%be%8b%e5%88%b6%e5%8a%a8%e7%b3%bb%e7%bb%9f%e7%9a%84%e7%a1%ac%e4%bb%b6%e5%ae%89%e5%85%a8%e9%9c%80%e6%b1%82 aria-label=案例：制动系统的硬件安全需求>案例：制动系统的硬件安全需求</a></li></ul></li><li><a href=#%e7%a1%ac%e4%bb%b6%e6%9e%b6%e6%9e%84%e8%ae%be%e8%ae%a1 aria-label=硬件架构设计>硬件架构设计</a><ul><li><a href=#%e7%a1%ac%e4%bb%b6%e6%9e%b6%e6%9e%84%e8%ae%be%e8%ae%a1%e7%9a%84%e5%8e%9f%e5%88%99 aria-label=硬件架构设计的原则>硬件架构设计的原则</a></li><li><a href=#%e7%a1%ac%e4%bb%b6%e6%9e%b6%e6%9e%84%e7%9a%84%e7%b1%bb%e5%9e%8b aria-label=硬件架构的类型>硬件架构的类型</a><ul><li><a href=#1-%e5%8d%95%e9%80%9a%e9%81%93%e6%9e%b6%e6%9e%84 aria-label="1. 单通道架构">1. 单通道架构</a></li><li><a href=#2-%e5%8f%8c%e9%80%9a%e9%81%93%e5%86%97%e4%bd%99%e6%9e%b6%e6%9e%84 aria-label="2. 双通道冗余架构">2. 双通道冗余架构</a></li><li><a href=#3-%e4%b8%89%e6%a8%a1%e5%86%97%e4%bd%99%e6%9e%b6%e6%9e%84tmr aria-label="3. 三模冗余架构（TMR）">3. 三模冗余架构（TMR）</a></li></ul></li><li><a href=#%e6%a1%88%e4%be%8basil-d-%e7%b3%bb%e7%bb%9f%e7%9a%84%e4%b8%89%e6%a8%a1%e5%86%97%e4%bd%99%e6%9e%b6%e6%9e%84 aria-label="案例：ASIL D 系统的三模冗余架构">案例：ASIL D 系统的三模冗余架构</a></li></ul></li><li><a href=#%e7%a1%ac%e4%bb%b6%e8%af%a6%e7%bb%86%e8%ae%be%e8%ae%a1 aria-label=硬件详细设计>硬件详细设计</a><ul><li><a href=#%e7%94%b5%e8%b7%af%e8%ae%be%e8%ae%a1 aria-label=电路设计>电路设计</a><ul><li><a href=#%e5%8e%9f%e7%90%86%e5%9b%be%e8%ae%be%e8%ae%a1 aria-label=原理图设计>原理图设计</a></li><li><a href=#pcb-%e5%b8%83%e5%b1%80%e5%b8%83%e7%ba%bf aria-label="PCB 布局布线">PCB 布局布线</a></li></ul></li><li><a href=#%e5%85%83%e5%99%a8%e4%bb%b6%e9%80%89%e5%9e%8b aria-label=元器件选型>元器件选型</a><ul><li><a href=#%e5%85%83%e5%99%a8%e4%bb%b6%e9%80%89%e5%9e%8b%e7%9a%84%e5%8e%9f%e5%88%99 aria-label=元器件选型的原则>元器件选型的原则</a></li><li><a href=#%e5%85%83%e5%99%a8%e4%bb%b6%e7%9a%84%e5%8f%af%e9%9d%a0%e6%80%a7%e6%8c%87%e6%a0%87 aria-label=元器件的可靠性指标>元器件的可靠性指标</a></li><li><a href=#%e6%a1%88%e4%be%8bmcu-%e9%80%89%e5%9e%8b aria-label="案例：MCU 选型">案例：MCU 选型</a></li></ul></li><li><a href=#%e6%a1%88%e4%be%8b%e5%88%b6%e5%8a%a8%e7%b3%bb%e7%bb%9f%e7%9a%84%e7%a1%ac%e4%bb%b6%e8%af%a6%e7%bb%86%e8%ae%be%e8%ae%a1 aria-label=案例：制动系统的硬件详细设计>案例：制动系统的硬件详细设计</a><ul><li><a href=#%e5%8e%9f%e7%90%86%e5%9b%be%e8%ae%be%e8%ae%a1-1 aria-label=原理图设计>原理图设计</a></li><li><a href=#pcb-%e5%b8%83%e5%b1%80%e5%b8%83%e7%ba%bf-1 aria-label="PCB 布局布线">PCB 布局布线</a></li></ul></li></ul></li><li><a href=#%e7%a1%ac%e4%bb%b6%e6%9e%b6%e6%9e%84%e6%8c%87%e6%a0%87 aria-label=硬件架构指标>硬件架构指标</a><ul><li><a href=#1-%e5%8d%95%e7%82%b9%e6%95%85%e9%9a%9c%e5%ba%a6%e9%87%8fspfm aria-label="1. 单点故障度量（SPFM）">1. 单点故障度量（SPFM）</a></li><li><a href=#2-%e6%bd%9c%e5%9c%a8%e6%95%85%e9%9a%9c%e5%ba%a6%e9%87%8flfm aria-label="2. 潜在故障度量（LFM）">2. 潜在故障度量（LFM）</a></li><li><a href=#3-%e7%a1%ac%e4%bb%b6%e6%9e%b6%e6%9e%84%e5%ba%a6%e9%87%8fhf aria-label="3. 硬件架构度量（HF）">3. 硬件架构度量（HF）</a></li><li><a href=#%e6%a1%88%e4%be%8b%e5%88%b6%e5%8a%a8%e7%b3%bb%e7%bb%9f%e7%9a%84%e7%a1%ac%e4%bb%b6%e6%9e%b6%e6%9e%84%e6%8c%87%e6%a0%87%e8%ae%a1%e7%ae%97 aria-label=案例：制动系统的硬件架构指标计算>案例：制动系统的硬件架构指标计算</a></li></ul></li><li><a href=#fmeda-%e5%88%86%e6%9e%90 aria-label="FMEDA 分析">FMEDA 分析</a><ul><li><a href=#fmeda-%e7%9a%84%e5%ae%9a%e4%b9%89 aria-label="FMEDA 的定义">FMEDA 的定义</a></li><li><a href=#fmeda-%e7%9a%84%e6%ad%a5%e9%aa%a4 aria-label="FMEDA 的步骤">FMEDA 的步骤</a><ul><li><a href=#%e7%ac%ac%e4%b8%80%e6%ad%a5%e8%af%86%e5%88%ab%e7%a1%ac%e4%bb%b6%e7%bb%84%e4%bb%b6 aria-label=第一步：识别硬件组件>第一步：识别硬件组件</a></li><li><a href=#%e7%ac%ac%e4%ba%8c%e6%ad%a5%e8%af%86%e5%88%ab%e5%a4%b1%e6%95%88%e6%a8%a1%e5%bc%8f aria-label=第二步：识别失效模式>第二步：识别失效模式</a></li><li><a href=#%e7%ac%ac%e4%b8%89%e6%ad%a5%e5%88%86%e6%9e%90%e5%a4%b1%e6%95%88%e5%bd%b1%e5%93%8d aria-label=第三步：分析失效影响>第三步：分析失效影响</a></li><li><a href=#%e7%ac%ac%e5%9b%9b%e6%ad%a5%e5%88%86%e6%9e%90%e8%af%8a%e6%96%ad%e8%a6%86%e7%9b%96%e7%8e%87 aria-label=第四步：分析诊断覆盖率>第四步：分析诊断覆盖率</a></li><li><a href=#%e7%ac%ac%e4%ba%94%e6%ad%a5%e8%ae%a1%e7%ae%97%e7%a1%ac%e4%bb%b6%e6%9e%b6%e6%9e%84%e6%8c%87%e6%a0%87 aria-label=第五步：计算硬件架构指标>第五步：计算硬件架构指标</a></li></ul></li><li><a href=#fmeda-%e8%a1%a8%e6%a0%bc%e7%a4%ba%e4%be%8b aria-label="FMEDA 表格示例">FMEDA 表格示例</a></li><li><a href=#%e6%a1%88%e4%be%8b%e5%88%b6%e5%8a%a8%e7%b3%bb%e7%bb%9f%e7%9a%84-fmeda-%e5%88%86%e6%9e%90 aria-label="案例：制动系统的 FMEDA 分析">案例：制动系统的 FMEDA 分析</a><ul><li><a href=#%e7%ac%ac%e4%b8%80%e6%ad%a5%e8%af%86%e5%88%ab%e7%a1%ac%e4%bb%b6%e7%bb%84%e4%bb%b6-1 aria-label=第一步：识别硬件组件>第一步：识别硬件组件</a></li><li><a href=#%e7%ac%ac%e4%ba%8c%e6%ad%a5%e8%af%86%e5%88%ab%e5%a4%b1%e6%95%88%e6%a8%a1%e5%bc%8f-1 aria-label=第二步：识别失效模式>第二步：识别失效模式</a></li><li><a href=#%e7%ac%ac%e4%b8%89%e6%ad%a5%e5%88%86%e6%9e%90%e5%a4%b1%e6%95%88%e5%bd%b1%e5%93%8d-1 aria-label=第三步：分析失效影响>第三步：分析失效影响</a></li><li><a href=#%e7%ac%ac%e5%9b%9b%e6%ad%a5%e5%88%86%e6%9e%90%e8%af%8a%e6%96%ad%e8%a6%86%e7%9b%96%e7%8e%87-1 aria-label=第四步：分析诊断覆盖率>第四步：分析诊断覆盖率</a></li><li><a href=#%e7%ac%ac%e4%ba%94%e6%ad%a5%e8%ae%a1%e7%ae%97%e7%a1%ac%e4%bb%b6%e6%9e%b6%e6%9e%84%e6%8c%87%e6%a0%87-1 aria-label=第五步：计算硬件架构指标>第五步：计算硬件架构指标</a></li></ul></li></ul></li><li><a href=#%e7%a1%ac%e4%bb%b6%e9%9b%86%e6%88%90%e5%92%8c%e9%aa%8c%e8%af%81 aria-label=硬件集成和验证>硬件集成和验证</a><ul><li><a href=#%e7%a1%ac%e4%bb%b6%e9%9b%86%e6%88%90 aria-label=硬件集成>硬件集成</a></li><li><a href=#%e7%a1%ac%e4%bb%b6%e6%b5%8b%e8%af%95 aria-label=硬件测试>硬件测试</a><ul><li><a href=#%e6%b5%8b%e8%af%95%e7%b1%bb%e5%9e%8b aria-label=测试类型>测试类型</a></li></ul></li><li><a href=#%e6%a1%88%e4%be%8b%e5%88%b6%e5%8a%a8%e7%b3%bb%e7%bb%9f%e7%9a%84%e7%a1%ac%e4%bb%b6%e6%b5%8b%e8%af%95 aria-label=案例：制动系统的硬件测试>案例：制动系统的硬件测试</a></li></ul></li><li><a href=#%e5%ae%9e%e6%88%98%e6%a1%88%e4%be%8b%e7%94%b5%e5%8a%a8%e8%bd%a6%e7%94%b5%e6%b1%a0%e7%ae%a1%e7%90%86%e7%b3%bb%e7%bb%9fbms%e7%9a%84%e7%a1%ac%e4%bb%b6%e7%ba%a7%e5%bc%80%e5%8f%91 aria-label=实战案例：电动车电池管理系统（BMS）的硬件级开发>实战案例：电动车电池管理系统（BMS）的硬件级开发</a><ul><li><a href=#%e9%a1%b9%e7%9b%ae%e8%83%8c%e6%99%af aria-label=项目背景>项目背景</a></li><li><a href=#%e7%ac%ac%e4%b8%80%e6%ad%a5%e7%a1%ac%e4%bb%b6%e5%ae%89%e5%85%a8%e9%9c%80%e6%b1%82%e5%88%9d%e5%a7%8b%e5%8c%96 aria-label=第一步：硬件安全需求初始化>第一步：硬件安全需求初始化</a></li><li><a href=#%e7%ac%ac%e4%ba%8c%e6%ad%a5%e7%a1%ac%e4%bb%b6%e6%9e%b6%e6%9e%84%e8%ae%be%e8%ae%a1 aria-label=第二步：硬件架构设计>第二步：硬件架构设计</a></li><li><a href=#%e7%ac%ac%e4%b8%89%e6%ad%a5%e7%a1%ac%e4%bb%b6%e8%af%a6%e7%bb%86%e8%ae%be%e8%ae%a1 aria-label=第三步：硬件详细设计>第三步：硬件详细设计</a></li><li><a href=#%e7%ac%ac%e5%9b%9b%e6%ad%a5fmeda-%e5%88%86%e6%9e%90 aria-label="第四步：FMEDA 分析">第四步：FMEDA 分析</a></li><li><a href=#%e7%ac%ac%e4%ba%94%e6%ad%a5%e7%a1%ac%e4%bb%b6%e6%b5%8b%e8%af%95 aria-label=第五步：硬件测试>第五步：硬件测试</a></li></ul></li><li><a href=#%e5%b8%b8%e8%a7%81%e9%94%99%e8%af%af%e5%92%8c%e6%9c%80%e4%bd%b3%e5%ae%9e%e8%b7%b5 aria-label=常见错误和最佳实践>常见错误和最佳实践</a><ul><li><a href=#%e5%b8%b8%e8%a7%81%e9%94%99%e8%af%af aria-label=常见错误>常见错误</a></li><li><a href=#%e6%9c%80%e4%bd%b3%e5%ae%9e%e8%b7%b5 aria-label=最佳实践>最佳实践</a></li></ul></li><li><a href=#%e6%80%bb%e7%bb%93 aria-label=总结>总结</a></li><li><a href=#%e5%bb%b6%e4%bc%b8%e9%98%85%e8%af%bb aria-label=延伸阅读>延伸阅读</a></li></ul></div></details></div><div class=post-content><h2 id=引言>引言<a hidden class=anchor aria-hidden=true href=#引言>#</a></h2><p>在汽车电子系统中，硬件是功能安全的物理基础。无论软件多么完美，如果硬件设计存在缺陷，整个系统的安全性都会受到威胁。</p><p>想象一个真实场景：某汽车厂商的电动助力转向系统（EPS）采用了先进的控制算法，但由于选用的电机驱动芯片在高温环境下容易发生闩锁效应（latch-up），导致车辆在夏季高温天气中突然失去转向助力，造成了多起事故。</p><p>这个案例告诉我们：**硬件级开发不仅要满足性能要求，更要确保在所有预期的工作条件下都能安全运行。**这正是 ISO 26262-5 硬件级开发的核心使命。</p><h2 id=硬件级开发的目标和范围>硬件级开发的目标和范围<a hidden class=anchor aria-hidden=true href=#硬件级开发的目标和范围>#</a></h2><h3 id=硬件级开发的核心活动>硬件级开发的核心活动<a hidden class=anchor aria-hidden=true href=#硬件级开发的核心活动>#</a></h3><p>ISO 26262-5 定义了硬件级开发的七个核心活动：</p><ol><li><p><strong>硬件安全需求（HSR）的初始化</strong></p><ul><li>分析系统级安全需求</li><li>硬件架构的初步设计</li><li>硬件安全需求清单</li></ul></li><li><p><strong>硬件架构设计</strong></p><ul><li>设计硬件组件的架构</li><li>定义硬件组件之间的接口</li><li>评估硬件架构的适用性</li></ul></li><li><p><strong>硬件详细设计</strong></p><ul><li>电路设计</li><li>元器件选型</li><li>PCB 布局布线</li></ul></li><li><p><strong>硬件架构指标评估</strong></p><ul><li>单点故障度量（SPFM）</li><li>潜在故障度量（LFM）</li><li>硬件架构度量（HF）</li></ul></li><li><p><strong>FMEDA 分析</strong></p><ul><li>识别硬件失效模式</li><li>评估失效影响</li><li>计算硬件架构指标</li></ul></li><li><p><strong>硬件集成和验证</strong></p><ul><li>硬件原型制作</li><li>硬件测试</li><li>硬件验证</li></ul></li><li><p><strong>硬件生产</strong></p><ul><li>生产过程开发</li><li>生产质量控制</li></ul></li></ol><h3 id=硬件级开发的输入和输出>硬件级开发的输入和输出<a hidden class=anchor aria-hidden=true href=#硬件级开发的输入和输出>#</a></h3><h4 id=输入>输入<a hidden class=anchor aria-hidden=true href=#输入>#</a></h4><ul><li><strong>系统安全需求（SSyR）</strong>：来自系统级开发</li><li><strong>技术安全概念（TSC）</strong>：来自系统级开发</li><li><strong>硬件/软件接口规范（HSIS）</strong>：来自系统级开发</li><li><strong>硬件约束</strong>：成本、尺寸、功耗、温度范围等</li></ul><h4 id=输出>输出<a hidden class=anchor aria-hidden=true href=#输出>#</a></h4><ul><li><strong>硬件安全需求（HSR）</strong>：硬件级安全需求</li><li><strong>硬件架构设计文档</strong>：硬件架构设计</li><li><strong>硬件详细设计文档</strong>：电路设计、元器件清单</li><li><strong>FMEDA 报告</strong>：失效模式、影响和诊断分析</li><li><strong>硬件测试报告</strong>：测试结果</li><li><strong>硬件生产文档</strong>：生产流程、质量控制</li></ul><h2 id=硬件安全需求hsr的初始化>硬件安全需求（HSR）的初始化<a hidden class=anchor aria-hidden=true href=#硬件安全需求hsr的初始化>#</a></h2><h3 id=hsr-的来源>HSR 的来源<a hidden class=anchor aria-hidden=true href=#hsr-的来源>#</a></h3><p>硬件安全需求主要来自以下几个方面：</p><ol><li><strong>从系统级安全需求（SSyR）派生</strong></li><li><strong>从技术安全概念（TSC）派生</strong></li><li><strong>从硬件/软件接口规范（HSIS）派生</strong></li></ol><h3 id=hsr-的分类>HSR 的分类<a hidden class=anchor aria-hidden=true href=#hsr-的分类>#</a></h3><h4 id=1-功能性需求>1. 功能性需求<a hidden class=anchor aria-hidden=true href=#1-功能性需求>#</a></h4><p>描述硬件应该实现的功能。</p><h4 id=2-性能需求>2. 性能需求<a hidden class=anchor aria-hidden=true href=#2-性能需求>#</a></h4><p>描述硬件的性能指标，如响应时间、精度等。</p><h4 id=3-安全机制需求>3. 安全机制需求<a hidden class=anchor aria-hidden=true href=#3-安全机制需求>#</a></h4><p>描述硬件应该实现的安全机制，如看门狗、ECC 内存等。</p><h4 id=4-环境需求>4. 环境需求<a hidden class=anchor aria-hidden=true href=#4-环境需求>#</a></h4><p>描述硬件应该满足的环境条件，如温度、湿度、振动等。</p><h4 id=5-可靠性需求>5. 可靠性需求<a hidden class=anchor aria-hidden=true href=#5-可靠性需求>#</a></h4><p>描述硬件的可靠性要求，如 FIT 率、MTBF 等。</p><h3 id=案例制动系统的硬件安全需求>案例：制动系统的硬件安全需求<a hidden class=anchor aria-hidden=true href=#案例制动系统的硬件安全需求>#</a></h3><p><strong>来自 SSyR 的 HSR</strong>：</p><p><strong>HSR-1.1</strong>（来自 SSyR-1.1）：</p><blockquote><p>&ldquo;压力传感器的采样周期不得大于 10 ms&rdquo;</p></blockquote><p><strong>具体要求</strong>：</p><ul><li>采样频率 ≥ 100 Hz</li><li>ADC 转换时间 ≤ 5 ms</li><li>数据传输时间 ≤ 2 ms</li></ul><p><strong>HSR-1.2</strong>（来自 SSyR-1.3）：</p><blockquote><p>&ldquo;系统应实现压力传感器故障诊断算法&rdquo;</p></blockquote><p><strong>具体要求</strong>：</p><ul><li>硬件应支持开路检测</li><li>硬件应支持短路检测</li><li>硬件应支持信号范围检测</li></ul><p><strong>HSR-1.3</strong>（来自 SSyR-1.3.1）：</p><blockquote><p>&ldquo;硬件应实现独立于 CPU 的看门狗定时器&rdquo;</p></blockquote><p><strong>具体要求</strong>：</p><ul><li>看门狗类型：外部窗口看门狗</li><li>超时时间：可配置（默认 100 ms）</li><li>复位类型：系统复位</li><li>独立性：看门狗的时钟和电源应独立于 CPU</li></ul><h2 id=硬件架构设计>硬件架构设计<a hidden class=anchor aria-hidden=true href=#硬件架构设计>#</a></h2><h3 id=硬件架构设计的原则>硬件架构设计的原则<a hidden class=anchor aria-hidden=true href=#硬件架构设计的原则>#</a></h3><ol><li><strong>独立性原则</strong>：冗余硬件组件之间应该独立，避免共因故障</li><li><strong>多样性原则</strong>：不同冗余通道采用不同的实现方式</li><li><strong>诊断性原则</strong>：硬件应具备自诊断能力</li><li><strong>容错性原则</strong>：硬件应能容忍一定的故障</li></ol><h3 id=硬件架构的类型>硬件架构的类型<a hidden class=anchor aria-hidden=true href=#硬件架构的类型>#</a></h3><h4 id=1-单通道架构>1. 单通道架构<a hidden class=anchor aria-hidden=true href=#1-单通道架构>#</a></h4><p>适用于 ASIL A/B。</p><p><strong>优点</strong>：</p><ul><li>成本低</li><li>功耗低</li><li>空间小</li></ul><p><strong>缺点</strong>：</p><ul><li>安全性有限</li><li>单点故障可能导致危险失效</li></ul><h4 id=2-双通道冗余架构>2. 双通道冗余架构<a hidden class=anchor aria-hidden=true href=#2-双通道冗余架构>#</a></h4><p>适用于 ASIL C/D。</p><p><strong>优点</strong>：</p><ul><li>安全性高</li><li>可以容忍一个通道的故障</li></ul><p><strong>缺点</strong>：</p><ul><li>成本中等</li><li>功耗中等</li><li>空间中等</li></ul><h4 id=3-三模冗余架构tmr>3. 三模冗余架构（TMR）<a hidden class=anchor aria-hidden=true href=#3-三模冗余架构tmr>#</a></h4><p>适用于 ASIL D 高要求场景。</p><p><strong>优点</strong>：</p><ul><li>安全性最高</li><li>可以容忍一个通道的故障</li></ul><p><strong>缺点</strong>：</p><ul><li>成本高</li><li>功耗高</li><li>空间大</li></ul><h3 id=案例asil-d-系统的三模冗余架构>案例：ASIL D 系统的三模冗余架构<a hidden class=anchor aria-hidden=true href=#案例asil-d-系统的三模冗余架构>#</a></h3><p>对于 ASIL D 的电子驻车制动系统（EPB），采用三模冗余架构：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>           传感器
</span></span><span class=line><span class=cl>             │
</span></span><span class=line><span class=cl>    ┌────────┼────────┐
</span></span><span class=line><span class=cl>    │        │        │
</span></span><span class=line><span class=cl>  MCU1     MCU2     MCU3
</span></span><span class=line><span class=cl>    │        │        │
</span></span><span class=line><span class=cl>    └────────┼────────┘
</span></span><span class=line><span class=cl>             │
</span></span><span class=line><span class=cl>         投票器
</span></span><span class=line><span class=cl>             │
</span></span><span class=line><span class=cl>          执行器
</span></span></code></pre></div><p><strong>可靠性计算</strong>：</p><p>假设单个 MCU 的可靠度为 $R = 0.9999$（在任务时间内）。</p><p>系统成功运行的条件是：至少两个 MCU 正常工作。</p><p>$$ R_{\text{system}} = R^3 + 3 \times R^2 \times (1-R) $$</p><p>代入数值：
$$ R_{\text{system}} = 0.9999^3 + 3 \times 0.9999^2 \times 0.0001 $$
$$ R_{\text{system}} = 0.9997 + 0.00029997 $$
$$ R_{\text{system}} = 0.99999997 $$</p><p>可以看到，通过三模冗余，系统可靠度从 99.99% 提升到了 99.999997%。</p><h2 id=硬件详细设计>硬件详细设计<a hidden class=anchor aria-hidden=true href=#硬件详细设计>#</a></h2><h3 id=电路设计>电路设计<a hidden class=anchor aria-hidden=true href=#电路设计>#</a></h3><p>电路设计包括原理图设计和 PCB 布局布线。</p><h4 id=原理图设计>原理图设计<a hidden class=anchor aria-hidden=true href=#原理图设计>#</a></h4><p>原理图设计要点：</p><ol><li><strong>元器件选型</strong>：选择符合功能安全要求的元器件</li><li><strong>电路保护</strong>：添加过压、过流、防静电保护</li><li><strong>滤波和去耦</strong>：添加滤波电容、去耦电容</li><li><strong>信号完整性</strong>：考虑信号的阻抗匹配、串扰、反射等问题</li></ol><h4 id=pcb-布局布线>PCB 布局布线<a hidden class=anchor aria-hidden=true href=#pcb-布局布线>#</a></h4><p>PCB 布局布线要点：</p><ol><li><strong>元器件布局</strong>：考虑散热、EMC、信号完整性</li><li><strong>走线设计</strong>：考虑阻抗匹配、差分走线、地平面</li><li><strong>电源设计</strong>：考虑电源分配、去耦、纹波</li><li><strong>EMC 设计</strong>：考虑屏蔽、滤波、地平面</li></ol><h3 id=元器件选型>元器件选型<a hidden class=anchor aria-hidden=true href=#元器件选型>#</a></h3><h4 id=元器件选型的原则>元器件选型的原则<a hidden class=anchor aria-hidden=true href=#元器件选型的原则>#</a></h4><ol><li><strong>质量等级</strong>：选择汽车级或工业级元器件</li><li><strong>可靠性</strong>：选择低 FIT 率的元器件</li><li><strong>功能安全认证</strong>：选择有功能安全认证的元器件</li><li><strong>可获取性</strong>：选择长期可获取的元器件</li><li><strong>成本</strong>：在满足要求的前提下，选择成本合理的元器件</li></ol><h4 id=元器件的可靠性指标>元器件的可靠性指标<a hidden class=anchor aria-hidden=true href=#元器件的可靠性指标>#</a></h4><p><strong>FIT 率（Failure In Time）</strong>：每十亿小时内的故障次数。</p><p>$$ \text{FIT} = \frac{10^9}{\text{MTBF}} $$</p><p>其中，MTBF（Mean Time Between Failures）是平均故障间隔时间。</p><h4 id=案例mcu-选型>案例：MCU 选型<a hidden class=anchor aria-hidden=true href=#案例mcu-选型>#</a></h4><p>对于 ASIL D 的应用，MCU 选型要求：</p><table><thead><tr><th>要求</th><th>描述</th><th>示例</th></tr></thead><tbody><tr><td>功能安全认证</td><td>具备 ISO 26262 ASIL D 认证</td><td>Infineon AURIX TC3 系列</td></tr><tr><td>架构</td><td>双核或三核架构</td><td>双核 ARM Cortex-R52</td></tr><tr><td>内存</td><td>具备 ECC 保护的 Flash 和 RAM</td><td>4MB Flash + 512KB RAM</td></tr><tr><td>看门狗</td><td>独立于 CPU 的外部看门狗</td><td>内置窗口看门狗</td></tr><tr><td>FIT 率</td><td>FIT 率 ≤ 100</td><td>典型 FIT 率 10-50</td></tr></tbody></table><h3 id=案例制动系统的硬件详细设计>案例：制动系统的硬件详细设计<a hidden class=anchor aria-hidden=true href=#案例制动系统的硬件详细设计>#</a></h3><h4 id=原理图设计-1>原理图设计<a hidden class=anchor aria-hidden=true href=#原理图设计-1>#</a></h4><p><strong>MCU 电路</strong>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>        3.3V
</span></span><span class=line><span class=cl>         │
</span></span><span class=line><span class=cl>         │
</span></span><span class=line><span class=cl>    ┌────▼────┐
</span></span><span class=line><span class=cl>    │  MCU1   │
</span></span><span class=line><span class=cl>    │  ┌───┐  │
</span></span><span class=line><span class=cl>    │  │CPU│  │
</span></span><span class=line><span class=cl>    │  └───┘  │
</span></span><span class=line><span class=cl>    │  ┌───┐  │
</span></span><span class=line><span class=cl>    │  │RAM│  │
</span></span><span class=line><span class=cl>    │  │ECC│  │
</span></span><span class=line><span class=cl>    │  └───┘  │
</span></span><span class=line><span class=cl>    └────┬────┘
</span></span><span class=line><span class=cl>         │
</span></span><span class=line><span class=cl>        GND
</span></span></code></pre></div><p><strong>传感器电路</strong>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>    5V
</span></span><span class=line><span class=cl>     │
</span></span><span class=line><span class=cl>     │
</span></span><span class=line><span class=cl>    ┌▼────────────────────────────┐
</span></span><span class=line><span class=cl>    │   压力传感器                │
</span></span><span class=line><span class=cl>    │   ┌──────────────────────┐  │
</span></span><span class=line><span class=cl>    │   │  信号调理电路        │  │
</span></span><span class=line><span class=cl>    │   └──────────────────────┘  │
</span></span><span class=line><span class=cl>    └────────────┬────────────────┘
</span></span><span class=line><span class=cl>                 │
</span></span><span class=line><span class=cl>                 │ 0-5V 模拟信号
</span></span><span class=line><span class=cl>                 │
</span></span><span class=line><span class=cl>            ┌────▼────┐
</span></span><span class=line><span class=cl>            │  ADC    │
</span></span><span class=line><span class=cl>            └────┬────┘
</span></span><span class=line><span class=cl>                 │
</span></span><span class=line><span class=cl>                 │ 12-bit 数字信号
</span></span><span class=line><span class=cl>                 │
</span></span><span class=line><span class=cl>             ┌───▼───┐
</span></span><span class=line><span class=cl>             │ MCU1  │
</span></span><span class=line><span class=cl>             └───────┘
</span></span></code></pre></div><p><strong>看门狗电路</strong>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>    3.3V
</span></span><span class=line><span class=cl>     │
</span></span><span class=line><span class=cl>     │
</span></span><span class=line><span class=cl>  ┌──▼──┐
</span></span><span class=line><span class=cl>  │WDT  │
</span></span><span class=line><span class=cl>  │Timer│
</span></span><span class=line><span class=cl>  └──┬──┘
</span></span><span class=line><span class=cl>     │
</span></span><span class=line><span class=cl>     │ 复位信号
</span></span><span class=line><span class=cl>     │
</span></span><span class=line><span class=cl>  ┌──▼──┐
</span></span><span class=line><span class=cl>  │MCU1 │
</span></span><span class=line><span class=cl>  └──┬──┘
</span></span><span class=line><span class=cl>     │
</span></span><span class=line><span class=cl>     │ 喂狗信号
</span></span><span class=line><span class=cl>     │
</span></span><span class=line><span class=cl>  ┌──▼──┐
</span></span><span class=line><span class=cl>  │WDT  │
</span></span><span class=line><span class=cl>  │Timer│
</span></span><span class=line><span class=cl>  └──┬──┘
</span></span><span class=line><span class=cl>     │
</span></span><span class=line><span class=cl>    GND
</span></span></code></pre></div><h4 id=pcb-布局布线-1>PCB 布局布线<a hidden class=anchor aria-hidden=true href=#pcb-布局布线-1>#</a></h4><p><strong>分层设计</strong>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>┌────────────────────────────────┐
</span></span><span class=line><span class=cl>│ 第1层：信号层（Top Layer）       │
</span></span><span class=line><span class=cl>│ - MCU                            │
</span></span><span class=line><span class=cl>│ - 传感器                         │
</span></span><span class=line><span class=cl>│ - 看门狗                         │
</span></span><span class=line><span class=cl>├────────────────────────────────┤
</span></span><span class=line><span class=cl>│ 第2层：地层（Ground Plane）      │
</span></span><span class=line><span class=cl>│ - 完整地平面                     │
</span></span><span class=line><span class=cl>├────────────────────────────────┤
</span></span><span class=line><span class=cl>│ 第3层：电源层（Power Plane）     │
</span></span><span class=line><span class=cl>│ - 5V 电源平面                   │
</span></span><span class=line><span class=cl>│ - 3.3V 电源平面                 │
</span></span><span class=line><span class=cl>├────────────────────────────────┤
</span></span><span class=line><span class=cl>│ 第4层：信号层（Bottom Layer）     │
</span></span><span class=line><span class=cl>│ - 去耦电容                       │
</span></span><span class=line><span class=cl>│ - 测试点                         │
</span></span><span class=line><span class=cl>└────────────────────────────────┘
</span></span></code></pre></div><p><strong>去耦电容布局</strong>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>    5V
</span></span><span class=line><span class=cl>     │
</span></span><span class=line><span class=cl>     │
</span></span><span class=line><span class=cl>  ┌──▼──┐
</span></span><span class=line><span class=cl>  │ 10uF│
</span></span><span class=line><span class=cl>  │ 电容│
</span></span><span class=line><span class=cl>  └──┬──┘
</span></span><span class=line><span class=cl>     │
</span></span><span class=line><span class=cl>     │
</span></span><span class=line><span class=cl>  ┌──▼──┐
</span></span><span class=line><span class=cl>  │ 0.1uF│
</span></span><span class=line><span class=cl>  │ 电容│
</span></span><span class=line><span class=cl>  └──┬──┘
</span></span><span class=line><span class=cl>     │
</span></span><span class=line><span class=cl>     │
</span></span><span class=line><span class=cl>  ┌──▼──┐
</span></span><span class=line><span class=cl>  │ MCU1 │
</span></span><span class=line><span class=cl>  └──┬──┘
</span></span><span class=line><span class=cl>     │
</span></span><span class=line><span class=cl>    GND
</span></span></code></pre></div><h2 id=硬件架构指标>硬件架构指标<a hidden class=anchor aria-hidden=true href=#硬件架构指标>#</a></h2><div class=mermaid-wrapper style="background:#fff;padding:2rem 1rem;margin:2rem 0;border-radius:8px;box-shadow:0 2px 12px rgba(0,0,0,8%)"><div class=mermaid>graph LR
subgraph 硬件安全指标体系
Input[硬件设计] --> Metrics[硬件架构指标]
Metrics --> SPFM[单点故障度量<br>SPFM<br>单点故障覆盖率]
Metrics --> LFM[潜伏故障度量<br>LFM<br>潜伏故障覆盖率]
Metrics --> PMHF[随机硬件失效概率<br>PMHF<br>失效率]
end
Metrics --> ASIL{ASIL等级要求}
SPFM --> ASILB[ASIL B: ≥90%]
SPFM --> ASILC[ASIL C: ≥97%]
SPFM --> ASILD[ASIL D: ≥99%]
LFM --> LFM_B[ASIL B: ≥60%]
LFM --> LFM_C[ASIL C: ≥80%]
LFM --> LFM_D[ASIL D: ≥90%]
PMHF --> PMHF_B[ASIL B: ≤100 FIT]
PMHF --> PMHF_c[ASIL C: ≤100 FIT]
PMHF --> PMHF_d[ASIL D: ≤10 FIT]
style Input fill:#5AC8FA,stroke:#007AFF,stroke-width:2px,color:#ffffff
style Metrics fill:#AF52DE,stroke:#AF52DE,stroke-width:2px,color:#ffffff
style ASIL fill:#FF9500,stroke:#FF9500,stroke-width:2px,color:#ffffff
style SPFM fill:#34C759,stroke:#34C759,stroke-width:2px,color:#ffffff
style LFM fill:#34C759,stroke:#34C759,stroke-width:2px,color:#ffffff
style PMHF fill:#34C759,stroke:#34C759,stroke-width:2px,color:#ffffff
style ASILB fill:#30D158,stroke:#34C759,stroke-width:2px,color:#ffffff
style ASILC fill:#32D74B,stroke:#32D74B,stroke-width:2px,color:#ffffff
style ASILD fill:#007AFF,stroke:#007AFF,stroke-width:2px,color:#ffffff
style LFM_B fill:#30D158,stroke:#34C759,stroke-width:2px,color:#ffffff
style LFM_C fill:#32D74B,stroke:#32D74B,stroke-width:2px,color:#ffffff
style LFM_D fill:#007AFF,stroke:#007AFF,stroke-width:2px,color:#ffffff
style PMHF_B fill:#30D158,stroke:#34C759,stroke-width:2px,color:#ffffff
style PMHF_c fill:#32D74B,stroke:#32D74B,stroke-width:2px,color:#ffffff
style PMHF_d fill:#007AFF,stroke:#007AFF,stroke-width:2px,color:#ffffff</div></div><p>评估</p><p>ISO 26262-5 定义了三个硬件架构指标：</p><h3 id=1-单点故障度量spfm>1. 单点故障度量（SPFM）<a hidden class=anchor aria-hidden=true href=#1-单点故障度量spfm>#</a></h3><p><strong>SPFM（Single Point Fault Metric）</strong> 衡量的是系统对单点故障的防护能力。</p><p>$$ \text{SPFM} = \frac{\sum \lambda_{\text{SPF}} - \sum \lambda_{\text{RF}}}{\sum \lambda_{\text{SPF}}} \times 100% $$</p><p>其中：</p><ul><li>$\lambda_{\text{SPF}}$：单点故障率</li><li>$\lambda_{\text{RF}}$：未被安全机制覆盖的单点故障率</li></ul><p><strong>ASIL 要求</strong>：</p><table><thead><tr><th>ASIL 等级</th><th>SPFM 要求</th></tr></thead><tbody><tr><td>ASIL A</td><td>≥ 60%</td></tr><tr><td>ASIL B</td><td>≥ 90%</td></tr><tr><td>ASIL C</td><td>≥ 97%</td></tr><tr><td>ASIL D</td><td>≥ 99%</td></tr></tbody></table><h3 id=2-潜在故障度量lfm>2. 潜在故障度量（LFM）<a hidden class=anchor aria-hidden=true href=#2-潜在故障度量lfm>#</a></h3><p><strong>LFM（Latent Fault Metric）</strong> 衡量的是系统对潜在故障的检测能力。</p><p>$$ \text{LFM} = \frac{\sum \lambda_{\text{LF}} - \sum \lambda_{\text{RF}}}{\sum \lambda_{\text{LF}}} \times 100% $$</p><p>其中：</p><ul><li>$\lambda_{\text{LF}}$：潜在故障率</li><li>$\lambda_{\text{RF}}$：未被安全机制覆盖的潜在故障率</li></ul><p><strong>ASIL 要求</strong>：</p><table><thead><tr><th>ASIL 等级</th><th>LFM 要求</th></tr></thead><tbody><tr><td>ASIL A</td><td>不要求</td></tr><tr><td>ASIL B</td><td>≥ 60%</td></tr><tr><td>ASIL C</td><td>≥ 80%</td></tr><tr><td>ASIL D</td><td>≥ 90%</td></tr></tbody></table><h3 id=3-硬件架构度量hf>3. 硬件架构度量（HF）<a hidden class=anchor aria-hidden=true href=#3-硬件架构度量hf>#</a></h3><p><strong>HF（Hardware Architecture Metric）</strong> 结合了 SPFM 和 LFM，用于评估硬件架构的适用性。</p><p><strong>ASIL 要求</strong>：</p><table><thead><tr><th>ASIL 等级</th><th>HF 要求</th></tr></thead><tbody><tr><td>ASIL A</td><td>不要求</td></tr><tr><td>ASIL B</td><td>满足 SPFM 或 LFM</td></tr><tr><td>ASIL C</td><td>满足 SPFM 和 LFM</td></tr><tr><td>ASIL D</td><td>满足 SPFM 和 LFM</td></tr></tbody></table><h3 id=案例制动系统的硬件架构指标计算>案例：制动系统的硬件架构指标计算<a hidden class=anchor aria-hidden=true href=#案例制动系统的硬件架构指标计算>#</a></h3><p>假设制动系统的硬件组件包括：</p><table><thead><tr><th>组件</th><th>FIT 率</th><th>单点故障</th><th>潜在故障</th><th>安全机制覆盖</th></tr></thead><tbody><tr><td>MCU1</td><td>50</td><td>40</td><td>10</td><td>90%</td></tr><tr><td>MCU2</td><td>50</td><td>40</td><td>10</td><td>90%</td></tr><tr><td>压力传感器1</td><td>20</td><td>15</td><td>5</td><td>80%</td></tr><tr><td>压力传感器2</td><td>20</td><td>15</td><td>5</td><td>80%</td></tr><tr><td>阀门驱动器</td><td>30</td><td>25</td><td>5</td><td>70%</td></tr></tbody></table><p><strong>SPFM 计算</strong>：</p><p>$$ \sum \lambda_{\text{SPF}} = 40 + 40 + 15 + 15 + 25 = 135 \text{ FIT} $$</p><p>$$ \sum \lambda_{\text{RF}} = 40 \times (1 - 0.9) + 40 \times (1 - 0.9) + 15 \times (1 - 0.8) + 15 \times (1 - 0.8) + 25 \times (1 - 0.7) $$
$$ \sum \lambda_{\text{RF}} = 4 + 4 + 3 + 3 + 7.5 = 21.5 \text{ FIT} $$</p><p>$$ \text{SPFM} = \frac{135 - 21.5}{135} \times 100% = 84.07% $$</p><p><strong>LFM 计算</strong>：</p><p>$$ \sum \lambda_{\text{LF}} = 10 + 10 + 5 + 5 + 5 = 35 \text{ FIT} $$</p><p>$$ \sum \lambda_{\text{RF}} = 10 \times (1 - 0.9) + 10 \times (1 - 0.9) + 5 \times (1 - 0.8) + 5 \times (1 - 0.8) + 5 \times (1 - 0.7) $$
$$ \sum \lambda_{\text{RF}} = 1 + 1 + 1 + 1 + 1.5 = 5.5 \text{ FIT} $$</p><p>$$ \text{LFM} = \frac{35 - 5.5}{35} \times 100% = 84.29% $$</p><p><strong>结论</strong>：</p><ul><li>SPFM = 84.07%，满足 ASIL B 要求（≥ 90%），但不满足 ASIL C/D 要求</li><li>LFM = 84.29%，满足 ASIL C 要求（≥ 80%），但不满足 ASIL D 要求</li></ul><p>如果该系统的 ASIL 等级是 C，则满足要求。如果是 ASIL D，则需要改进安全机制，提高覆盖率。</p><h2 id=fmeda-分析>FMEDA 分析<a hidden class=anchor aria-hidden=true href=#fmeda-分析>#</a></h2><h3 id=fmeda-的定义>FMEDA 的定义<a hidden class=anchor aria-hidden=true href=#fmeda-的定义>#</a></h3><p><strong>FMEDA（Failure Modes, Effects and Diagnostic Analysis）</strong> 是一种用于分析硬件失效模式、影响和诊断能力的方法。</p><h3 id=fmeda-的步骤>FMEDA 的步骤<a hidden class=anchor aria-hidden=true href=#fmeda-的步骤>#</a></h3><h4 id=第一步识别硬件组件>第一步：识别硬件组件<a hidden class=anchor aria-hidden=true href=#第一步识别硬件组件>#</a></h4><p>列出系统中的所有硬件组件。</p><h4 id=第二步识别失效模式>第二步：识别失效模式<a hidden class=anchor aria-hidden=true href=#第二步识别失效模式>#</a></h4><p>对于每个硬件组件，识别其可能的失效模式。</p><h4 id=第三步分析失效影响>第三步：分析失效影响<a hidden class=anchor aria-hidden=true href=#第三步分析失效影响>#</a></h4><p>分析每个失效模式对系统的影响。</p><h4 id=第四步分析诊断覆盖率>第四步：分析诊断覆盖率<a hidden class=anchor aria-hidden=true href=#第四步分析诊断覆盖率>#</a></h4><p>分析现有安全机制对失效模式的诊断覆盖率。</p><h4 id=第五步计算硬件架构指标>第五步：计算硬件架构指标<a hidden class=anchor aria-hidden=true href=#第五步计算硬件架构指标>#</a></h4><p>计算 SPFM 和 LFM。</p><h3 id=fmeda-表格示例>FMEDA 表格示例<a hidden class=anchor aria-hidden=true href=#fmeda-表格示例>#</a></h3><table><thead><tr><th>组件</th><th>失效模式</th><th>失效率（FIT）</th><th>失效影响</th><th>安全机制</th><th>覆盖率</th></tr></thead><tbody><tr><td>MCU1</td><td>CPU 挂死</td><td>10</td><td>系统失效</td><td>看门狗</td><td>90%</td></tr><tr><td>MCU1</td><td>Flash 坏块</td><td>15</td><td>数据丢失</td><td>ECC</td><td>95%</td></tr><tr><td>MCU1</td><td>RAM 位翻转</td><td>20</td><td>计算错误</td><td>ECC + 定期检查</td><td>80%</td></tr><tr><td>MCU2</td><td>CPU 挂死</td><td>10</td><td>系统失效</td><td>看门狗</td><td>90%</td></tr><tr><td>MCU2</td><td>Flash 坏块</td><td>15</td><td>数据丢失</td><td>ECC</td><td>95%</td></tr><tr><td>压力传感器1</td><td>开路</td><td>5</td><td>信号丢失</td><td>开路检测</td><td>100%</td></tr><tr><td>压力传感器1</td><td>短路</td><td>5</td><td>信号错误</td><td>短路检测</td><td>100%</td></tr><tr><td>压力传感器1</td><td>漂移</td><td>10</td><td>测量误差</td><td>冗余传感器</td><td>60%</td></tr></tbody></table><h3 id=案例制动系统的-fmeda-分析>案例：制动系统的 FMEDA 分析<a hidden class=anchor aria-hidden=true href=#案例制动系统的-fmeda-分析>#</a></h3><h4 id=第一步识别硬件组件-1>第一步：识别硬件组件<a hidden class=anchor aria-hidden=true href=#第一步识别硬件组件-1>#</a></h4><p>制动系统的硬件组件：</p><ul><li>MCU1（主控制器）</li><li>MCU2（备份控制器）</li><li>压力传感器1</li><li>压力传感器2</li><li>阀门驱动器</li><li>看门狗定时器</li><li>电源管理芯片</li></ul><h4 id=第二步识别失效模式-1>第二步：识别失效模式<a hidden class=anchor aria-hidden=true href=#第二步识别失效模式-1>#</a></h4><p>以 MCU1 为例：</p><table><thead><tr><th>失效模式</th><th>描述</th><th>失效率（FIT）</th></tr></thead><tbody><tr><td>CPU 挂死</td><td>CPU 停止执行指令</td><td>10</td></tr><tr><td>Flash 坏块</td><td>Flash 存储单元损坏</td><td>15</td></tr><tr><td>RAM 位翻转</td><td>RAM 存储单元翻转</td><td>20</td></tr><tr><td>时钟故障</td><td>时钟信号异常</td><td>5</td></tr><tr><td>I/O 故障</td><td>I/O 引脚故障</td><td>10</td></tr></tbody></table><p><strong>总计</strong>：60 FIT</p><h4 id=第三步分析失效影响-1>第三步：分析失效影响<a hidden class=anchor aria-hidden=true href=#第三步分析失效影响-1>#</a></h4><table><thead><tr><th>失效模式</th><th>失效影响</th><th>危险等级</th></tr></thead><tbody><tr><td>CPU 挂死</td><td>系统停止响应</td><td>高</td></tr><tr><td>Flash 坏块</td><td>控制算法数据损坏</td><td>高</td></tr><tr><td>RAM 位翻转</td><td>计算结果错误</td><td>中</td></tr><tr><td>时钟故障</td><td>定时错误</td><td>高</td></tr><tr><td>I/O 故障</td><td>通信错误</td><td>中</td></tr></tbody></table><h4 id=第四步分析诊断覆盖率-1>第四步：分析诊断覆盖率<a hidden class=anchor aria-hidden=true href=#第四步分析诊断覆盖率-1>#</a></h4><table><thead><tr><th>失效模式</th><th>安全机制</th><th>覆盖率</th></tr></thead><tbody><tr><td>CPU 挂死</td><td>看门狗定时器</td><td>90%</td></tr><tr><td>Flash 坏块</td><td>ECC 校验</td><td>95%</td></tr><tr><td>RAM 位翻转</td><td>ECC 校验 + 定期检查</td><td>80%</td></tr><tr><td>时钟故障</td><td>时钟监测电路</td><td>70%</td></tr><tr><td>I/O 故障</td><td>回环测试</td><td>85%</td></tr></tbody></table><h4 id=第五步计算硬件架构指标-1>第五步：计算硬件架构指标<a hidden class=anchor aria-hidden=true href=#第五步计算硬件架构指标-1>#</a></h4><p><strong>单点故障（SPF）</strong>：</p><ul><li>CPU 挂死：10 FIT</li><li>Flash 坏块：15 FIT</li><li>时钟故障：5 FIT</li><li>I/O 故障：10 FIT</li></ul><p><strong>潜在故障（LF）</strong>：</p><ul><li>RAM 位翻转：20 FIT</li></ul><p><strong>SPFM 计算</strong>：</p><p>$$ \sum \lambda_{\text{SPF}} = 10 + 15 + 5 + 10 = 40 \text{ FIT} $$</p><p>$$ \sum \lambda_{\text{RF}} = 10 \times (1 - 0.9) + 15 \times (1 - 0.95) + 5 \times (1 - 0.7) + 10 \times (1 - 0.85) $$
$$ \sum \lambda_{\text{RF}} = 1 + 0.75 + 1.5 + 1.5 = 4.75 \text{ FIT} $$</p><p>$$ \text{SPFM} = \frac{40 - 4.75}{40} \times 100% = 88.125% $$</p><p><strong>LFM 计算</strong>：</p><p>$$ \sum \lambda_{\text{LF}} = 20 \text{ FIT} $$</p><p>$$ \sum \lambda_{\text{RF}} = 20 \times (1 - 0.8) = 4 \text{ FIT} $$</p><p>$$ \text{LFM} = \frac{20 - 4}{20} \times 100% = 80% $$</p><p><strong>结论</strong>：</p><ul><li>SPFM = 88.125%，满足 ASIL B 要求（≥ 90%），但不满足 ASIL C/D 要求</li><li>LFM = 80%，满足 ASIL C 要求（≥ 80%），但不满足 ASIL D 要求</li></ul><p>如果该系统的 ASIL 等级是 C，则满足要求。如果是 ASIL D，则需要改进安全机制，特别是提高时钟故障和 I/O 故障的诊断覆盖率。</p><h2 id=硬件集成和验证>硬件集成和验证<a hidden class=anchor aria-hidden=true href=#硬件集成和验证>#</a></h2><h3 id=硬件集成>硬件集成<a hidden class=anchor aria-hidden=true href=#硬件集成>#</a></h3><p>硬件集成的步骤：</p><ol><li><strong>原型制作</strong>：制作硬件原型板</li><li><strong>硬件测试</strong>：测试硬件的基本功能</li><li><strong>硬件验证</strong>：验证硬件满足设计要求</li><li><strong>硬件确认</strong>：确认硬件满足安全需求</li></ol><h3 id=硬件测试>硬件测试<a hidden class=anchor aria-hidden=true href=#硬件测试>#</a></h3><h4 id=测试类型>测试类型<a hidden class=anchor aria-hidden=true href=#测试类型>#</a></h4><ol><li><p><strong>功能测试</strong>：</p><ul><li>测试硬件的基本功能</li><li>测试硬件的性能指标</li></ul></li><li><p><strong>环境测试</strong>：</p><ul><li>温度测试（高温、低温、温度循环）</li><li>湿度测试</li><li>振动测试</li><li>EMC 测试</li></ul></li><li><p><strong>可靠性测试</strong>：</p><ul><li>寿命测试</li><li>加速寿命测试</li></ul></li><li><p><strong>安全测试</strong>：</p><ul><li>故障注入测试</li><li>安全机制测试</li></ul></li></ol><h3 id=案例制动系统的硬件测试>案例：制动系统的硬件测试<a hidden class=anchor aria-hidden=true href=#案例制动系统的硬件测试>#</a></h3><p><strong>测试用例 1：MCU 看门狗测试</strong></p><p><strong>测试目的</strong>：验证看门狗定时器能够检测到 CPU 挂死。</p><p><strong>测试步骤</strong>：</p><ol><li>系统上电初始化</li><li>正常运行，喂狗</li><li>模拟 CPU 挂死（停止喂狗）</li><li>等待看门狗超时</li><li>检查系统是否复位</li></ol><p><strong>预期结果</strong>：</p><ul><li>看门狗超时时间到后，系统复位</li></ul><p><strong>测试用例 2：压力传感器开路测试</strong></p><p><strong>测试目的</strong>：验证压力传感器开路检测功能。</p><p><strong>测试步骤</strong>：</p><ol><li>系统上电初始化</li><li>正常运行，读取压力传感器数据</li><li>断开压力传感器1（模拟开路故障）</li><li>等待诊断周期</li><li>检查系统是否检测到开路故障</li></ol><p><strong>预期结果</strong>：</p><ul><li>系统在诊断周期内检测到压力传感器1开路故障</li><li>系统切换到压力传感器2</li><li>系统向驾驶员发出报警</li></ul><p><strong>测试用例 3：RAM 位翻转测试</strong></p><p><strong>测试目的</strong>：验证 ECC 能够检测和纠正 RAM 位翻转。</p><p><strong>测试步骤</strong>：</p><ol><li>系统上电初始化</li><li>向 RAM 写入已知数据</li><li>使用硬件故障注入工具注入位翻转</li><li>读取 RAM 数据</li><li>检查 ECC 是否检测到位翻转并纠正</li></ol><p><strong>预期结果</strong>：</p><ul><li>ECC 检测到位翻转</li><li>ECC 纠正位翻转</li><li>系统记录错误</li></ul><h2 id=实战案例电动车电池管理系统bms的硬件级开发>实战案例：电动车电池管理系统（BMS）的硬件级开发<a hidden class=anchor aria-hidden=true href=#实战案例电动车电池管理系统bms的硬件级开发>#</a></h2><p>让我们以一个实际项目为例，展示硬件级开发的完整流程。</p><h3 id=项目背景>项目背景<a hidden class=anchor aria-hidden=true href=#项目背景>#</a></h3><p>某电动车厂商正在开发新一代 BMS，用于管理 400V/80kWh 的动力电池包。ASIL 等级：C。</p><h3 id=第一步硬件安全需求初始化>第一步：硬件安全需求初始化<a hidden class=anchor aria-hidden=true href=#第一步硬件安全需求初始化>#</a></h3><p><strong>来自系统级开发的 HSR</strong>：</p><p><strong>HSR-1.1</strong>：</p><blockquote><p>&ldquo;BMS 应每 10 ms 读取一次所有单体电池电压&rdquo;</p></blockquote><p><strong>具体要求</strong>：</p><ul><li>电压采样频率 ≥ 100 Hz</li><li>采样精度 ≥ 5 mV</li><li>采样通道数 ≥ 96（假设 96 个单体电池）</li></ul><p><strong>HSR-1.2</strong>：</p><blockquote><p>&ldquo;BMS 应实现过温保护，当电池温度超过 60°C 时切断充电&rdquo;</p></blockquote><p><strong>具体要求</strong>：</p><ul><li>温度采样频率 ≥ 10 Hz</li><li>温度精度 ≥ 1°C</li><li>温度检测点数 ≥ 32（假设 32 个温度传感器）</li></ul><p><strong>HSR-1.3</strong>：</p><blockquote><p>&ldquo;BMS 应实现过充保护，当电池电压超过 4.2V 时切断充电&rdquo;</p></blockquote><p><strong>具体要求</strong>：</p><ul><li>电压采样实时性：采样 + 判断 ≤ 20 ms</li><li>切断充电时间：≤ 50 ms</li></ul><h3 id=第二步硬件架构设计>第二步：硬件架构设计<a hidden class=anchor aria-hidden=true href=#第二步硬件架构设计>#</a></h3><p><strong>双通道冗余架构</strong>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>                    电池模组
</span></span><span class=line><span class=cl>                      │
</span></span><span class=line><span class=cl>          ┌───────────┼───────────┐
</span></span><span class=line><span class=cl>          │           │           │
</span></span><span class=line><span class=cl>       模组1       模组2        模组N
</span></span><span class=line><span class=cl>          │           │           │
</span></span><span class=line><span class=cl>    ┌─────┼─────┐ ┌───┼─────┐ ┌──┼─────┐
</span></span><span class=line><span class=cl>    │单体电池单体│ │单体电池单体│ │单体电池单体│
</span></span><span class=line><span class=cl>    │电压监测   │ │电压监测   │ │电压监测   │
</span></span><span class=line><span class=cl>    │温度监测   │ │温度监测   │ │温度监测   │
</span></span><span class=line><span class=cl>    └─────┬─────┘ └───┬─────┘ └──┬─────┘
</span></span><span class=line><span class=cl>          │           │           │
</span></span><span class=line><span class=cl>          └───────────┼───────────┘
</span></span><span class=line><span class=cl>                      │
</span></span><span class=line><span class=cl>                ┌─────┴─────┐
</span></span><span class=line><span class=cl>                │  模组控制器│
</span></span><span class=line><span class=cl>                │  （MCU）   │
</span></span><span class=line><span class=cl>                └─────┬─────┘
</span></span><span class=line><span class=cl>                      │
</span></span><span class=line><span class=cl>                ┌─────┴─────┐
</span></span><span class=line><span class=cl>                │ 主控制器  │
</span></span><span class=line><span class=cl>                │  （MCU）  │
</span></span><span class=line><span class=cl>                └─────┬─────┘
</span></span><span class=line><span class=cl>                      │
</span></span><span class=line><span class=cl>                ┌─────┴─────┐
</span></span><span class=line><span class=cl>                │ 安全监控器│
</span></span><span class=line><span class=cl>                └──────────┘
</span></span></code></pre></div><h3 id=第三步硬件详细设计>第三步：硬件详细设计<a hidden class=anchor aria-hidden=true href=#第三步硬件详细设计>#</a></h3><p><strong>模组控制器电路</strong>：</p><ul><li><strong>MCU</strong>：Infineon XMC4200（ASIL B 认证）</li><li><strong>ADC</strong>：TI ADS1118（16-bit，4 通道）</li><li><strong>温度传感器</strong>：NTC 10kΩ（β = 3950）</li><li><strong>通信</strong>：隔离 CAN（ISO 1050）</li></ul><p><strong>主控制器电路</strong>：</p><ul><li><strong>MCU</strong>：Infineon AURIX TC377（ASIL D 认证）</li><li><strong>看门狗</strong>：Maxim MAX6370（窗口看门狗）</li><li><strong>通信</strong>：双 CAN（CAN 1 + CAN 2）</li><li><strong>电源</strong>：隔离 DC/DC 转换器</li></ul><h3 id=第四步fmeda-分析>第四步：FMEDA 分析<a hidden class=anchor aria-hidden=true href=#第四步fmeda-分析>#</a></h3><p><strong>MCU 失效模式分析</strong>：</p><table><thead><tr><th>失效模式</th><th>失效率（FIT）</th><th>单点/潜在</th><th>安全机制</th><th>覆盖率</th></tr></thead><tbody><tr><td>CPU 挂死</td><td>10</td><td>单点</td><td>看门狗</td><td>95%</td></tr><tr><td>Flash 坏块</td><td>15</td><td>潜在</td><td>ECC + 自检</td><td>90%</td></tr><tr><td>RAM 位翻转</td><td>20</td><td>潜在</td><td>ECC + 定期检查</td><td>85%</td></tr><tr><td>时钟故障</td><td>5</td><td>单点</td><td>时钟监测</td><td>80%</td></tr></tbody></table><p><strong>ADC 失效模式分析</strong>：</p><table><thead><tr><th>失效模式</th><th>失效率（FIT）</th><th>单点/潜在</th><th>安全机制</th><th>覆盖率</th></tr></thead><tbody><tr><td>采样错误</td><td>5</td><td>单点</td><td>冗余 ADC</td><td>90%</td></tr><tr><td>偏移漂移</td><td>3</td><td>潜在</td><td>定期校准</td><td>70%</td></tr></tbody></table><p><strong>SPFM 计算</strong>：</p><p>$$ \sum \lambda_{\text{SPF}} = 10 + 5 = 15 \text{ FIT} $$</p><p>$$ \sum \lambda_{\text{RF}} = 10 \times (1 - 0.95) + 5 \times (1 - 0.9) = 0.5 + 0.5 = 1 \text{ FIT} $$</p><p>$$ \text{SPFM} = \frac{15 - 1}{15} \times 100% = 93.33% $$</p><p><strong>LFM 计算</strong>：</p><p>$$ \sum \lambda_{\text{LF}} = 15 + 20 + 3 = 38 \text{ FIT} $$</p><p>$$ \sum \lambda_{\text{RF}} = 15 \times (1 - 0.9) + 20 \times (1 - 0.85) + 3 \times (1 - 0.7) $$
$$ \sum \lambda_{\text{RF}} = 1.5 + 3 + 0.9 = 5.4 \text{ FIT} $$</p><p>$$ \text{LFM} = \frac{38 - 5.4}{38} \times 100% = 85.79% $$</p><p><strong>结论</strong>：</p><ul><li>SPFM = 93.33%，满足 ASIL C 要求（≥ 97%？不对，看下表）</li><li>等等，让我重新检查 ASIL 要求</li></ul><table><thead><tr><th>ASIL 等级</th><th>SPFM 要求</th><th>LFM 要求</th></tr></thead><tbody><tr><td>ASIL A</td><td>≥ 60%</td><td>不要求</td></tr><tr><td>ASIL B</td><td>≥ 90%</td><td>≥ 60%</td></tr><tr><td>ASIL C</td><td>≥ 97%</td><td>≥ 80%</td></tr><tr><td>ASIL D</td><td>≥ 99%</td><td>≥ 90%</td></tr></tbody></table><p>所以 SPFM = 93.33% 满足 ASIL B 要求，但不满足 ASIL C 要求（≥ 97%）。
LFM = 85.79% 满足 ASIL C 要求（≥ 80%）。</p><p>如果系统的 ASIL 等级是 C，则 SPFM 不满足要求，需要改进安全机制，提高覆盖率。</p><h3 id=第五步硬件测试>第五步：硬件测试<a hidden class=anchor aria-hidden=true href=#第五步硬件测试>#</a></h3><p><strong>测试用例 1：电压采样精度测试</strong></p><p><strong>测试目的</strong>：验证电压采样精度 ≥ 5 mV。</p><p><strong>测试步骤</strong>：</p><ol><li>使用标准电压源施加已知电压</li><li>读取 BMS 采样值</li><li>计算误差</li><li>重复测试多个电压点</li></ol><p><strong>预期结果</strong>：</p><ul><li>所有采样点的误差 ≤ 5 mV</li></ul><p><strong>测试用例 2：过温保护测试</strong></p><p><strong>测试目的</strong>：验证过温保护功能。</p><p><strong>测试步骤</strong>：</p><ol><li>系统上电初始化</li><li>模拟温度升高（使用温度箱）</li><li>当温度超过 60°C 时，检查系统是否切断充电</li><li>检查切断时间 ≤ 50 ms</li></ol><p><strong>预期结果</strong>：</p><ul><li>温度 > 60°C 时，系统切断充电</li><li>切断时间 ≤ 50 ms</li></ul><h2 id=常见错误和最佳实践>常见错误和最佳实践<a hidden class=anchor aria-hidden=true href=#常见错误和最佳实践>#</a></h2><h3 id=常见错误>常见错误<a hidden class=anchor aria-hidden=true href=#常见错误>#</a></h3><ol><li><p><strong>硬件架构设计不合理</strong></p><ul><li>冗余设计不足</li><li>缺乏独立性</li><li>共因故障未考虑</li></ul></li><li><p><strong>元器件选型不当</strong></p><ul><li>选用了非汽车级元器件</li><li>忽视了功能安全认证</li><li>可靠性数据不准确</li></ul></li><li><p><strong>FMEDA 分析不完整</strong></p><ul><li>未识别所有失效模式</li><li>安全机制覆盖率过高估计</li><li>硬件架构指标计算错误</li></ul></li><li><p><strong>硬件测试不充分</strong></p><ul><li>只测试正常场景</li><li>未进行故障注入测试</li><li>环境测试不全面</li></ul></li></ol><h3 id=最佳实践>最佳实践<a hidden class=anchor aria-hidden=true href=#最佳实践>#</a></h3><ol><li><p><strong>使用专业的 FMEDA 工具</strong></p><ul><li>如 Reliasoft FMEDA、Isograph Reliability Workbench</li><li>提高分析效率和准确性</li></ul></li><li><p><strong>参考元器件厂商的 FMEDA 报告</strong></p><ul><li>MCU、传感器等厂商通常提供 FMEDA 报告</li><li>可以作为分析的参考</li></ul></li><li><p><strong>充分的硬件测试</strong></p><ul><li>覆盖所有失效模式</li><li>使用硬件故障注入工具</li><li>进行全面的可靠性测试</li></ul></li><li><p><strong>建立失效案例库</strong></p><ul><li>记录实际发生的故障</li><li>定期回顾和更新 FMEDA</li></ul></li></ol><h2 id=总结>总结<a hidden class=anchor aria-hidden=true href=#总结>#</a></h2><p>ISO 26262-5 硬件级开发是构建安全的硬件基础的关键环节。通过本文的深入解读和丰富的案例实践，我们掌握了：</p><ol><li><p><strong>硬件安全需求（HSR）的初始化</strong>：</p><ul><li>HSR 的来源和分类</li><li>HSR 的制定方法</li></ul></li><li><p><strong>硬件架构设计</strong>：</p><ul><li>硬件架构设计的原则</li><li>单通道、双通道、三模冗余架构</li><li>三模冗余的可靠性计算</li></ul></li><li><p><strong>硬件详细设计</strong>：</p><ul><li>电路设计（原理图设计、PCB 布局布线）</li><li>元器件选型</li><li>制动系统的硬件设计实例</li></ul></li><li><p><strong>硬件架构指标评估</strong>：</p><ul><li>SPFM（单点故障度量）的计算</li><li>LFM（潜在故障度量）的计算</li><li>HF（硬件架构度量）</li><li>ASIL 要求对照</li></ul></li><li><p><strong>FMEDA 分析</strong>：</p><ul><li>FMEDA 的五个步骤</li><li>FMEDA 表格的制作</li><li>制动系统的 FMEDA 实践</li></ul></li><li><p><strong>硬件集成和验证</strong>：</p><ul><li>硬件集成的步骤</li><li>硬件测试的类型</li><li>制动系统的测试用例</li></ul></li><li><p><strong>实战案例</strong>：</p><ul><li>BMS 硬件级开发完整实践</li></ul></li></ol><p><strong>核心要点</strong>：</p><ul><li>硬件是功能安全的物理基础，必须确保安全可靠</li><li>硬件架构设计必须考虑独立性、多样性和诊断性</li><li>FMEDA 是评估硬件安全性的重要方法，必须认真执行</li><li>硬件架构指标（SPFM、LFM）必须满足 ASIL 要求</li><li>充分的硬件测试是确保硬件安全的关键</li></ul><p>在下一篇文章中，我们将深入解读 ISO 26262-6 软件级开发部分，学习如何设计和开发安全的软件。</p><h2 id=延伸阅读>延伸阅读<a hidden class=anchor aria-hidden=true href=#延伸阅读>#</a></h2><ul><li><a href=../2026-01-16-iso26262-1-vocabulary>ISO 26262-1: 词汇</a></li><li><a href=../2026-01-16-iso26262-2-management>ISO 26262-2: 功能安全管理</a></li><li><a href=../2026-01-16-iso26262-4-system>ISO 26262-4: 系统级开发</a></li><li><a href=../2026-01-16-iso26262-6-software>ISO 26262-6: 软件级开发</a></li><li><a href=../2026-01-16-iso26262-overview>ISO 26262 整体综述</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://s-ai-unix.github.io/tags/iso-26262/>ISO 26262</a></li><li><a href=https://s-ai-unix.github.io/tags/%E5%8A%9F%E8%83%BD%E5%AE%89%E5%85%A8/>功能安全</a></li></ul><nav class=paginav><a class=prev href=https://s-ai-unix.github.io/posts/2026-01-10-iso26262-4-system/><span class=title>« Prev</span><br><span>ISO 26262-4 系统级开发：从概念到实现</span>
</a><a class=next href=https://s-ai-unix.github.io/posts/2026-01-08-iso26262-6-software/><span class=title>Next »</span><br><span>ISO 26262-6 软件级开发：编写安全的代码</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share ISO 26262-5 硬件级开发：构建安全的硬件基础 on x" href="https://x.com/intent/tweet/?text=ISO%2026262-5%20%e7%a1%ac%e4%bb%b6%e7%ba%a7%e5%bc%80%e5%8f%91%ef%bc%9a%e6%9e%84%e5%bb%ba%e5%ae%89%e5%85%a8%e7%9a%84%e7%a1%ac%e4%bb%b6%e5%9f%ba%e7%a1%80&amp;url=https%3a%2f%2fs-ai-unix.github.io%2fposts%2f2026-01-09-iso26262-5-hardware%2f&amp;hashtags=ISO26262%2c%e5%8a%9f%e8%83%bd%e5%ae%89%e5%85%a8"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share ISO 26262-5 硬件级开发：构建安全的硬件基础 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fs-ai-unix.github.io%2fposts%2f2026-01-09-iso26262-5-hardware%2f&amp;title=ISO%2026262-5%20%e7%a1%ac%e4%bb%b6%e7%ba%a7%e5%bc%80%e5%8f%91%ef%bc%9a%e6%9e%84%e5%bb%ba%e5%ae%89%e5%85%a8%e7%9a%84%e7%a1%ac%e4%bb%b6%e5%9f%ba%e7%a1%80&amp;summary=ISO%2026262-5%20%e7%a1%ac%e4%bb%b6%e7%ba%a7%e5%bc%80%e5%8f%91%ef%bc%9a%e6%9e%84%e5%bb%ba%e5%ae%89%e5%85%a8%e7%9a%84%e7%a1%ac%e4%bb%b6%e5%9f%ba%e7%a1%80&amp;source=https%3a%2f%2fs-ai-unix.github.io%2fposts%2f2026-01-09-iso26262-5-hardware%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share ISO 26262-5 硬件级开发：构建安全的硬件基础 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fs-ai-unix.github.io%2fposts%2f2026-01-09-iso26262-5-hardware%2f&title=ISO%2026262-5%20%e7%a1%ac%e4%bb%b6%e7%ba%a7%e5%bc%80%e5%8f%91%ef%bc%9a%e6%9e%84%e5%bb%ba%e5%ae%89%e5%85%a8%e7%9a%84%e7%a1%ac%e4%bb%b6%e5%9f%ba%e7%a1%80"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share ISO 26262-5 硬件级开发：构建安全的硬件基础 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fs-ai-unix.github.io%2fposts%2f2026-01-09-iso26262-5-hardware%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentColor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li></ul></footer><script src=https://giscus.app/client.js data-repo=s-ai-unix/blog data-repo-id=R_kgDOQ3Njaw data-category=General data-category-id=DIC_kwDOQ3Nja84C0yve data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=bottom data-theme=preferred_color_scheme data-lang=zh-CN data-loading=lazy crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2026 <a href=https://s-ai-unix.github.io/>s-ai-unix's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>(function(){"use strict";function e(){var e=document.querySelectorAll("p, li, td, div, span, h1, h2, h3, h4, h5, h6, ol, ul");e.forEach(function(e){if(e.classList.contains("classical-quote-container")||e.classList.contains("quote-text")||e.closest(".classical-quote-container"))return;var n,t=e.innerHTML,s=!1;for(t.indexOf("<em>")!==-1&&(n=t.replace(/\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$/g,function(e,t,n,s){return/^[\d.,]+$/.test((t+n+s).replace(/[.,]/g,""))?e:"$"+t+"_"+n+s+"$"}),n=n.replace(/\$\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$\$/g,function(e,t,n,s){return"$$"+t+"_"+n+s+"$$"}),n!==t&&(t=n,s=!0)),t.indexOf("</em>")!==-1&&(n=t.replace(/\$([^$]*?)<\/em>([^$]*?)\$/g,function(e,t,n){return"$"+t+"_{"+n+"$"}),n=n.replace(/\$\$([^$]*?)<\/em>([^$]*?)\$\$/g,function(e,t,n){return"$$"+t+"_{"+n+"$$"}),n!==t&&(t=n,s=!0)),t.indexOf("<em>$")!==-1&&(n=t.replace(/<em>\$/g,"$"),n!==t&&(t=n,s=!0)),t.indexOf("</em>$")!==-1&&(n=t.replace(/<\/em>\$/g,"$"),n!==t&&(t=n,s=!0));t.indexOf("<em>")!==-1&&t.indexOf("</em>")!==-1;){if(n=t.replace(/\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$/g,function(e,t,n,s){return/^[\d.,]+$/.test((t+n+s).replace(/[.,]/g,""))?e:"$"+t+"_"+n+s+"$"}),n=n.replace(/\$\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$\$/g,function(e,t,n,s){return"$$"+t+"_"+n+s+"$$"}),n===t)break;t=n,s=!0}t.indexOf("_{")!==-1&&(n=t.replace(/_{/g,"_{"),n!==t&&(t=n,s=!0)),t.indexOf("}_")!==-1&&(n=t.replace(/}_/g,"}"),n!==t&&(t=n,s=!0)),t.indexOf("\\\\")!==-1&&(n=t.replace(/(\$\{1,2\})([^$]*?)(\$\{1,2\})/g,function(e,t,n,s){for(;n.indexOf("\\\\")!==-1;)n=n.replace(/\\\\/g,"\\");return t+n+s}),n!==t&&(t=n,s=!0)),s&&(e.innerHTML=t)})}window.MathJax={tex:{inlineMath:[["$","$"]],displayMath:[["$$","$$"]],processEscapes:!0,processEnvironments:!0,tags:"ams",macros:{oiint:"\\mathop{∯}",oiiint:"\\mathop{∰}"}},options:{skipHtmlTags:["script","noscript","style","textarea","pre","code"]},startup:{pageReady:function(){return e(),MathJax.startup.defaultPageReady().then(function(){console.log("MathJax formulas rendered successfully")})}}}})()</script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link rel=stylesheet href=/css/mermaid-custom.css><script src=/js/mermaid-converter.js></script><script type=module>
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';

  
  setTimeout(() => {
    mermaid.initialize({
      startOnLoad: true,
      theme: 'base',
      themeVariables: {
        primaryColor: '#e3f2fd',
        primaryTextColor: '#1565c0',
        primaryBorderColor: '#2196f3',
        lineColor: '#42a5f5',
        secondaryColor: '#f3e5f5',
        tertiaryColor: '#fff9c4',
        background: '#ffffff',
        mainBkg: '#ffffff',
        nodeBorder: '#2196f3',
        clusterBkg: '#ffffff',
        clusterBorder: '#e0e0e0',
        titleColor: '#1565c0',
        edgeLabelBackground: '#fafafa',
      },
      securityLevel: 'loose',
    });
  }, 100);
</script><script src=/js/toc.js></script><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script><script>(function(){"use strict";function e(){var e=document.querySelectorAll("p, li, td, div, span, h1, h2, h3, h4, h5, h6, ol, ul");e.forEach(function(e){if(e.classList.contains("classical-quote-container")||e.classList.contains("quote-text")||e.closest(".classical-quote-container"))return;var n,t=e.innerHTML,s=!1;for(t.indexOf("<em>")!==-1&&(n=t.replace(/\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$/g,function(e,t,n,s){return/^[\d.,]+$/.test((t+n+s).replace(/[.,]/g,""))?e:"$"+t+"_"+n+s+"$"}),n=n.replace(/\$\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$\$/g,function(e,t,n,s){return"$$"+t+"_"+n+s+"$$"}),n!==t&&(t=n,s=!0)),t.indexOf("</em>")!==-1&&(n=t.replace(/\$([^$]*?)<\/em>([^$]*?)\$/g,function(e,t,n){return"$"+t+"_{"+n+"$"}),n=n.replace(/\$\$([^$]*?)<\/em>([^$]*?)\$\$/g,function(e,t,n){return"$$"+t+"_{"+n+"$$"}),n!==t&&(t=n,s=!0)),t.indexOf("<em>$")!==-1&&(n=t.replace(/<em>\$/g,"$"),n!==t&&(t=n,s=!0)),t.indexOf("</em>$")!==-1&&(n=t.replace(/<\/em>\$/g,"$"),n!==t&&(t=n,s=!0));t.indexOf("<em>")!==-1&&t.indexOf("</em>")!==-1;){if(n=t.replace(/\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$/g,function(e,t,n,s){return/^[\d.,]+$/.test((t+n+s).replace(/[.,]/g,""))?e:"$"+t+"_"+n+s+"$"}),n=n.replace(/\$\$([^$]*?)<em>([^<]+?)<\/em>([^$]*?)\$\$/g,function(e,t,n,s){return"$$"+t+"_"+n+s+"$$"}),n===t)break;t=n,s=!0}t.indexOf("_{")!==-1&&(n=t.replace(/_{/g,"_{"),n!==t&&(t=n,s=!0)),t.indexOf("}_")!==-1&&(n=t.replace(/}_/g,"}"),n!==t&&(t=n,s=!0)),t.indexOf("\\\\")!==-1&&(n=t.replace(/(\$\{1,2\})([^$]*?)(\$\{1,2\})/g,function(e,t,n,s){for(;n.indexOf("\\\\")!==-1;)n=n.replace(/\\\\/g,"\\");return t+n+s}),n!==t&&(t=n,s=!0)),s&&(e.innerHTML=t)})}window.MathJax={tex:{inlineMath:[["$","$"]],displayMath:[["$$","$$"]],processEscapes:!0,processEnvironments:!0,tags:"ams",macros:{oiint:"\\mathop{∯}",oiiint:"\\mathop{∰}"}},options:{skipHtmlTags:["script","noscript","style","textarea","pre","code"]},startup:{pageReady:function(){return e(),MathJax.startup.defaultPageReady().then(function(){console.log("MathJax formulas rendered successfully")})}}}})()</script><script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><link rel=stylesheet href=/css/mermaid-custom.css><script src=/js/mermaid-converter.js></script><script type=module>
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';

  
  setTimeout(() => {
    mermaid.initialize({
      startOnLoad: true,
      theme: 'base',
      themeVariables: {
        primaryColor: '#e3f2fd',
        primaryTextColor: '#1565c0',
        primaryBorderColor: '#2196f3',
        lineColor: '#42a5f5',
        secondaryColor: '#f3e5f5',
        tertiaryColor: '#fff9c4',
        background: '#ffffff',
        mainBkg: '#ffffff',
        nodeBorder: '#2196f3',
        clusterBkg: '#ffffff',
        clusterBorder: '#e0e0e0',
        titleColor: '#1565c0',
        edgeLabelBackground: '#fafafa',
      },
      securityLevel: 'loose',
    });
  }, 100);
</script><script src=/js/toc.js></script></body></html>