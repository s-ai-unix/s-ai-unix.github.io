<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 800">
  <defs>
    <linearGradient id="bgGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#1a1a2e;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#16213e;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="stepGrad1" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#764ba2;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="stepGrad2" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#f093fb;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#f5576c;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="stepGrad3" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#4facfe;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#00f2fe;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="stepGrad4" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#43e97b;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#38f9d7;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="4" stdDeviation="8" flood-color="#000" flood-opacity="0.3"/>
    </filter>
  </defs>
  
  <!-- Background -->
  <rect width="1200" height="800" fill="url(#bgGrad)"/>
  
  <!-- Title -->
  <text x="600" y="50" text-anchor="middle" font-family="Arial, sans-serif" font-size="32" font-weight="bold" fill="#ffffff">
    TARA分析完整流程
  </text>
  <text x="600" y="80" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" fill="#a0aec0">
    Threat Analysis and Risk Assessment Process
  </text>
  
  <!-- Phase 1: 准备阶段 -->
  <g transform="translate(50, 120)" filter="url(#shadow)">
    <rect width="200" height="160" rx="12" fill="url(#stepGrad1)"/>
    <text x="100" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#ffffff">阶段一</text>
    <text x="100" y="55" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#ffffff">准备阶段</text>
    <line x1="20" y1="70" x2="180" y2="70" stroke="#ffffff" stroke-width="0.5" opacity="0.5"/>
    <text x="100" y="95" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#e0e0e0">• 资产识别与分类</text>
    <text x="100" y="115" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#e0e0e0">• 安全属性定义</text>
    <text x="100" y="135" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#e0e0e0">• 分析边界确定</text>
  </g>
  
  <!-- Arrow 1 -->
  <path d="M270 200 L340 200" stroke="#667eea" stroke-width="3" fill="none" marker-end="url(#arrowhead)"/>
  <polygon points="340,195 355,200 340,205" fill="#667eea"/>
  
  <!-- Phase 2: 威胁建模 -->
  <g transform="translate(360, 120)" filter="url(#shadow)">
    <rect width="200" height="160" rx="12" fill="url(#stepGrad2)"/>
    <text x="100" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#ffffff">阶段二</text>
    <text x="100" y="55" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#ffffff">威胁建模</text>
    <line x1="20" y1="70" x2="180" y2="70" stroke="#ffffff" stroke-width="0.5" opacity="0.5"/>
    <text x="100" y="95" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#e0e0e0">• STRIDE分析</text>
    <text x="100" y="115" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#e0e0e0">• 攻击树构建</text>
    <text x="100" y="135" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#e0e0e0">• ATT&CK映射</text>
  </g>
  
  <!-- Arrow 2 -->
  <path d="M580 200 L650 200" stroke="#f093fb" stroke-width="3" fill="none"/>
  <polygon points="650,195 665,200 650,205" fill="#f093fb"/>
  
  <!-- Phase 3: 风险评估 -->
  <g transform="translate(670, 120)" filter="url(#shadow)">
    <rect width="200" height="160" rx="12" fill="url(#stepGrad3)"/>
    <text x="100" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#ffffff">阶段三</text>
    <text x="100" y="55" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#ffffff">风险评估</text>
    <line x1="20" y1="70" x2="180" y2="70" stroke="#ffffff" stroke-width="0.5" opacity="0.5"/>
    <text x="100" y="95" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#e0e0e0">• 威胁可能性评级</text>
    <text x="100" y="115" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#e0e0e0">• 影响严重性评级</text>
    <text x="100" y="135" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#e0e0e0">• ASIL/风险等级确定</text>
  </g>
  
  <!-- Arrow 3 -->
  <path d="M890 200 L960 200" stroke="#4facfe" stroke-width="3" fill="none"/>
  <polygon points="960,195 975,200 960,205" fill="#4facfe"/>
  
  <!-- Phase 4: 风险处置 -->
  <g transform="translate(980, 120)" filter="url(#shadow)">
    <rect width="200" height="160" rx="12" fill="url(#stepGrad4)"/>
    <text x="100" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#1a1a2e">阶段四</text>
    <text x="100" y="55" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#1a1a2e">风险处置</text>
    <line x1="20" y1="70" x2="180" y2="70" stroke="#1a1a2e" stroke-width="0.5" opacity="0.3"/>
    <text x="100" y="95" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#333">• 规避/降低/转移/接受</text>
    <text x="100" y="115" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#333">• 安全需求定义</text>
    <text x="100" y="135" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#333">• 控制措施设计</text>
  </g>
  
  <!-- Bottom Section: Outputs -->
  <g transform="translate(50, 350)">
    <rect width="1130" height="200" rx="16" fill="#0f0f23" stroke="#2d2d5a" stroke-width="2"/>
    <text x="565" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="20" font-weight="bold" fill="#ffffff">核心输出物</text>
    
    <!-- Output Items -->
    <g transform="translate(80, 60)">
      <rect width="200" height="130" rx="8" fill="#1e3a5f"/>
      <circle cx="30" cy="35" r="12" fill="#667eea"/>
      <text x="30" y="40" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" fill="#ffffff">1</text>
      <text x="100" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#ffffff">资产清单</text>
      <text x="100" y="55" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#a0aec0">安全属性定义</text>
      <text x="100" y="75" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#a0aec0">边界与依赖关系</text>
    </g>
    
    <g transform="translate(310, 60)">
      <rect width="200" height="130" rx="8" fill="#4a1942"/>
      <circle cx="30" cy="35" r="12" fill="#f093fb"/>
      <text x="30" y="40" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" fill="#ffffff">2</text>
      <text x="100" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#ffffff">威胁场景</text>
      <text x="100" y="55" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#e0e0e0">攻击路径分析</text>
      <text x="100" y="75" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#e0e0e0">攻击树模型</text>
    </g>
    
    <g transform="translate(540, 60)">
      <rect width="200" height="130" rx="8" fill="#1a4a4a"/>
      <circle cx="30" cy="35" r="12" fill="#4facfe"/>
      <text x="30" y="40" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" fill="#ffffff">3</text>
      <text x="100" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#ffffff">风险评估</text>
      <text x="100" y="55" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#a0aec0">可能性×影响性</text>
      <text x="100" y="75" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#a0aec0">风险等级排序</text>
    </g>
    
    <g transform="translate(770, 60)">
      <rect width="200" height="130" rx="8" fill="#1a3a1a"/>
      <circle cx="30" cy="35" r="12" fill="#43e97b"/>
      <text x="30" y="40" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" fill="#1a1a2e">4</text>
      <text x="100" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#ffffff">安全需求</text>
      <text x="100" y="55" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#a0aec0">控制措施</text>
      <text x="100" y="75" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#a0aec0">验证方法</text>
    </g>
  </g>
  
  <!-- ISO/SAE 21434 Reference -->
  <g transform="translate(50, 600)">
    <rect width="1130" height="150" rx="16" fill="#1a1a3e" stroke="#4a4a8a" stroke-width="2"/>
    <text x="565" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#ffffff">标准合规性</text>
    
    <g transform="translate(50, 55)">
      <rect width="250" height="80" rx="8" fill="#2d2d6a"/>
      <text x="125" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#667eea">ISO/SAE 21434</text>
      <text x="125" y="55" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#a0aec0">汽车网络安全工程标准</text>
      <text x="125" y="72" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#a0aec0">全生命周期要求</text>
    </g>
    
    <g transform="translate(330, 55)">
      <rect width="250" height="80" rx="8" fill="#2d2d6a"/>
      <text x="125" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#f093fb">UN R155</text>
      <text x="125" y="55" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#a0aec0">网络安全法规</text>
      <text x="125" y="72" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#a0aec0">CSMS认证要求</text>
    </g>
    
    <g transform="translate(610, 55)">
      <rect width="250" height="80" rx="8" fill="#2d2d6a"/>
      <text x="125" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#4facfe">ISO 26262</text>
      <text x="125" y="55" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#a0aec0">功能安全标准</text>
      <text x="125" y="72" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#a0aec0">安全完整性等级</text>
    </g>
    
    <g transform="translate(890, 55)">
      <rect width="250" height="80" rx="8" fill="#2d2d6a"/>
      <text x="125" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#43e97b">ISO 21448</text>
      <text x="125" y="55" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#a0aec0">SOTIF标准</text>
      <text x="125" y="72" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#a0aec0">预期功能安全</text>
    </g>
  </g>
  
  <!-- Footer -->
  <text x="600" y="790" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#666">
    TARA Analysis Framework | Automotive Cybersecurity
  </text>
</svg>