# Skill 自升级机制（Self-Improvement Protocol）

## 概述

本文档定义了 write-tech-blog skill 的元升级能力——当发现问题或需要优化时，skill 如何自主反思、决策并更新自身。

---

## 自升级触发条件

当以下情况发生时，触发自我反思和升级流程：

1. **Bug 修复后** - 用户报告问题，修复完成后
2. **优化完成后** - 发现更好的实现方式
3. **模式重复出现时** - 同类问题出现 2 次以上
4. **知识缺口发现时** - 发现未覆盖的重要场景

---

## 自升级流程

### Phase 1: 问题记录（立即执行）

当问题发生时，首先记录到 `LESSONS_LEARNED.md`：

```markdown
## [日期] 问题标题

**问题描述**: 简要说明发生了什么
**影响范围**: 哪些文章/场景受影响
**根本原因**: 为什么会发生
**修复方案**: 如何解决的
**预防机制**: 如何避免再次发生
**Skill 更新**: 需要更新哪些文档
```

### Phase 2: 反思分析（问题解决后立即执行）

使用以下框架分析：

#### 2.1 问题分类
- [ ] 流程缺陷 - 步骤缺失或顺序错误
- [ ] 规范遗漏 - 未定义的边界情况
- [ ] 示例不足 - 缺乏参考案例
- [ ] 检查缺失 - 质量检查未覆盖
- [ ] 工具缺陷 - 脚本/工具问题
- [ ] 文档模糊 - 表述不清晰导致误解

#### 2.2 根因分析
```
1. 这个问题是第一次出现还是重复出现？
2. Skill 文档中是否有相关内容？
3. 如果有，为什么没有 prevent 这个问题？
4. 如果没有，为什么遗漏了这个场景？
5. 检查清单是否能捕获这个问题？
```

#### 2.3 影响评估
- **高频 vs 低频**：是否会影响大多数文章？
- **严重 vs 轻微**：错误是否容易被发现？
- **即时 vs 延迟**：问题是否立即暴露？

### Phase 3: Skill 更新决策

根据分析结果，决定更新策略：

#### 更新类型 A: 紧急补丁（立即更新）
- 条件：流程关键步骤错误、高频问题
- 动作：直接修改 SKILL.md 或相关文档
- 记录：在 UPDATE-LOG.md 中添加条目

#### 更新类型 B: 规范补充（本周内）
- 条件：边界情况未覆盖、检查项缺失
- 动作：
  1. 补充到 SKILL.md 对应章节
  2. 更新 QUALITY-CHECK.md 添加检查项
  3. 添加示例到 references/
- 记录：在 UPDATE-LOG.md 中添加条目

#### 更新类型 C: 重构优化（下次使用时）
- 条件：发现更好的实现方式、模式重复
- 动作：
  1. 收集 2-3 个同类案例
  2. 分析共性问题
  3. 设计通用解决方案
  4. 更新 SKILL.md 和相关文档
- 记录：在 UPDATE-LOG.md 中添加详细条目

#### 更新类型 D: 暂不更新（持续观察）
- 条件：偶发问题、已修复且影响有限
- 动作：仅记录到 LESSONS_LEARNED.md
- 触发升级：当再次出现同类问题时升级为类型 C

### Phase 4: 执行更新

#### 4.1 更新前检查清单
```
- [ ] 已阅读 SKILL.md 相关章节
- [ ] 已阅读 references/ 下相关文档
- [ ] 已查看 UPDATE-LOG.md 了解历史变更
- [ ] 已确认更新不会破坏向后兼容性
- [ ] 已确定更新的最佳位置（避免重复）
```

#### 4.2 更新原则
1. **DRY 原则**：不重复现有内容，只添加增量
2. **正例+反例**：不仅说"应该怎么做"，还要说"不要怎么做"
3. **可检查性**：新增的规范必须能被验证
4. **最小侵入**：只做必要的修改

#### 4.3 更新位置优先级
```
1. 如果是流程问题 → SKILL.md 对应流程步骤
2. 如果是检查项缺失 → QUALITY-CHECK.md
3. 如果是具体规范 → references/ 下对应文档
4. 如果是示例不足 → 添加到对应章节或创建新示例
5. 如果是工具问题 → 修复工具脚本，更新使用说明
```

### Phase 5: 验证更新

更新完成后：

```
- [ ] 更新内容是否清晰无歧义？
- [ ] 是否有具体的示例支持？
- [ ] 是否与现有内容一致？
- [ ] 是否添加了检查机制？
- [ ] 是否在 UPDATE-LOG.md 中记录？
```

---

## LESSONS_LEARNED.md 维护规范

### 条目格式

```markdown
## [YYYY-MM-DD] 简短标题

**问题类型**: Bug / 优化 / 规范补充
**问题描述**: 
发生了什么，现象是什么

**根本原因**:
为什么会发生这个问题

**修复方案**:
如何解决的具体步骤

**Skill 更新**:
- [ ] 已更新 SKILL.md
- [ ] 已更新 QUALITY-CHECK.md
- [ ] 已更新其他文档

**相关提交**:
- 文件变更: `content/posts/xxx.md`
- Skill 变更: `.claude/skills/write-tech-blog/xxx.md`
```

### 定期回顾

每月回顾一次 LESSONS_LEARNED.md：

1. **识别模式**：哪些问题重复出现？
2. **优先级排序**：哪些需要更新到 Skill？
3. **归档**：已完全解决的标记为 `### [已解决]`

---

## 附录：Self-Improvement 提示词

当需要触发自升级时，使用以下提示词引导思考：

```
现在执行 Skill 自升级流程：

1. 首先记录问题到 LESSONS_LEARNED.md
2. 按照 Phase 2 框架分析：
   - 问题分类是什么？
   - 根因是什么？
   - 影响如何？
3. 确定更新类型（A/B/C/D）
4. 执行更新前检查清单
5. 更新 SKILL.md 或相关文档
6. 验证更新质量
7. 记录到 UPDATE-LOG.md

请先阅读 SKILL.md 和相关文档的当前内容，
然后决定最佳更新策略。
```
